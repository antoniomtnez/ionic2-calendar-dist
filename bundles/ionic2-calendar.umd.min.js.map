{"version":3,"sources":["../../node_modules/tslib/tslib.es6.js","ng://ionic2-calendar/calendar.ts","ng://ionic2-calendar/calendar.service.ts","ng://ionic2-calendar/monthview.ts","ng://ionic2-calendar/weekview.ts","ng://ionic2-calendar/dayview.ts","ng://ionic2-calendar/init-position-scroll.ts","ng://ionic2-calendar/calendar.module.ts"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","create","Step","CalendarService","this","currentDateChangedFromParent","Subject","currentDateChangedFromChildren","eventSourceChanged","slideChanged","slideUpdated","currentDateChangedFromParent$","asObservable","currentDateChangedFromChildren$","eventSourceChanged$","slideChanged$","slideUpdated$","prototype","setCurrentDate","val","fromParent","_currentDate","Date","next","rangeChanged","component","queryMode","eventSource","onDataLoaded","rangeStart","range","startTime","getTime","rangeEnd","endTime","setHours","getHours","setTime","onRangeChanged","emit","getStep","mode","years","months","days","getAdjacentCalendarDate","direction","calculateCalendarDate","currentDate","step","year","getFullYear","month","getMonth","date","getDate","firstDayInNextMonth","getAdjacentViewStartTime","adjacentCalendarDate","getRange","populateAdjacentViews","currentViewStartDate","currentViewData","toUpdateViewIndex","currentViewIndex","views","getViewData","push","loadEvents","slide","update","Injectable","MonthViewComponent","calendarService","autoSelect","dir","EventEmitter","onEventSelected","onTimeSelected","onTitleChanged","moveOnSelected","inited","callbackOnInit","getDates","startDate","n","dates","Array","current","setDate","ngOnInit","_this","sliderOptions","loop","dateFormatter","formatMonthViewDay","formatDayLabel","dayLabelDatePipe_1","DatePipe","transform","formatDay","formatMonthViewDayHeader","formatDayHeaderLabel","datePipe_1","locale","formatDayHeader","formatMonthViewTitle","formatTitle","datePipe_2","formatMonthTitle","lockSwipeToPrev","slider","lockSwipes","refreshView","currentDateChangedFromParentSubscription","subscribe","eventSourceChangedSubscription","slideChangedSubscription","slideNext","slidePrev","slideUpdatedSubscription","ngOnDestroy","unsubscribe","ngOnChanges","changes","eventSourceChange","currentValue","ngAfterViewInit","title","getTitle","onSlideChanged","getActiveIndex","then","currentSlideIndex","isNaN","slideTo","move","adjacentDate","createDateObject","disabled","markDisabled","events","label","secondary","MonthViewComponent_1","dateObject","dayHeaders","getHighlightClass","className","hasEvent","selected","firstDayOfMonth","difference","startingDayMonth","getDay","numDisplayedFromPreviousMonth","endDate","len","utcStartTime","UTC","utcEndTime","event_1","eventStartTime","eventEndTime","eventUTCStartTime","eventUTCEndTime","allDay","timeDifferenceStart","timeDifferenceEnd","index","Math","floor","endIndex","ceil","eventSet","sort","compareEvent","findSelected","selectedDate","selectedTime","updateCurrentView","headerDate","event1","event2","select","viewDate","currentCalendarDate","currentMonth","currentYear","selectedMonth","selectedYear","selectedDayDifference","round","slideView","view","today","currentDayDifference","eventSelected","event","ViewChild","static","Input","Output","Component","selector","template","WeekViewComponent","elm","class","scrollToHour","onDayHeaderSelected","createDateObjects","startHour","endHour","timeInterval","hourStep","minStep","times","hour","interval","row","day","time","dayHeader","compareEventByStartOffset","eventA","eventB","startOffset","calculateWidth","orderedEvents","size","hourParts","totalSize","cells","position","i_1","calculated","i_2","startIndex","endOffset","event_2","overlapNumber","eventQueue","shift","eventCountInCell","j","currentEventInCell","hourRange","hourSegments","formatWeekViewDayHeader","formatWeekViewTitle","formatWeekTitle","formatWeekViewHourColumn","formatHourColumnLabel","datePipe_3","formatHourColumn","hourColumnLabels","getHourColumnLabels","hourColumns_1","nativeElement","querySelector","querySelectorAll","me_1","setTimeout","initScrollPosition","offsetTop","isFirstChange","undefined","adjacent","length_1","rows","WeekViewComponent_1","startingDayWeek","rangeStartRowIndex","rangeEndRowIndex","allRows","allDayEventInRange","normalEventInRange","event_3","allDayStartIndex","displayAllDayEvent","getMinutes","startRowIndex","dayIndex","endOfDay","endRowIndex","displayEvent","concat","placeEvents","orderedAllDayEvents","placeAllDayEvents","map","e","firstDayOfWeek","calculatePosition","overlap","earlyEvent","lateEvent","isForbidden","maxColumn","col","daySelected","setScrollPosition","scrollPosition","ElementRef","HostBinding","encapsulation","ViewEncapsulation","None","DayViewComponent","formatDayViewTitle","formatDayTitle","formatDayViewHourColumn","DayViewComponent_1","allDayEvents","startingDate","CalendarComponent","appLocale","calendarMode","showEventDetail","allDayLabel","noEventsLabel","Hour","preserveScrollPosition","onCurrentDateChanged","paramIndex","decorator","toString","parseInt","currentDateChangedFromChildrenSubscription","timeSelected","titleChanged","Inject","args","LOCALE_ID","providers","initPositionScrollComponent","el","onScroll","listenerAttached","element","initPosition","scrollContent","scrollTop","emitEvent","onScroll_1","handler","addEventListener","removeEventListener","NgCalendarModule","NgModule","declarations","imports","IonicModule","CommonModule","exports"],"mappings":";;;;;;;;;;;;;;oFAsDO,SAASA,EAAWC,EAAYC,EAAQC,EAAKC,GAChD,IAA2HC,EAAvHC,EAAIC,UAAUC,OAAQC,EAAIH,EAAI,EAAIJ,EAAkB,OAATE,EAAgBA,EAAOM,OAAOC,yBAAyBT,EAAQC,GAAOC,EACrH,GAAuB,iBAAZQ,SAAoD,mBAArBA,QAAQC,SAAyBJ,EAAIG,QAAQC,SAASZ,EAAYC,EAAQC,EAAKC,QACpH,IAAK,IAAIU,EAAIb,EAAWO,OAAS,EAAGM,GAAK,EAAGA,KAAST,EAAIJ,EAAWa,MAAIL,GAAKH,EAAI,EAAID,EAAEI,GAAKH,EAAI,EAAID,EAAEH,EAAQC,EAAKM,GAAKJ,EAAEH,EAAQC,KAASM,GAChJ,OAAOH,EAAI,GAAKG,GAAKC,OAAOK,eAAeb,EAAQC,EAAKM,GAAIA,EAiDnCC,OAAOM,OAsGXN,OAAOM,WC7DpBC,eC/HR,SAAAC,IANQC,KAAAC,6BAA+B,IAAIC,EAAAA,QACnCF,KAAAG,+BAAiC,IAAID,EAAAA,QACrCF,KAAAI,mBAAqB,IAAIF,EAAAA,QACzBF,KAAAK,aAAe,IAAIH,EAAAA,QACnBF,KAAAM,aAAe,IAAIJ,EAAAA,QAGvBF,KAAKO,8BAAgCP,KAAKC,6BAA6BO,eACvER,KAAKS,gCAAkCT,KAAKG,+BAA+BK,eAC3ER,KAAKU,oBAAsBV,KAAKI,mBAAmBI,eACnDR,KAAKW,cAAgBX,KAAKK,aAAaG,eACvCR,KAAKY,cAAgBZ,KAAKM,aAAaE,eAuI/C,OApIIT,EAAAc,UAAAC,eAAA,SAAeC,EAAWC,QAAA,IAAAA,IAAAA,GAAA,GACtBhB,KAAKiB,aAAe,IAAIC,KAAKH,GACzBC,EACAhB,KAAKC,6BAA6BkB,KAAKJ,GAEvCf,KAAKG,+BAA+BgB,KAAKJ,IAIjDxB,OAAAK,eAAIG,EAAAc,UAAA,cAAW,KAAf,WACI,OAAOb,KAAKiB,8CAGhBlB,EAAAc,UAAAO,aAAA,SAAaC,GACT,GAAuB,UAAnBrB,KAAKsB,UACDD,EAAUE,aAAeF,EAAUG,cACnCH,EAAUG,oBAEX,GAAuB,WAAnBxB,KAAKsB,UAAwB,CACpC,IAAIG,EAAa,IAAIP,KAAKG,EAAUK,MAAMC,UAAUC,WAChDC,EAAW,IAAIX,KAAKG,EAAUK,MAAMI,QAAQF,WAEhDH,EAAWM,SAAS,GACU,KAA1BN,EAAWO,YACXP,EAAWQ,QAAQR,EAAWG,UAAY,MAG9CC,EAASE,SAAS,GACU,KAAxBF,EAASG,YACTH,EAASI,QAAQJ,EAASD,UAAY,MAE1CP,EAAUa,eAAeC,KAAK,CAC1BR,UAAWF,EACXK,QAASD,MAKb9B,EAAAc,UAAAuB,QAAR,SAAgBC,GACZ,OAAQA,GACJ,IAAK,QACD,MAAO,CACHC,MAAO,EACPC,OAAQ,EACRC,KAAM,GAEd,IAAK,OACD,MAAO,CACHF,MAAO,EACPC,OAAQ,EACRC,KAAM,GAEd,IAAK,MACD,MAAO,CACHF,MAAO,EACPC,OAAQ,EACRC,KAAM,KAKtBzC,EAAAc,UAAA4B,wBAAA,SAAwBJ,EAAoBK,GACxC,IAAIC,EAAwB3C,KAAK4C,YAC3BC,EAAO7C,KAAKoC,QAAQC,GACtBS,EAAOH,EAAsBI,cAAgBL,EAAYG,EAAKP,MAC9DU,EAAQL,EAAsBM,WAAaP,EAAYG,EAAKN,OAC5DW,EAAOP,EAAsBQ,UAAYT,EAAYG,EAAKL,KAI9D,GAFAG,EAAwB,IAAIzB,KAAK4B,EAAME,EAAOE,EAAM,GAAI,EAAG,GAE9C,UAATb,EAAkB,CAClB,IAAMe,EAAsB,IAAIlC,KAAK4B,EAAME,EAAQ,EAAG,EAAG,GAAI,EAAG,GAC5DI,EAAoBxB,WAAae,EAAsBf,YACvDe,EAAwB,IAAIzB,KAAKkC,EAAoBxB,UAAY,QAGzE,OAAOe,GAGX5C,EAAAc,UAAAwC,yBAAA,SAAyBhC,EAA+BqB,GACpD,IAAIY,EAAuBtD,KAAKyC,wBAAwBpB,EAAUgB,KAAMK,GACxE,OAAOrB,EAAUkC,SAASD,GAAsB3B,WAGpD5B,EAAAc,UAAA2C,sBAAA,SAAsBnC,GAClB,IAAIoC,EACAC,EACAC,EACAC,EAAmBvC,EAAUuC,iBAEL,IAAxBvC,EAAUqB,WACVe,EAAuBzD,KAAKqD,yBAAyBhC,EAAW,GAChEsC,GAAqBC,EAAmB,GAAK,EAC7CvC,EAAUwC,MAAMF,GAAqBtC,EAAUyC,YAAYL,KAC3B,IAAzBpC,EAAUqB,WACjBe,EAAuBzD,KAAKqD,yBAAyBhC,GAAY,GACjEsC,GAAqBC,EAAmB,GAAK,EAC7CvC,EAAUwC,MAAMF,GAAqBtC,EAAUyC,YAAYL,IAEtDpC,EAAUwC,OAUXJ,EAAuBpC,EAAUK,MAAMC,UACvCN,EAAUwC,MAAMD,GAAoBvC,EAAUyC,YAAYL,GAC1DA,EAAuBzD,KAAKqD,yBAAyBhC,GAAY,GACjEsC,GAAqBC,EAAmB,GAAK,EAC7CvC,EAAUwC,MAAMF,GAAqBtC,EAAUyC,YAAYL,GAC3DA,EAAuBzD,KAAKqD,yBAAyBhC,EAAW,GAChEsC,GAAqBC,EAAmB,GAAK,EAC7CvC,EAAUwC,MAAMF,GAAqBtC,EAAUyC,YAAYL,KAhB3DC,EAAkB,GAClBD,EAAuBpC,EAAUK,MAAMC,UACvC+B,EAAgBK,KAAK1C,EAAUyC,YAAYL,IAC3CA,EAAuBzD,KAAKqD,yBAAyBhC,EAAW,GAChEqC,EAAgBK,KAAK1C,EAAUyC,YAAYL,IAC3CA,EAAuBzD,KAAKqD,yBAAyBhC,GAAY,GACjEqC,EAAgBK,KAAK1C,EAAUyC,YAAYL,IAC3CpC,EAAUwC,MAAQH,IAc9B3D,EAAAc,UAAAmD,WAAA,WACIhE,KAAKI,mBAAmBe,QAG5BpB,EAAAc,UAAAoD,MAAA,SAAMvB,GACF1C,KAAKK,aAAac,KAAKuB,IAG3B3C,EAAAc,UAAAqD,OAAA,WACIlE,KAAKM,aAAaa,QAzJbpB,EAAelB,EAAA,CAD3BsF,EAAAA,cACYpE,mBC2OT,SAAAqE,EAAoBC,GAAArE,KAAAqE,gBAAAA,EAiBXrE,KAAAsE,YAAa,EAIbtE,KAAAuE,IAAM,GAKLvE,KAAAkC,eAAiB,IAAIsC,EAAAA,aACrBxE,KAAAyE,gBAAkB,IAAID,EAAAA,aACtBxE,KAAA0E,eAAiB,IAAIF,EAAAA,cAA4B,GACjDxE,KAAA2E,eAAiB,IAAIH,EAAAA,cAAqB,GAE7CxE,KAAA6D,MAAsB,GACtB7D,KAAA4D,iBAAmB,EAGnB5D,KAAAqC,KAAqB,QACrBrC,KAAA0C,UAAY,EAEX1C,KAAA4E,gBAAiB,EACjB5E,KAAA6E,QAAS,EACT7E,KAAA8E,gBAAiB,QAif7B,SA3hBaV,EAqDFA,EAAAW,SAAP,SAAgBC,EAAiBC,GAI7B,IAHA,IAAMC,EAAQ,IAAIC,MAAMF,GACpBG,EAAU,IAAIlE,KAAK8D,EAAUpD,WAC7BjC,EAAI,EACDA,EAAIsF,GACPC,EAAMvF,KAAO,IAAIuB,KAAKkE,EAAQxD,WAC9BwD,EAAQC,QAAQD,EAAQjC,UAAY,GAExC,OAAO+B,GAGXd,EAAAvD,UAAAyE,SAAA,WAAA,IAAAC,EAAAvF,KAMI,GALKA,KAAKwF,gBACNxF,KAAKwF,cAAgB,IAEzBxF,KAAKwF,cAAcC,MAAO,EAEtBzF,KAAK0F,eAAiB1F,KAAK0F,cAAcC,mBACzC3F,KAAK4F,eAAiB5F,KAAK0F,cAAcC,uBACtC,CACH,IAAME,EAAmB,IAAIC,EAAAA,SAAS,SACtC9F,KAAK4F,eAAiB,SAAS1C,GAC3B,OAAO2C,EAAiBE,UAAU7C,EAAMlD,KAAKgG,YAIrD,GAAIhG,KAAK0F,eAAiB1F,KAAK0F,cAAcO,yBACzCjG,KAAKkG,qBAAuBlG,KAAK0F,cAAcO,6BAC5C,CACH,IAAME,EAAW,IAAIL,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKkG,qBAAuB,SAAShD,GACjC,OAAOiD,EAASJ,UAAU7C,EAAMlD,KAAKqG,kBAI7C,GAAIrG,KAAK0F,eAAiB1F,KAAK0F,cAAcY,qBACzCtG,KAAKuG,YAAcvG,KAAK0F,cAAcY,yBACnC,CACH,IAAME,EAAW,IAAIV,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKuG,YAAc,SAASrD,GACxB,OAAOsD,EAAST,UAAU7C,EAAMlD,KAAKyG,mBAIzCzG,KAAK0G,iBACL1G,KAAK2G,OAAOD,iBAAgB,GAG5B1G,KAAK4G,YACL5G,KAAK2G,OAAOC,YAAW,GAG3B5G,KAAK6G,cACL7G,KAAK6E,QAAS,EAEd7E,KAAK8G,yCAA2C9G,KAAKqE,gBAAgB9D,8BAA8BwG,WAAU,SAAAnE,GACzG2C,EAAKsB,iBAGT7G,KAAKgH,+BAAiChH,KAAKqE,gBAAgB3D,oBAAoBqG,WAAU,WACrFxB,EAAK/D,kBAGTxB,KAAKiH,yBAA2BjH,KAAKqE,gBAAgB1D,cAAcoG,WAAU,SAAArE,GACvD,IAAdA,EACA6C,EAAKoB,OAAOO,aACU,IAAfxE,GACP6C,EAAKoB,OAAOQ,eAIpBnH,KAAKoH,yBAA2BpH,KAAKqE,gBAAgBzD,cAAcmG,WAAU,WACzExB,EAAKoB,OAAOzC,aAIpBE,EAAAvD,UAAAwG,YAAA,WACQrH,KAAK8G,2CACL9G,KAAK8G,yCAAyCQ,cAC9CtH,KAAK8G,yCAA2C,MAGhD9G,KAAKgH,iCACLhH,KAAKgH,+BAA+BM,cACpCtH,KAAKgH,+BAAiC,MAGtChH,KAAKiH,2BACLjH,KAAKiH,yBAAyBK,cAC9BtH,KAAKiH,yBAA2B,MAGhCjH,KAAKoH,2BACLpH,KAAKoH,yBAAyBE,cAC9BtH,KAAKoH,yBAA2B,OAIxChD,EAAAvD,UAAA0G,YAAA,SAAYC,GACR,GAAKxH,KAAK6E,OAAV,CAIA,IAAM4C,EAAoBD,EAAQjG,YAC9BkG,GAAqBA,EAAkBC,cACvC1H,KAAKwB,eAGT,IAAMkF,EAAkBc,EAAQd,gBAC5BA,GACA1G,KAAK2G,OAAOD,gBAAgBA,EAAgBgB,cAGhD,IAAMd,EAAaY,EAAQZ,WACvBA,GACA5G,KAAK2G,OAAOC,WAAWA,EAAWc,gBAI1CtD,EAAAvD,UAAA8G,gBAAA,WACI,IAAMC,EAAQ5H,KAAK6H,WACnB7H,KAAK2E,eAAexC,KAAKyF,IAG7BxD,EAAAvD,UAAAiH,eAAA,WAAA,IAAAvC,EAAAvF,KACI,GAAIA,KAAK8E,eACL9E,KAAK8E,gBAAiB,MAD1B,CAKA,IAAIpC,EAAY,EACVkB,EAAmB5D,KAAK4D,iBAE9B5D,KAAK2G,OAAOoB,iBAAiBC,MAAK,SAACC,GAC/BA,GAAqBA,EAAoB,GAAK,EAC3CC,MAAMD,KACLA,EAAoBrE,GAGpBqE,EAAoBrE,GAAqB,EACzClB,EAAY,EACiB,IAAtBuF,GAAgD,IAArBrE,GAClClB,EAAY,EACZ6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IACnBvE,EAAmBqE,GAAsB,EAChDvF,GAAa,EACgB,IAAtBuF,GAAgD,IAArBrE,IAClClB,GAAa,EACb6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IAE9B5C,EAAK3B,iBAAmBqE,EACxB1C,EAAK6C,KAAK1F,QAIlB0B,EAAAvD,UAAAuH,KAAA,SAAK1F,GACD,GAAkB,IAAdA,EAAJ,CAKA,GADA1C,KAAK0C,UAAYA,GACZ1C,KAAK4E,eAAgB,CACtB,IAAMyD,EAAerI,KAAKqE,gBAAgB5B,wBAAwBzC,KAAKqC,KAAMK,GAC7E1C,KAAKqE,gBAAgBvD,eAAeuH,GAExCrI,KAAK6G,cACL7G,KAAK0C,UAAY,EACjB1C,KAAK4E,gBAAiB,IAG1BR,EAAAvD,UAAAyH,iBAAA,SAAiBpF,GACb,IAAIqF,GAAW,EAKf,OAJIvI,KAAKwI,eACLD,EAAWvI,KAAKwI,aAAatF,IAG1B,CACHA,KAAIA,EACJuF,OAAQ,GACRC,MAAO1I,KAAK4F,eAAe1C,GAC3ByF,WAAW,EACXJ,SAAQA,IAIhBnE,EAAAvD,UAAAiD,YAAA,SAAYnC,GAOR,IANA,IAAMqD,EAAYrD,EACduB,EAAO8B,EAAU7B,UACjBH,GAASgC,EAAU/B,YAAuB,IAATC,EAAa,EAAI,IAAM,GAEtDgC,EAAQ0D,EAAmB7D,SAASC,EAAW,IAC/CxC,EAAwB,GACrB7C,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,IAAMkJ,EAAa7I,KAAKsI,iBAAiBpD,EAAMvF,IAC/CkJ,EAAWF,UAAYzD,EAAMvF,GAAGsD,aAAeD,EAC/CR,EAAK7C,GAAKkJ,EAGd,IAAMC,EAAuB,GAC7B,IAASnJ,EAAI,EAAGA,EAAI,EAAGA,IACnBmJ,EAAW/E,KAAK/D,KAAKkG,qBAAqB1D,EAAK7C,GAAGuD,OAEtD,MAAO,CACHgC,MAAO1C,EACPsG,WAAUA,IAIlB1E,EAAAvD,UAAAkI,kBAAA,SAAkB7F,GACd,IAAI8F,EAAY,GAqChB,OAnCI9F,EAAK+F,WAEDD,EADA9F,EAAKyF,UACO,iCAEA,gCAIhBzF,EAAKgG,WACDF,IACAA,GAAa,KAEjBA,GAAa,sBAGb9F,EAAKkC,UACD4D,IACAA,GAAa,KAEjBA,GAAa,qBAGb9F,EAAKyF,YACDK,IACAA,GAAa,KAEjBA,GAAa,cAGb9F,EAAKqF,WACDS,IACAA,GAAa,KAEjBA,GAAa,sBAEVA,GAGX5E,EAAAvD,UAAA0C,SAAA,SAASX,GACL,IAAME,EAAOF,EAAYG,cACrBC,EAAQJ,EAAYK,WACpBkG,EAAkB,IAAIjI,KAAK4B,EAAME,EAAO,EAAG,GAAI,EAAG,GAElDoG,EAAapJ,KAAKqJ,iBAAmBF,EAAgBG,SACrDC,EAAiCH,EAAa,EAAK,EAAIA,GAAcA,EACrEpE,EAAY,IAAI9D,KAAKiI,EAAgBvH,WAErC2H,EAAgC,GAChCvE,EAAUK,QAAyC,EAAhCkE,GAGvB,IAAMC,EAAU,IAAItI,KAAK8D,EAAUpD,WAGnC,OAFA4H,EAAQnE,QAAQmE,EAAQrG,UAAY,IAE7B,CACHxB,UAAWqD,EACXlD,QAAS0H,IAIjBpF,EAAAvD,UAAAW,aAAA,WAaI,IAZA,IAAME,EAAQ1B,KAAK0B,MACfH,EAAcvB,KAAKuB,YACnBkI,EAAMlI,EAAcA,EAAYlC,OAAS,EACzCsC,EAAYD,EAAMC,UAClBG,EAAUJ,EAAMI,QAChB4H,EAAexI,KAAKyI,IAAIhI,EAAUoB,cAAepB,EAAUsB,WAAYtB,EAAUwB,WACjFyG,EAAa1I,KAAKyI,IAAI7H,EAAQiB,cAAejB,EAAQmB,WAAYnB,EAAQqB,WACzES,EAAmB5D,KAAK4D,iBACxBsB,EAAQlF,KAAK6D,MAAMD,GAAkBsB,MAIhC5F,EAAI,EAAGA,EAAI,GAAIA,GAAK,EACrB4F,EAAM5F,GAAG2J,WACT/D,EAAM5F,GAAG2J,UAAW,EACpB/D,EAAM5F,GAAGmJ,OAAS,IAI1B,IAAK,IAAI9I,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAAG,CAC7B,IAAMkK,EAAQtI,EAAY5B,GACtBmK,EAAiBD,EAAMlI,UACvBoI,EAAeF,EAAM/H,QAErBkI,OAAiB,EACjBC,OAAe,EASnB,GARIJ,EAAMK,QACNF,EAAoBF,EAAelI,UACnCqI,EAAkBF,EAAanI,YAE/BoI,EAAoB9I,KAAKyI,IAAIG,EAAe/G,cAAe+G,EAAe7G,WAAY6G,EAAe3G,WACrG8G,EAAkB/I,KAAKyI,IAAII,EAAahH,cAAegH,EAAa9G,WAAY8G,EAAa5G,UAAY,MAGzG8G,GAAmBP,GAAgBM,GAAqBJ,GAA5D,CAIA,IAAIO,OAAmB,EACnBC,OAAiB,EAGjBD,EADAH,EAAoBN,EACE,GAECM,EAAoBN,GAnCtC,MAuCLU,EADAH,EAAkBL,GACGA,EAAaF,GAvC7B,OAyCgBO,EAAkBP,GAzClC,MA8CT,IAFA,IAAIW,EAAQC,KAAKC,MAAMJ,GACjBK,EAAWF,KAAKG,KAAKL,EA5CrB,MA6CCC,EAAQG,GAAU,CACrBtF,EAAMmF,GAAOpB,UAAW,EACxB,IAAIyB,EAAWxF,EAAMmF,GAAO5B,OACxBiC,EACAA,EAAS3G,KAAK8F,KAEda,EAAW,IACF3G,KAAK8F,GACd3E,EAAMmF,GAAO5B,OAASiC,GAE1BL,GAAS,IAIjB,IAAS/K,EAAI,EAAGA,EAAI,GAAIA,GAAK,EACrB4F,EAAM5F,GAAG2J,UACT/D,EAAM5F,GAAGmJ,OAAOkC,KAAK3K,KAAK4K,cAIlC,GAAI5K,KAAKsE,WAAY,CACjB,IAAIuG,GAAe,EACnB,IAASvL,EAAI,EAAGA,EAAI,GAAIA,GAAK,EACzB,GAAI4F,EAAM5F,GAAG4J,SAAU,CACnBlJ,KAAK8K,aAAe5F,EAAM5F,GAC1BuL,GAAe,EACf,MAIJA,GACA7K,KAAK0E,eAAevC,KAAK,CACrB4I,aAAc/K,KAAK8K,aAAa5H,KAChCuF,OAAQzI,KAAK8K,aAAarC,OAC1BF,SAAUvI,KAAK8K,aAAavC,aAM5CnE,EAAAvD,UAAAgG,YAAA,WAGI,GAFA7G,KAAK0B,MAAQ1B,KAAKuD,SAASvD,KAAKqE,gBAAgBzB,aAE5C5C,KAAK6E,OAAQ,CACb,IAAM+C,EAAQ5H,KAAK6H,WACnB7H,KAAK2E,eAAexC,KAAKyF,GAE7B5H,KAAKqE,gBAAgBb,sBAAsBxD,MAC3CA,KAAKgL,kBAAkBhL,KAAK0B,MAAMC,UAAW3B,KAAK6D,MAAM7D,KAAK4D,mBAC7D5D,KAAKqE,gBAAgBjD,aAAapB,OAGtCoE,EAAAvD,UAAAgH,SAAA,WACI,IAAMpE,EAAuBzD,KAAK0B,MAAMC,UACpCuB,EAAOO,EAAqBN,UAC5BH,GAASS,EAAqBR,YAAuB,IAATC,EAAa,EAAI,IAAM,GACnEJ,EAAOW,EAAqBV,eAA0B,IAATG,GAAwB,IAAVF,EAAc,EAAI,GAC7EiI,EAAa,IAAI/J,KAAK4B,EAAME,EAAO,EAAG,GAAI,EAAG,EAAG,GACpD,OAAOhD,KAAKuG,YAAY0E,IAGpB7G,EAAAvD,UAAA+J,aAAR,SAAqBM,EAAgBC,GACjC,OAAID,EAAOhB,OACA,EACAiB,EAAOjB,QACN,EAEAgB,EAAOvJ,UAAUC,UAAYuJ,EAAOxJ,UAAUC,WAI9DwC,EAAAvD,UAAAuK,OAAA,SAAOC,GACH,GAAKrL,KAAK6D,MAAV,CAIA,IAAMiH,EAAeO,EAASnI,KAC1BuF,EAAS4C,EAAS5C,OAEtB,IAAK4C,EAAS9C,SAAU,CACpB,IAAMrD,EAAQlF,KAAK6D,MAAM7D,KAAK4D,kBAAkBsB,MAC5CoG,EAAsBtL,KAAKqE,gBAAgBzB,YAC3C2I,EAAeD,EAAoBrI,WACnCuI,EAAcF,EAAoBvI,cAClC0I,EAAgBX,EAAa7H,WAC7ByI,EAAeZ,EAAa/H,cAC5BL,EAAY,EAWhB,GATI8I,IAAgBE,EACZH,IAAiBE,IACjB/I,EAAY6I,EAAeE,EAAgB,GAAK,GAGpD/I,EAAY8I,EAAcE,EAAe,GAAK,EAGlD1L,KAAKqE,gBAAgBvD,eAAegK,GAClB,IAAdpI,EAAiB,CAKjB,IAJA,IAAMe,EAAuBzD,KAAK0B,MAAMC,UAEpCgK,EAAwBrB,KAAKsB,OAAO1K,KAAKyI,IAAImB,EAAa/H,cAAe+H,EAAa7H,WAAY6H,EAAa3H,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YADtN,OAGJ7D,EAAI,EAAGA,EAAI,GAAIA,GAAK,EACzB4F,EAAM5F,GAAG4J,UAAW,EAGpByC,GAAyB,GAAKA,EAAwB,KACtDzG,EAAMyG,GAAuBzC,UAAW,EACxClJ,KAAK8K,aAAe5F,EAAMyG,SAG9B3L,KAAK4E,gBAAiB,EACtB5E,KAAK6L,UAAUnJ,GAIvB1C,KAAK0E,eAAevC,KAAK,CAAC4I,aAAcD,EAAcrC,OAAMA,EAAEF,SAAU8C,EAAS9C,aAGrFnE,EAAAvD,UAAAgL,UAAA,SAAUnJ,GACY,IAAdA,EACA1C,KAAK2G,OAAOO,aACU,IAAfxE,GACP1C,KAAK2G,OAAOQ,aAIpB/C,EAAAvD,UAAAmK,kBAAA,SAAkBvH,EAA4BqI,GAO1C,IANA,IAAMR,EAAsBtL,KAAKqE,gBAAgBzB,YAC7CmJ,EAAQ,IAAI7K,KAEZyK,EAAwBrB,KAAKsB,OAAO1K,KAAKyI,IAAI2B,EAAoBvI,cAAeuI,EAAoBrI,WAAYqI,EAAoBnI,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YAD3O,OAET6I,EAAuB1B,KAAKsB,OAAO1K,KAAKyI,IAAIoC,EAAMhJ,cAAegJ,EAAM9I,WAAY8I,EAAM5I,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YAFhM,OAIJ7D,EAAI,EAAGA,EAAI,GAAIA,GAAK,EACzBwM,EAAK5G,MAAM5F,GAAG4J,UAAW,EAGzByC,GAAyB,GAAKA,EAAwB,KAAOG,EAAK5G,MAAMyG,GAAuBpD,WAAavI,KAAKsE,YAActE,KAAK4E,iBACpIkH,EAAK5G,MAAMyG,GAAuBzC,UAAW,EAC7ClJ,KAAK8K,aAAegB,EAAK5G,MAAMyG,IAE/B3L,KAAK8K,aAAe,CAChB5H,KAAM,KACNuF,OAAQ,GACRC,MAAO,KACPC,UAAW,KACXJ,UAAU,GAIdyD,GAAwB,GAAKA,EAAuB,KACpDF,EAAK5G,MAAM8G,GAAsB5G,SAAU,IAInDhB,EAAAvD,UAAAoL,cAAA,SAAcC,GACVlM,KAAKyE,gBAAgBtC,KAAK+J,6CAvhBOnM,KAIKlB,EAAA,CAAzCsN,EAAAA,UAAU,cAAe,CAACC,QAAQ,kCAE1BvN,EAAA,CAARwN,EAAAA,6DACQxN,EAAA,CAARwN,EAAAA,qEACQxN,EAAA,CAARwN,EAAAA,4DAEQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sCACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,mCACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,6CAESxN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,gDACSzN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,+CA/BQlI,EAAkBwE,EAAA/J,EAAA,CA1N9B0N,EAAAA,UAAU,CACPC,SAAU,YACVC,SAAU,q1NA8HD,s2EA0FArI,mBC2QT,SAAAsI,EAAoBrI,EAA0CsI,GAA1C3M,KAAAqE,gBAAAA,EAA0CrE,KAAA2M,IAAAA,EAI/B3M,KAAA4M,OAAQ,EAiB9B5M,KAAAsE,YAAa,EAIbtE,KAAAuE,IAAM,GACNvE,KAAA6M,aAAe,EASd7M,KAAAkC,eAAiB,IAAIsC,EAAAA,aACrBxE,KAAAyE,gBAAkB,IAAID,EAAAA,aACtBxE,KAAA0E,eAAiB,IAAIF,EAAAA,aACrBxE,KAAA8M,oBAAsB,IAAItI,EAAAA,aAC1BxE,KAAA2E,eAAiB,IAAIH,EAAAA,cAAqB,GAE7CxE,KAAA6D,MAAqB,GACrB7D,KAAA4D,iBAAmB,EAEnB5D,KAAA0C,UAAY,EACZ1C,KAAAqC,KAAqB,OAEpBrC,KAAA6E,QAAS,EACT7E,KAAA8E,gBAAiB,QAwtB7B,SA1wBa4H,EA+DFA,EAAAK,kBAAP,SAAyBpL,EAAiBqL,EAAmBC,EAAiBC,GAC1E,IAGIC,EACAC,EAJEC,EAA0B,GAE5BzK,EAAcjB,EAAUwB,UAIxB+J,EAAe,GACfC,EAAW7C,KAAKC,MAAM,EAAI2C,GAC1BE,EAAU,KAEVD,EAAW,EACXC,EAAU9C,KAAKC,MAAM,GAAK2C,IAG9B,IAAK,IAAII,EAAON,EAAWM,EAAOL,EAASK,GAAQH,EAC/C,IAAK,IAAII,EAAW,EAAGA,EAAW,GAAIA,GAAYH,EAAS,CAEvD,IADA,IAAMI,EAAsB,GACnBC,EAAM,EAAGA,EAAM,EAAGA,GAAO,EAAG,CACjC,IAAMC,EAAO,IAAIxM,KAAKS,EAAUC,WAChC8L,EAAK3L,SAlBC,EAkBsBuL,EAAMC,GAClCG,EAAKrI,QAAQzC,EAAc6K,GAC3BD,EAAIzJ,KAAK,CACL0E,OAAQ,GACRiF,KAAIA,IAGZL,EAAMtJ,KAAKyJ,GAGnB,OAAOH,GAGJX,EAAA3H,SAAP,SAAgBpD,EAAiBsD,GAI7B,IAHA,IAAMC,EAAQ,IAAIC,MAAMF,GACpBG,EAAU,IAAIlE,KAAKS,EAAUC,WAC7BjC,EAAI,EACDA,EAAIsF,GACPC,EAAMvF,KAAO,CACTuD,KAAM,IAAIhC,KAAKkE,EAAQxD,WACvB6G,OAAQ,GACRkF,UAAW,IAEfvI,EAAQC,QAAQD,EAAQjC,UAAY,GAExC,OAAO+B,GAGIwH,EAAAkB,0BAAf,SAAyCC,EAAuBC,GAC5D,OAAOD,EAAOE,YAAcD,EAAOC,aAGxBrB,EAAAsB,eAAf,SAA8BC,EAAgCC,EAAcC,GACxE,IAAMC,EAAYF,EAAOC,EACrBE,EAAQ,IAAIlJ,MAAMiJ,GAGtBH,EAActD,MAAK,SAACkD,EAAQC,GACxB,OAAOA,EAAOQ,SAAWT,EAAOS,YAEpC,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAWG,GAAK,EAChCF,EAAME,GAAK,CACPC,YAAY,EACZ/F,OAAQ,IAIhB,IADA,IAAMgB,EAAMwE,EAAc5O,OACjBoP,EAAI,EAAGA,EAAIhF,EAAKgF,GAAK,EAG1B,IAFA,IAAM5E,EAAQoE,EAAcQ,GACxBpE,EAAQR,EAAM6E,WAAaP,EAAYtE,EAAMkE,YAC1C1D,EAAQR,EAAMW,SAAW2D,EAAYtE,EAAM8E,WAC9CN,EAAMhE,GAAO5B,OAAO1E,KAAK8F,GACzBQ,GAAS,EAKjB,IADA,IAAI1K,EAAI,EACDA,EAAI8J,GAAK,CACZ,IAAImF,EAAQX,EAActO,GAC1B,IAAKiP,EAAMC,cAAe,CACtB,IAAMA,EAAgBD,EAAMN,SAAW,EACvCM,EAAMC,cAAgBA,EAEtB,IADA,IAAMC,EAAa,CAACF,GACbA,EAAQE,EAAWC,SAEtB,IADI1E,EAAQuE,EAAMF,WAAaP,EAAYS,EAAMb,YAC1C1D,EAAQuE,EAAMpE,SAAW2D,EAAYS,EAAMD,WAAW,CACzD,IAAKN,EAAMhE,GAAOmE,aACdH,EAAMhE,GAAOmE,YAAa,EACtBH,EAAMhE,GAAO5B,QAEb,IADA,IAAMuG,EAAmBX,EAAMhE,GAAO5B,OAAOpJ,OACpC4P,EAAI,EAAGA,EAAID,EAAkBC,GAAK,EAAG,CAC1C,IAAMC,EAAqBb,EAAMhE,GAAO5B,OAAOwG,GAC1CC,EAAmBL,gBACpBK,EAAmBL,cAAgBA,EACnCC,EAAW/K,KAAKmL,IAKhC7E,GAAS,GAIrB1K,GAAK,IAIb+M,EAAA7L,UAAAyE,SAAA,WAAA,IAAAC,EAAAvF,KAOI,GANKA,KAAKwF,gBACNxF,KAAKwF,cAAgB,IAEzBxF,KAAKwF,cAAcC,MAAO,EAE1BzF,KAAKmP,WAAanP,KAAKiN,QAAUjN,KAAKgN,WAAahN,KAAKoP,aACpDpP,KAAK0F,eAAiB1F,KAAK0F,cAAc2J,wBACzCrP,KAAKqG,gBAAkBrG,KAAK0F,cAAc2J,4BACvC,CACH,IAAMlJ,EAAW,IAAIL,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKqG,gBAAkB,SAAUnD,GAC7B,OAAOiD,EAASJ,UAAU7C,EAAMlD,KAAKqP,0BAI7C,GAAIrP,KAAK0F,eAAiB1F,KAAK0F,cAAc4J,oBACzCtP,KAAKuG,YAAcvG,KAAK0F,cAAc4J,wBACnC,CACH,IAAM9I,EAAW,IAAIV,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKuG,YAAc,SAAUrD,GACzB,OAAOsD,EAAST,UAAU7C,EAAMlD,KAAKuP,kBAI7C,GAAIvP,KAAK0F,eAAiB1F,KAAK0F,cAAc8J,yBACzCxP,KAAKyP,sBAAwBzP,KAAK0F,cAAc8J,6BAC7C,CACH,IAAME,EAAW,IAAI5J,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKyP,sBAAwB,SAAUvM,GACnC,OAAOwM,EAAS3J,UAAU7C,EAAMlD,KAAK2P,mBAIzC3P,KAAK0G,iBACL1G,KAAK2G,OAAOD,iBAAgB,GAG5B1G,KAAK4G,YACL5G,KAAK2G,OAAOC,YAAW,GAG3B5G,KAAK6G,cACL7G,KAAK4P,iBAAmB5P,KAAK6P,sBAC7B7P,KAAK6E,QAAS,EAEd7E,KAAK8G,yCAA2C9G,KAAKqE,gBAAgB9D,8BAA8BwG,WAAU,SAAAnE,GACzG2C,EAAKsB,iBAGT7G,KAAKgH,+BAAiChH,KAAKqE,gBAAgB3D,oBAAoBqG,WAAU,WACrFxB,EAAK/D,kBAGTxB,KAAKiH,yBAA2BjH,KAAKqE,gBAAgB1D,cAAcoG,WAAU,SAAArE,GACvD,IAAdA,EACA6C,EAAKoB,OAAOO,aACU,IAAfxE,GACP6C,EAAKoB,OAAOQ,eAIpBnH,KAAKoH,yBAA2BpH,KAAKqE,gBAAgBzD,cAAcmG,WAAU,WACzExB,EAAKoB,OAAOzC,aAIpBwI,EAAA7L,UAAA8G,gBAAA,WACI,IAAMC,EAAQ5H,KAAK6H,WAGnB,GAFA7H,KAAK2E,eAAexC,KAAKyF,GAErB5H,KAAK6M,aAAe,EAAG,CACvB,IAAMiD,EAAc9P,KAAK2M,IAAIoD,cAAcC,cAAc,oCAAoCC,iBAAiB,yBACxGC,EAAKlQ,KACXmQ,YAAW,WACPD,EAAGE,mBAAqBN,EAAYI,EAAGrD,aAAeqD,EAAGlD,WAAWqD,YACrE,MAIX3D,EAAA7L,UAAA0G,YAAA,SAAYC,GACR,GAAKxH,KAAK6E,OAAV,EAIK2C,EAAQwF,YAAaxF,EAAQyF,SAAczF,EAAQwF,UAAUsD,iBAAoB9I,EAAQyF,QAAQqD,kBAClGtQ,KAAK6D,WAAQ0M,EACbvQ,KAAKmP,WAAanP,KAAKiN,QAAUjN,KAAKgN,WAAahN,KAAKoP,aACxDpP,KAAK0C,UAAY,EACjB1C,KAAK6G,cACL7G,KAAK4P,iBAAmB5P,KAAK6P,uBAGjC,IAAMpI,EAAoBD,EAAQjG,YAC9BkG,GAAqBA,EAAkBC,cACvC1H,KAAKwB,eAGT,IAAMkF,EAAkBc,EAAQd,gBAC5BA,GACA1G,KAAK2G,OAAOD,gBAAgBA,EAAgBgB,cAGhD,IAAMd,EAAaY,EAAQZ,WACvBA,GACA5G,KAAK2G,OAAOC,WAAWA,EAAWc,gBAI1CgF,EAAA7L,UAAAwG,YAAA,WACQrH,KAAK8G,2CACL9G,KAAK8G,yCAAyCQ,cAC9CtH,KAAK8G,yCAA2C,MAGhD9G,KAAKgH,iCACLhH,KAAKgH,+BAA+BM,cACpCtH,KAAKgH,+BAAiC,MAGtChH,KAAKiH,2BACLjH,KAAKiH,yBAAyBK,cAC9BtH,KAAKiH,yBAA2B,MAGhCjH,KAAKoH,2BACLpH,KAAKoH,yBAAyBE,cAC9BtH,KAAKoH,yBAA2B,OAIxCsF,EAAA7L,UAAAiH,eAAA,WAAA,IAAAvC,EAAAvF,KACI,GAAIA,KAAK8E,eACL9E,KAAK8E,gBAAiB,MAD1B,CAKA,IAAMlB,EAAmB5D,KAAK4D,iBAC1BlB,EAAY,EAEhB1C,KAAK2G,OAAOoB,iBAAiBC,MAAK,SAAAC,GAC9BA,GAAqBA,EAAoB,GAAK,EAC3CC,MAAMD,KACLA,EAAoBrE,GAGpBqE,EAAoBrE,GAAqB,EACzClB,EAAY,EACiB,IAAtBuF,GAAgD,IAArBrE,GAClClB,EAAY,EACZ6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IACnBvE,EAAmBqE,GAAsB,EAChDvF,GAAa,EACgB,IAAtBuF,GAAgD,IAArBrE,IAClClB,GAAa,EACb6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IAE9B5C,EAAK3B,iBAAmBqE,EACxB1C,EAAK6C,KAAK1F,QAIlBgK,EAAA7L,UAAAuH,KAAA,SAAK1F,GACD,GAAkB,IAAdA,EAAJ,CAGA1C,KAAK0C,UAAYA,EACjB,IAAM8N,EAAWxQ,KAAKqE,gBAAgB5B,wBAAwBzC,KAAKqC,KAAMK,GACzE1C,KAAKqE,gBAAgBvD,eAAe0P,GACpCxQ,KAAK6G,cACL7G,KAAK0C,UAAY,IAGbgK,EAAA7L,UAAAgP,oBAAR,WAEI,IADA,IAAMD,EAA6B,GAC1BtC,EAAO,EAAGmD,EAASzQ,KAAK6D,MAAM,GAAG6M,KAAKrR,OAAQiO,EAAOmD,EAAQnD,GAAQ,EAE1E,GAAa,IAATA,GAActN,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAM,GAAGI,KAAK1L,aAAehC,KAAKgN,UAAW,CAC9E,IAAMU,EAAO,IAAIxM,KAAKlB,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAM,GAAGI,MAClDA,EAAKrI,QAAQqI,EAAKvK,UAAY,GAC9BuK,EAAK3L,SAAS/B,KAAKgN,WACnB4C,EAAiB7L,KAAK/D,KAAKyP,sBAAsB/B,SAEjDkC,EAAiB7L,KAAK/D,KAAKyP,sBAAsBzP,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAM,GAAGI,OAGrF,OAAOkC,GAGXlD,EAAA7L,UAAAiD,YAAA,SAAYnC,GAER,IADA,IAAMuD,EAAQyL,EAAkB5L,SAASpD,EAAW,GAC3ChC,EAAI,EAAGA,EAAI,EAAGA,IACnBuF,EAAMvF,GAAGgO,UAAY3N,KAAKqG,gBAAgBnB,EAAMvF,GAAGuD,MAGvD,MAAO,CACHwN,KAAMC,EAAkB5D,kBAAkBpL,EAAW3B,KAAKgN,UAAWhN,KAAKiN,QAASjN,KAAKoP,cACxFlK,MAAKA,IAIbwH,EAAA7L,UAAA0C,SAAA,SAASX,GACL,IAAME,EAAOF,EAAYG,cACrBC,EAAQJ,EAAYK,WACpBC,EAAON,EAAYO,UAEnBiG,EADMxG,EAAY0G,SACCtJ,KAAK4Q,gBAU5B,OARIxH,EAAa,IACbA,GAAc,GAOX,CACHzH,UAJmB,IAAIT,KAAK4B,EAAME,EAAOE,EAAOkG,EAAY,GAAI,EAAG,GAKnEtH,QAJU,IAAIZ,KAAK4B,EAAME,EAAOE,EAAOkG,EAAa,EAAG,GAAI,EAAG,KAQtEsD,EAAA7L,UAAAW,aAAA,WAoBI,IAnBA,IAAMD,EAAcvB,KAAKuB,YACrBkI,EAAMlI,EAAcA,EAAYlC,OAAS,EACzCsC,EAAY3B,KAAK0B,MAAMC,UACvBG,EAAU9B,KAAK0B,MAAMI,QACrB4H,EAAexI,KAAKyI,IAAIhI,EAAUoB,cAAepB,EAAUsB,WAAYtB,EAAUwB,WACjFyG,EAAa1I,KAAKyI,IAAI7H,EAAQiB,cAAejB,EAAQmB,WAAYnB,EAAQqB,WACzES,EAAmB5D,KAAK4D,iBACxB8M,EAAO1Q,KAAK6D,MAAMD,GAAkB8M,KACpCxL,EAAQlF,KAAK6D,MAAMD,GAAkBsB,MAKrC2L,EAAqB7Q,KAAKgN,UAAYhN,KAAKoP,aAC3C0B,EAAmB9Q,KAAKiN,QAAUjN,KAAKoP,aACvC2B,EAAU,GAAK/Q,KAAKoP,aACpB4B,GAAqB,EACrBC,GAAqB,EAEhBtR,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxBuF,EAAMvF,GAAG8I,OAAS,GAClBvD,EAAMvF,GAAGsJ,UAAW,EAGxB,IAAK,IAAIwE,EAAM,EAAGA,EAAM,EAAGA,GAAO,EAC9B,IAAK,IAAIH,EAAO,EAAGA,EAAOtN,KAAKmP,UAAW7B,GAAQ,EAC9CoD,EAAKpD,GAAMG,GAAKhF,OAAS,GAGjC,IAAS9I,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAAG,CAC7B,IAAMuR,EAAQ3P,EAAY5B,GACpBmK,EAAiBoH,EAAMvP,UACvBoI,EAAemH,EAAMpP,QAEvBkI,OAAiB,EACjBC,OAAe,EAUnB,GARIiH,EAAMhH,QACNF,EAAoBF,EAAelI,UACnCqI,EAAkBF,EAAanI,YAE/BoI,EAAoB9I,KAAKyI,IAAIG,EAAe/G,cAAe+G,EAAe7G,WAAY6G,EAAe3G,WACrG8G,EAAkB/I,KAAKyI,IAAII,EAAahH,cAAegH,EAAa9G,WAAY8G,EAAa5G,UAAY,MAGzG8G,GAAmBP,GAAgBM,GAAqBJ,GAAcE,GAAkBC,GAI5F,GAAImH,EAAMhH,OAAQ,CACd8G,GAAqB,EAErB,IAAIG,OAAgB,EAcdC,EAAoC,CACtClF,MAAKgF,EACLxC,WAdAyC,EADAnH,GAAqBN,EACF,EAEAY,KAAKsB,OAAO5B,EAAoBN,GA9ClD,OA2DDc,SATAP,GAAmBL,EACFU,KAAKsB,OAAOhC,EAAaF,GAnDzC,OAqDgBY,KAAKsB,OAAO3B,EAAkBP,GArD9C,SA8DDgB,EAAWxF,EAAMiM,GAAkB1I,QAEnCiC,EAAS3G,KAAKqN,KAEd1G,EAAW,IACF3G,KAAKqN,GACdlM,EAAMiM,GAAkB1I,OAASiC,GAErCxF,EAAMiM,GAAkBlI,UAAW,MAChC,CACHgI,GAAqB,EAErB,IAAI9G,OAAmB,EAEnBA,EADAH,EAAoBN,EACE,GAECM,EAAoBN,GA/EzC,KA+EmE1J,KAAKoP,cAAgBtF,EAAe9H,WAAa8H,EAAeuH,aAAe,IAAMrR,KAAKoP,aAGnK,IAAIhF,OAAiB,EAEjBA,EADAH,EAAkBL,GACGA,EAAaF,GApFhC,KAoF0D1J,KAAKoP,cAE5CnF,EArFpB,MAqF+CP,GAtF9C,KAsFwE1J,KAAKoP,cAAgBrF,EAAa/H,WAAa+H,EAAasH,aAAe,IAAMrR,KAAKoP,aAGpK,IAAMV,EAAapE,KAAKC,MAAMJ,GAC1BK,EAAWF,KAAKG,KAAKL,EAvFvB,MAwFEkH,EAAgB5C,EAAaqC,EAC7BQ,EAAWjH,KAAKC,MAAMmE,EAAaqC,GACnCS,EAAWD,EAAWR,EACtBhD,EAAc,EACdY,EAAY,EAEO,IAAnB3O,KAAKmO,YAEDJ,EADAuD,EAAgBT,EACF,EAEAvG,KAAKC,OAAOJ,EAAsBuE,GAAc1O,KAAKmO,YAI3E,EAAG,CAEC,IAAIsD,OAAW,EA2Bf,IA5BAD,GAAYT,GAEGvG,EACXiH,EAAcV,GAGVU,EADAD,IAAahH,EACCuG,EAEAvG,EAAWuG,EAEN,IAAnB/Q,KAAKmO,YAEDQ,EADA8C,EAAcX,EACF,EAEAxG,KAAKC,OAAOC,EAAWJ,GAAqBpK,KAAKmO,aAIrEmD,EAAgBT,EAChBS,EAAgB,EAEhBA,GAAiBT,EAEjBY,EAAcX,IACdW,EAAcX,GAIdQ,GAFJG,GAAeZ,GAEkB,CAC7B,IAOInG,EAPEgH,EAAe,CACjBxF,MAAKgF,EACLxC,WAAY4C,EACZ9G,SAAUiH,EACV1D,YAAWA,EACXY,UAASA,IAETjE,EAAWgG,EAAKY,GAAeC,GAAU9I,QAEzCiC,EAAS3G,KAAK2N,KAEdhH,EAAW,IACF3G,KAAK2N,GACdhB,EAAKY,GAAeC,GAAU9I,OAASiC,GAE3CxF,EAAMqM,GAAUtI,UAAW,EAE/BqI,EAAgB,EAChBvD,EAAc,EACdwD,GAAY,QACPC,EAAWhH,IAI5B,GAAIyG,EACA,IAASxD,EAAM,EAAGA,EAAM,EAAGA,GAAO,EAAG,CACjC,IAAIQ,EAAiC,GACrC,IAASX,EAAO,EAAGA,EAAOtN,KAAKmP,UAAW7B,GAAQ,EAC1CoD,EAAKpD,GAAMG,GAAKhF,SAChBiI,EAAKpD,GAAMG,GAAKhF,OAAOkC,KAAKgG,EAAkB/C,2BAC9CK,EAAgBA,EAAc0D,OAAOjB,EAAKpD,GAAMG,GAAKhF,SAGzDwF,EAAc5O,OAAS,GACvBW,KAAK4R,YAAY3D,GAK7B,GAAI+C,EAAoB,CACpB,IAAIa,EAAuC,GAC3C,IAASpE,EAAM,EAAGA,EAAM,EAAGA,GAAO,EAC1BvI,EAAMuI,GAAKhF,SACXoJ,EAAsBA,EAAoBF,OAAOzM,EAAMuI,GAAKhF,SAGhEoJ,EAAoBxS,OAAS,GAC7BW,KAAK8R,kBAAkBD,GAI/B,GAAI7R,KAAKsE,WAAY,CAGjB,IAFA,IAAIuG,GAAe,EACfC,OAAY,EACPxL,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxB,GAAI4F,EAAM5F,GAAG4J,SAAU,CACnB4B,EAAe5F,EAAM5F,GACrBuL,GAAe,EACf,MAIR,GAAIA,EAAc,CACd,IAAItC,GAAW,EACXvI,KAAKwI,eACLD,EAAWvI,KAAKwI,aAAasC,EAAa5H,OAG9ClD,KAAK0E,eAAevC,KAAK,CACrB4I,aAAcD,EAAa5H,KAC3BuF,OAAQqC,EAAarC,OAAOsJ,KAAI,SAAAC,GAAK,OAAAA,EAAE9F,SACvC3D,SAAQA,OAMxBmE,EAAA7L,UAAAgG,YAAA,WAGI,GAFA7G,KAAK0B,MAAQ1B,KAAKuD,SAASvD,KAAKqE,gBAAgBzB,aAE5C5C,KAAK6E,OAAQ,CACb,IAAM+C,EAAQ5H,KAAK6H,WACnB7H,KAAK2E,eAAexC,KAAKyF,GAE7B5H,KAAKqE,gBAAgBb,sBAAsBxD,MAC3CA,KAAKgL,kBAAkBhL,KAAK0B,MAAMC,UAAW3B,KAAK6D,MAAM7D,KAAK4D,mBAC7D5D,KAAKqE,gBAAgBjD,aAAapB,OAGtC0M,EAAA7L,UAAAgH,SAAA,WACI,IAAMoK,EAAiB,IAAI/Q,KAAKlB,KAAK0B,MAAMC,UAAUC,WAErD,OADAqQ,EAAelQ,SAAS,GAAI,EAAG,EAAG,GAC3B/B,KAAKuG,YAAY0L,IAG5BvF,EAAA7L,UAAAkI,kBAAA,SAAkB7F,GACd,IAAI8F,EAAY,GAuBhB,OArBI9F,EAAK+F,WACDD,IACAA,GAAa,KAEjBA,EAAY,uBAGZ9F,EAAKgG,WACDF,IACAA,GAAa,KAEjBA,GAAa,qBAGb9F,EAAKkC,UACD4D,IACAA,GAAa,KAEjBA,GAAa,oBAGVA,GAGX0D,EAAA7L,UAAAuK,OAAA,SAAOL,EAAoBtC,GACvB,IAAIF,GAAW,EACXvI,KAAKwI,eACLD,EAAWvI,KAAKwI,aAAauC,IAGjC/K,KAAK0E,eAAevC,KAAK,CACrB4I,aAAYA,EACZtC,OAAQA,EAAOsJ,KAAI,SAAAC,GAAK,OAAAA,EAAE9F,SAC1B3D,SAAQA,KAIhBmE,EAAA7L,UAAA+Q,YAAA,SAAY3D,GACRjO,KAAKkS,kBAAkBjE,GACvB0C,EAAkB3C,eAAeC,EAAejO,KAAKmP,UAAWnP,KAAKmO,YAGzEzB,EAAA7L,UAAAiR,kBAAA,SAAkB7D,GACdjO,KAAKkS,kBAAkBjE,IAG3BvB,EAAA7L,UAAAsR,QAAA,SAAQjH,EAAuBC,GAC3B,IAAIiH,EAAalH,EACbmH,EAAYlH,EAMhB,OALID,EAAOwD,WAAavD,EAAOuD,YAAexD,EAAOwD,aAAevD,EAAOuD,YAAcxD,EAAO6C,YAAc5C,EAAO4C,eACjHqE,EAAajH,EACbkH,EAAYnH,KAGZkH,EAAW5H,UAAY6H,EAAU3D,eAGxB0D,EAAW5H,SAAW6H,EAAU3D,YAAe,GAAK0D,EAAWzD,UAAY0D,EAAUtE,aAAe/N,KAAKmO,YAI1HzB,EAAA7L,UAAAqR,kBAAA,SAAkBzJ,GAKd,IAJA,IAAMgB,EAAMhB,EAAOpJ,OACfiT,EAAc,IAAInN,MAAMsE,GACxB8I,EAAY,EAEP5S,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAAG,CAC7B,IAAI6S,OAAG,EACP,IAAKA,EAAM,EAAGA,EAAMD,EAAWC,GAAO,EAClCF,EAAYE,IAAO,EAEvB,IAAK,IAAIvD,EAAI,EAAGA,EAAItP,EAAGsP,GAAK,EACpBjP,KAAKmS,QAAQ1J,EAAO9I,GAAI8I,EAAOwG,MAC/BqD,EAAY7J,EAAOwG,GAAGX,WAAY,GAG1C,IAAKkE,EAAM,EAAGA,EAAMD,GACXD,EAAYE,GADUA,GAAO,GAMlC/J,EAAO9I,GAAG2O,SADVkE,EAAMD,EACeC,EAEAD,IAI7B,GAAiB,QAAbvS,KAAKuE,IACL,IAAS5E,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAC1B8I,EAAO9I,GAAG2O,SAAWiE,EAAY,EAAI9J,EAAO9I,GAAG2O,UAK3D5B,EAAA7L,UAAAmK,kBAAA,SAAkBvH,EAA4BqI,GAO1C,IANA,IAAMR,EAAsBtL,KAAKqE,gBAAgBzB,YAC7CmJ,EAAQ,IAAI7K,KAEZyK,EAAwBrB,KAAKsB,OAAO1K,KAAKyI,IAAI2B,EAAoBvI,cAAeuI,EAAoBrI,WAAYqI,EAAoBnI,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YAD3O,OAET6I,EAAuB1B,KAAKC,OAAOrJ,KAAKyI,IAAIoC,EAAMhJ,cAAegJ,EAAM9I,WAAY8I,EAAM5I,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YAFhM,OAIJ7D,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxBwM,EAAK5G,MAAM5F,GAAG4J,UAAW,EAGzByC,GAAyB,GAAKA,EAAwB,GAAK3L,KAAKsE,aAChEwH,EAAK5G,MAAMyG,GAAuBzC,UAAW,GAG7C8C,GAAwB,GAAKA,EAAuB,IACpDF,EAAK5G,MAAM8G,GAAsB5G,SAAU,IAInDsH,EAAA7L,UAAA4R,YAAA,SAAYpH,GACR,IAAMP,EAAeO,EAASnI,KAC1BgC,EAAQlF,KAAK6D,MAAM7D,KAAK4D,kBAAkBsB,MAC1CzB,EAAuBzD,KAAK0B,MAAMC,UAElCgK,EAAwBrB,KAAKsB,OAAO1K,KAAKyI,IAAImB,EAAa/H,cAAe+H,EAAa7H,WAAY6H,EAAa3H,WAAajC,KAAKyI,IAAIlG,EAAqBV,cAAeU,EAAqBR,WAAYQ,EAAqBN,YADtN,OAGbnD,KAAKqE,gBAAgBvD,eAAegK,GAEpC,IAAK,IAAIxL,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxB4F,EAAM5F,GAAG4J,UAAW,EAGpByC,GAAyB,GAAKA,EAAwB,IACtDzG,EAAMyG,GAAuBzC,UAAW,GAG5C,IAAIX,GAAW,EACXvI,KAAKwI,eACLD,EAAWvI,KAAKwI,aAAasC,IAGjC9K,KAAK8M,oBAAoB3K,KAAK,CAAC4I,aAAcD,EAAcrC,OAAQ4C,EAAS5C,OAAOsJ,KAAI,SAAAC,GAAK,OAAAA,EAAE9F,SAAQ3D,SAAQA,KAGlHmE,EAAA7L,UAAA6R,kBAAA,SAAkBC,GACd3S,KAAKoQ,mBAAqBuC,4CAtwBO5S,SAA8B6S,EAAAA,cAG1B/T,EAAA,CAAxCsN,EAAAA,UAAU,aAAc,CAACC,QAAQ,kCACHvN,EAAA,CAA9BgU,EAAAA,YAAY,+CAEJhU,EAAA,CAARwN,EAAAA,sDACQxN,EAAA,CAARwN,EAAAA,2DACQxN,EAAA,CAARwN,EAAAA,2DACQxN,EAAA,CAARwN,EAAAA,kEACQxN,EAAA,CAARwN,EAAAA,kEACQxN,EAAA,CAARwN,EAAAA,0EACQxN,EAAA,CAARwN,EAAAA,0EAEQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,uDACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sCACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,mCACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,uCACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,4CAESxN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,gDACSzN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,oDACSzN,EAAA,CAATyN,EAAAA,+CAzCQI,EAAiBiE,EAAA9R,EAAA,CAjd7B0N,EAAAA,UAAU,CACPC,SAAU,WACVC,SAAU,ojhBA6cVqG,cAAeC,EAAAA,kBAAkBC,aA9LxB,04JAgMAtG,mBCvGT,SAAAuG,EAAoB5O,EAA0CsI,GAA1C3M,KAAAqE,gBAAAA,EAA0CrE,KAAA2M,IAAAA,EAIhC3M,KAAA4M,OAAQ,EAiB7B5M,KAAAuE,IAAM,GACNvE,KAAA6M,aAAe,EASd7M,KAAAkC,eAAiB,IAAIsC,EAAAA,aACrBxE,KAAAyE,gBAAkB,IAAID,EAAAA,aACtBxE,KAAA0E,eAAiB,IAAIF,EAAAA,aACrBxE,KAAA2E,eAAiB,IAAIH,EAAAA,cAAqB,GAE7CxE,KAAA6D,MAAoB,GACpB7D,KAAA4D,iBAAmB,EACnB5D,KAAA0C,UAAY,EACZ1C,KAAAqC,KAAqB,MAGpBrC,KAAA6E,QAAS,EACT7E,KAAA8E,gBAAiB,QAygB7B,SAtjBamO,EAyDFA,EAAAlG,kBAAP,SAAyBpL,EAAiBqL,EAAmBC,EAAiBC,GAC1E,IAGIQ,EACAP,EACAC,EALEsD,EAAsB,GAExB9N,EAAcjB,EAAUwB,UAKxB+J,EAAe,GACfC,EAAW7C,KAAKC,MAAM,EAAI2C,GAC1BE,EAAU,KAEVD,EAAW,EACXC,EAAU9C,KAAKC,MAAM,GAAK2C,IAG9B,IAAK,IAAII,EAAON,EAAWM,EAAOL,EAASK,GAAQH,EAC/C,IAAK,IAAII,EAAW,EAAGA,EAAW,GAAIA,GAAYH,GAC9CM,EAAO,IAAIxM,KAAKS,EAAUC,YACrBG,SAjBK,EAiBkBuL,EAAMC,GAClCG,EAAKrI,QAAQzC,GACb8N,EAAK3M,KAAK,CACN2J,KAAIA,EACJjF,OAAQ,KAIpB,OAAOiI,GAGIuC,EAAArF,0BAAf,SAAyCC,EAAuBC,GAC5D,OAAOD,EAAOE,YAAcD,EAAOC,aAGxBkF,EAAAjF,eAAf,SAA8BC,EAAgCC,EAAcC,GACxE,IAAMC,EAAYF,EAAOC,EACrBE,EAA6D,IAAIlJ,MAAMiJ,GAG3EH,EAActD,MAAK,SAACkD,EAAQC,GACxB,OAAOA,EAAOQ,SAAWT,EAAOS,YAEpC,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAWG,GAAK,EAChCF,EAAME,GAAK,CACPC,YAAY,EACZ/F,OAAQ,IAIhB,IADA,IAAMgB,EAAMwE,EAAc5O,OACjBoP,EAAI,EAAGA,EAAIhF,EAAKgF,GAAK,EAG1B,IAFA,IAAM5E,EAAQoE,EAAcQ,GACxBpE,EAAQR,EAAM6E,WAAaP,EAAYtE,EAAMkE,YAC1C1D,EAAQR,EAAMW,SAAW2D,EAAYtE,EAAM8E,WAC9CN,EAAMhE,GAAO5B,OAAO1E,KAAK8F,GACzBQ,GAAS,EAKjB,IADA,IAAI1K,EAAI,EACDA,EAAI8J,GAAK,CACZ,IAAImF,EAAQX,EAActO,GAC1B,IAAKiP,EAAMC,cAAe,CACtB,IAAMA,EAAgBD,EAAMN,SAAW,EACvCM,EAAMC,cAAgBA,EAEtB,IADA,IAAMC,EAAa,CAACF,GACbA,EAAQE,EAAWC,SAEtB,IADI1E,EAAQuE,EAAMF,WAAaP,EAAYS,EAAMb,YAC1C1D,EAAQuE,EAAMpE,SAAW2D,EAAYS,EAAMD,WAAW,CACzD,IAAKN,EAAMhE,GAAOmE,aACdH,EAAMhE,GAAOmE,YAAa,EACtBH,EAAMhE,GAAO5B,QAEb,IADA,IAAMuG,EAAmBX,EAAMhE,GAAO5B,OAAOpJ,OACpC4P,EAAI,EAAGA,EAAID,EAAkBC,GAAK,EAAG,CAC1C,IAAMC,EAAqBb,EAAMhE,GAAO5B,OAAOwG,GAC1CC,EAAmBL,gBACpBK,EAAmBL,cAAgBA,EACnCC,EAAW/K,KAAKmL,IAKhC7E,GAAS,GAIrB1K,GAAK,IAIbsT,EAAApS,UAAAyE,SAAA,WAAA,IAAAC,EAAAvF,KAOI,GANKA,KAAKwF,gBACNxF,KAAKwF,cAAgB,IAEzBxF,KAAKwF,cAAcC,MAAO,EAE1BzF,KAAKmP,WAAanP,KAAKiN,QAAUjN,KAAKgN,WAAahN,KAAKoP,aACpDpP,KAAK0F,eAAiB1F,KAAK0F,cAAcwN,mBACzClT,KAAKuG,YAAcvG,KAAK0F,cAAcwN,uBACnC,CACH,IAAM/M,EAAW,IAAIL,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKuG,YAAc,SAASrD,GACxB,OAAOiD,EAASJ,UAAU7C,EAAMlD,KAAKmT,iBAI7C,GAAInT,KAAK0F,eAAiB1F,KAAK0F,cAAc0N,wBACzCpT,KAAKyP,sBAAwBzP,KAAK0F,cAAc0N,4BAC7C,CACH,IAAM5M,EAAW,IAAIV,EAAAA,SAAS9F,KAAKoG,QACnCpG,KAAKyP,sBAAwB,SAASvM,GAClC,OAAOsD,EAAST,UAAU7C,EAAMlD,KAAK2P,mBAIzC3P,KAAK0G,iBACL1G,KAAK2G,OAAOD,iBAAgB,GAG5B1G,KAAK4G,YACL5G,KAAK2G,OAAOC,YAAW,GAG3B5G,KAAK6G,cACL7G,KAAK4P,iBAAmB5P,KAAK6P,sBAE7B7P,KAAK6E,QAAS,EAEd7E,KAAK8G,yCAA2C9G,KAAKqE,gBAAgB9D,8BAA8BwG,WAAU,SAAAnE,GACzG2C,EAAKsB,iBAGT7G,KAAKgH,+BAAiChH,KAAKqE,gBAAgB3D,oBAAoBqG,WAAU,WACrFxB,EAAK/D,kBAGTxB,KAAKiH,yBAA2BjH,KAAKqE,gBAAgB1D,cAAcoG,WAAU,SAAArE,GACvD,IAAdA,EACA6C,EAAKoB,OAAOO,aACU,IAAfxE,GACP6C,EAAKoB,OAAOQ,eAIpBnH,KAAKoH,yBAA2BpH,KAAKqE,gBAAgBzD,cAAcmG,WAAU,WACzExB,EAAKoB,OAAOzC,aAIpB+O,EAAApS,UAAA8G,gBAAA,WACI,IAAMC,EAAQ5H,KAAK6H,WAGnB,GAFA7H,KAAK2E,eAAexC,KAAKyF,GAErB5H,KAAK6M,aAAe,EAAG,CACvB,IAAMiD,EAAc9P,KAAK2M,IAAIoD,cAAcC,cAAc,mCAAmCC,iBAAiB,yBACvGC,EAAKlQ,KACXmQ,YAAW,WACPD,EAAGE,mBAAqBN,EAAYI,EAAGrD,aAAeqD,EAAGlD,WAAWqD,YACrE,MAIX4C,EAAApS,UAAA0G,YAAA,SAAYC,GACR,GAAKxH,KAAK6E,OAAV,EAGK2C,EAAQwF,YAAaxF,EAAQyF,SAAczF,EAAQwF,UAAUsD,iBAAoB9I,EAAQyF,QAAQqD,kBAClGtQ,KAAK6D,WAAQ0M,EACbvQ,KAAKmP,WAAanP,KAAKiN,QAAUjN,KAAKgN,WAAahN,KAAKoP,aACxDpP,KAAK0C,UAAY,EACjB1C,KAAK6G,cACL7G,KAAK4P,iBAAmB5P,KAAK6P,uBAGjC,IAAMpI,EAAoBD,EAAQjG,YAC9BkG,GAAqBA,EAAkBC,cACvC1H,KAAKwB,eAGT,IAAMkF,EAAkBc,EAAQd,gBAC5BA,GACA1G,KAAK2G,OAAOD,gBAAgBA,EAAgBgB,cAGhD,IAAMd,EAAaY,EAAQZ,WACvBA,GACA5G,KAAK2G,OAAOC,WAAWA,EAAWc,gBAI1CuL,EAAApS,UAAAwG,YAAA,WACQrH,KAAK8G,2CACL9G,KAAK8G,yCAAyCQ,cAC9CtH,KAAK8G,yCAA2C,MAGhD9G,KAAKgH,iCACLhH,KAAKgH,+BAA+BM,cACpCtH,KAAKgH,+BAAiC,MAGtChH,KAAKiH,2BACLjH,KAAKiH,yBAAyBK,cAC9BtH,KAAKiH,yBAA2B,MAGhCjH,KAAKoH,2BACLpH,KAAKoH,yBAAyBE,cAC9BtH,KAAKoH,yBAA2B,OAIxC6L,EAAApS,UAAAiH,eAAA,WAAA,IAAAvC,EAAAvF,KACI,GAAIA,KAAK8E,eACL9E,KAAK8E,gBAAiB,MAD1B,CAKA,IAAIpC,EAAY,EACVkB,EAAmB5D,KAAK4D,iBAE9B5D,KAAK2G,OAAOoB,iBAAiBC,MAAK,SAACC,GAC/BA,GAAqBA,EAAoB,GAAK,EAC3CC,MAAMD,KACLA,EAAoBrE,GAGpBqE,EAAoBrE,GAAqB,EACzClB,EAAY,EACiB,IAAtBuF,GAAgD,IAArBrE,GAClClB,EAAY,EACZ6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IACnBvE,EAAmBqE,GAAsB,EAChDvF,GAAa,EACgB,IAAtBuF,GAAgD,IAArBrE,IAClClB,GAAa,EACb6C,EAAKoB,OAAOwB,QAAQ,EAAG,GAAG,IAE9B5C,EAAK3B,iBAAmBqE,EACxB1C,EAAK6C,KAAK1F,QAIlBuQ,EAAApS,UAAAuH,KAAA,SAAK1F,GACD,GAAkB,IAAdA,EAAJ,CAIA1C,KAAK0C,UAAYA,EACjB,IAAM2F,EAAerI,KAAKqE,gBAAgB5B,wBAAwBzC,KAAKqC,KAAMK,GAC7E1C,KAAKqE,gBAAgBvD,eAAeuH,GACpCrI,KAAK6G,cACL7G,KAAK0C,UAAY,IAGbuQ,EAAApS,UAAAgP,oBAAR,WAEI,IADA,IAAMD,EAA6B,GAC1BtC,EAAO,EAAGmD,EAASzQ,KAAK6D,MAAM,GAAG6M,KAAKrR,OAAQiO,EAAOmD,EAAQnD,GAAQ,EAE1E,GAAa,IAATA,GAActN,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAMI,KAAK1L,aAAehC,KAAKgN,UAAW,CAC3E,IAAMU,EAAO,IAAIxM,KAAKlB,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAMI,MAC/CA,EAAKrI,QAAQqI,EAAKvK,UAAY,GAC9BuK,EAAK3L,SAAS/B,KAAKgN,WACnB4C,EAAiB7L,KAAK/D,KAAKyP,sBAAsB/B,SAEjDkC,EAAiB7L,KAAK/D,KAAKyP,sBAAsBzP,KAAK6D,MAAM,GAAG6M,KAAKpD,GAAMI,OAGlF,OAAOkC,GAGXqD,EAAApS,UAAAiD,YAAA,SAAYnC,GACR,MAAO,CACH+O,KAAM2C,EAAiBtG,kBAAkBpL,EAAW3B,KAAKgN,UAAWhN,KAAKiN,QAASjN,KAAKoP,cACvFkE,aAAc,KAItBL,EAAApS,UAAA0C,SAAA,SAASX,GACL,IAAME,EAAOF,EAAYG,cACrBC,EAAQJ,EAAYK,WACpBC,EAAON,EAAYO,UAIvB,MAAO,CACHxB,UAJY,IAAIT,KAAK4B,EAAME,EAAOE,EAAM,GAAI,EAAG,GAK/CpB,QAJU,IAAIZ,KAAK4B,EAAME,EAAOE,EAAO,EAAG,GAAI,EAAG,KAQzD+P,EAAApS,UAAAW,aAAA,WAgBI,IAfA,IAAMD,EAAcvB,KAAKuB,YACrBkI,EAAMlI,EAAcA,EAAYlC,OAAS,EACzCsC,EAAY3B,KAAK0B,MAAMC,UACvBG,EAAU9B,KAAK0B,MAAMI,QACrB4H,EAAexI,KAAKyI,IAAIhI,EAAUoB,cAAepB,EAAUsB,WAAYtB,EAAUwB,WACjFyG,EAAa1I,KAAKyI,IAAI7H,EAAQiB,cAAejB,EAAQmB,WAAYnB,EAAQqB,WACzES,EAAmB5D,KAAK4D,iBACxB8M,EAAO1Q,KAAK6D,MAAMD,GAAkB8M,KACpC4C,EAAsCtT,KAAK6D,MAAMD,GAAkB0P,aAAe,GAGlFzC,EAAqB7Q,KAAKgN,UAAYhN,KAAKoP,aAC3C0B,EAAmB9Q,KAAKiN,QAAUjN,KAAKoP,aACvC6B,GAAqB,EAEhB3D,EAAO,EAAGA,EAAOtN,KAAKmP,UAAW7B,GAAQ,EAC9CoD,EAAKpD,GAAM7E,OAAS,GAGxB,IAAK,IAAI9I,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAAG,CAC7B,IAAMuR,EAAQ3P,EAAY5B,GACpBmK,EAAiBoH,EAAMvP,UACvBoI,EAAemH,EAAMpP,QACvBkI,OAAiB,EACjBC,OAAe,EAUnB,GARIiH,EAAMhH,QACNF,EAAoBF,EAAelI,UACnCqI,EAAkBF,EAAanI,YAE/BoI,EAAoB9I,KAAKyI,IAAIG,EAAe/G,cAAe+G,EAAe7G,WAAY6G,EAAe3G,WACrG8G,EAAkB/I,KAAKyI,IAAII,EAAahH,cAAegH,EAAa9G,WAAY8G,EAAa5G,UAAY,MAGzG8G,GAAmBP,GAAgBM,GAAqBJ,GAAcE,GAAkBC,GAI5F,GAAImH,EAAMhH,OACNoJ,EAAavP,KAAK,CACdmI,MAAKgF,QAEN,CACHD,GAAqB,EAErB,IAAI9G,OAAmB,EAEnBA,EADAH,EAAoBN,EACE,GAECI,EAAe9H,WAAa8H,EAAeuH,aAAe,IAAMrR,KAAKoP,aAGhG,IAAIhF,OAAiB,EAEjBA,EADAH,EAAkBL,GACGA,EAAaF,GA7ChC,KA6C0D1J,KAAKoP,cAE5CrF,EAAa/H,WAAa+H,EAAasH,aAAe,IAAMrR,KAAKoP,aAG1F,IAAIV,EAAapE,KAAKC,MAAMJ,GACxBK,EAAWF,KAAKG,KAAKL,EAlDvB,MAmDE2D,EAAc,EACdY,EAAY,EAwBhB,GAvBuB,IAAnB3O,KAAKmO,YAEDJ,EADAW,EAAamC,EACC,EAEAvG,KAAKC,OAAOJ,EAAsBuE,GAAc1O,KAAKmO,WAGnEQ,EADAnE,EAAWsG,EACC,EAEAxG,KAAKC,OAAOC,EAAWJ,GAAqBpK,KAAKmO,YAIjEO,EAAamC,EACbnC,EAAa,EAEbA,GAAcmC,EAEdrG,EAAWsG,IACXtG,EAAWsG,GAIXpC,GAFJlE,GAAYqG,GAEe,CACvB,IAAMa,EAAe,CACjBxF,MAAKgF,EACLxC,WAAUA,EACVlE,SAAQA,EACRuD,YAAWA,EACXY,UAASA,GAGTjE,EAAWgG,EAAKhC,GAAYjG,OAC5BiC,EACAA,EAAS3G,KAAK2N,KAEdhH,EAAW,IACF3G,KAAK2N,GACdhB,EAAKhC,GAAYjG,OAASiC,KAM1C,GAAIuG,EAAoB,CACpB,IAAIhD,EAAiC,GACrC,IAASX,EAAO,EAAGA,EAAOtN,KAAKmP,UAAW7B,GAAQ,EAC1CoD,EAAKpD,GAAM7E,SACXiI,EAAKpD,GAAM7E,OAAOkC,KAAK0I,EAAiBzF,2BAExCK,EAAgBA,EAAc0D,OAAOjB,EAAKpD,GAAM7E,SAGpDwF,EAAc5O,OAAS,GACvBW,KAAK4R,YAAY3D,KAK7BgF,EAAApS,UAAAgG,YAAA,WAEI,GADA7G,KAAK0B,MAAQ1B,KAAKuD,SAASvD,KAAKqE,gBAAgBzB,aAC5C5C,KAAK6E,OAAQ,CACb,IAAM+C,EAAQ5H,KAAK6H,WACnB7H,KAAK2E,eAAexC,KAAKyF,GAG7B5H,KAAKqE,gBAAgBb,sBAAsBxD,MAC3CA,KAAKqE,gBAAgBjD,aAAapB,OAGtCiT,EAAApS,UAAAgH,SAAA,WACI,IAAM0L,EAAe,IAAIrS,KAAKlB,KAAK0B,MAAMC,UAAUC,WAEnD,OADA2R,EAAaxR,SAAS,GAAI,EAAG,EAAG,GACzB/B,KAAKuG,YAAYgN,IAG5BN,EAAApS,UAAAuK,OAAA,SAAOL,EAAoBtC,GACvB,IAAIF,GAAW,EACXvI,KAAKwI,eACLD,EAAWvI,KAAKwI,aAAauC,IAGjC/K,KAAK0E,eAAevC,KAAK,CACrB4I,aAAYA,EACZtC,OAAQA,EAAOsJ,KAAI,SAAAC,GAAK,OAAAA,EAAE9F,SAC1B3D,SAAQA,KAIhB0K,EAAApS,UAAA+Q,YAAA,SAAY3D,GACRjO,KAAKkS,kBAAkBjE,GACvBoF,EAAiBrF,eAAeC,EAAejO,KAAKmP,UAAWnP,KAAKmO,YAGxE8E,EAAApS,UAAAiR,kBAAA,SAAkB7D,GACdjO,KAAKkS,kBAAkBjE,IAG3BgF,EAAApS,UAAAsR,QAAA,SAAQjH,EAAuBC,GAC3B,IAAIiH,EAAalH,EACbmH,EAAYlH,EAMhB,OALID,EAAOwD,WAAavD,EAAOuD,YAAexD,EAAOwD,aAAevD,EAAOuD,YAAcxD,EAAO6C,YAAc5C,EAAO4C,eACjHqE,EAAajH,EACbkH,EAAYnH,KAGZkH,EAAW5H,UAAY6H,EAAU3D,eAGxB0D,EAAW5H,SAAW6H,EAAU3D,YAAe,GAAK0D,EAAWzD,UAAY0D,EAAUtE,aAAe/N,KAAKmO,YAI1H8E,EAAApS,UAAAqR,kBAAA,SAAkBzJ,GAOd,IANA,IAGI+J,EAHE/I,EAAMhB,EAAOpJ,OACfiT,EAAyB,IAAInN,MAAMsE,GACnC8I,EAAY,EAIP5S,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAAG,CAC7B,IAAK6S,EAAM,EAAGA,EAAMD,EAAWC,GAAO,EAClCF,EAAYE,IAAO,EAEvB,IAAK,IAAIvD,EAAI,EAAGA,EAAItP,EAAGsP,GAAK,EACpBjP,KAAKmS,QAAQ1J,EAAO9I,GAAI8I,EAAOwG,MAC/BqD,EAAY7J,EAAOwG,GAAGX,WAAY,GAG1C,IAAKkE,EAAM,EAAGA,EAAMD,GACXD,EAAYE,GADUA,GAAO,GAMlC/J,EAAO9I,GAAG2O,SADVkE,EAAMD,EACeC,EAEAD,IAI7B,GAAiB,QAAbvS,KAAKuE,IACL,IAAS5E,EAAI,EAAGA,EAAI8J,EAAK9J,GAAK,EAC1B8I,EAAO9I,GAAG2O,SAAWiE,EAAY,EAAI9J,EAAO9I,GAAG2O,UAK3D2E,EAAApS,UAAAoL,cAAA,SAAcC,GACVlM,KAAKyE,gBAAgBtC,KAAK+J,IAG9B+G,EAAApS,UAAA6R,kBAAA,SAAkBC,GACd3S,KAAKoQ,mBAAqBuC,4CAljBO5S,SAA8B6S,EAAAA,cAG3B/T,EAAA,CAAvCsN,EAAAA,UAAU,YAAa,CAACC,QAAQ,kCACHvN,EAAA,CAA7BgU,EAAAA,YAAY,8CAEJhU,EAAA,CAARwN,EAAAA,0DACQxN,EAAA,CAARwN,EAAAA,0DACQxN,EAAA,CAARwN,EAAAA,iEACQxN,EAAA,CAARwN,EAAAA,iEACQxN,EAAA,CAARwN,EAAAA,yEACQxN,EAAA,CAARwN,EAAAA,yEAEQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,8CACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sCACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,mCACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,uCACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,4CAESxN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,gDACSzN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,+CApCQ2G,EAAgBI,EAAAxU,EAAA,CA9W5B0N,EAAAA,UAAU,CACPC,SAAU,UACVC,SAAU,ivXA0WVqG,cAAeC,EAAAA,kBAAkBC,aAlLxB,kkJAoLAC,OJ3Pb,SAAYnT,GACRA,EAAAA,EAAA,YAAA,IAAA,cACAA,EAAAA,EAAA,SAAA,IAAA,WACAA,EAAAA,EAAA,KAAA,IAAA,OAHJ,CAAYA,IAAAA,EAAI,sBAyRZ,SAAA0T,EAAoBnP,EAA4DoP,GAA5DzT,KAAAqE,gBAAAA,EAA4DrE,KAAAyT,UAAAA,EA1DvEzT,KAAAuB,YAAuB,GACvBvB,KAAA0T,aAA4B,QAC5B1T,KAAAgG,UAAmB,IACnBhG,KAAAqG,gBAAyB,MACzBrG,KAAAmT,eAAwB,gBACxBnT,KAAAuP,gBAAyB,sBACzBvP,KAAAyG,iBAA0B,YAC1BzG,KAAAqP,wBAAiC,QACjCrP,KAAA2P,iBAA0B,KAC1B3P,KAAA2T,iBAA0B,EAC1B3T,KAAAqJ,iBAA0B,EAC1BrJ,KAAA4Q,gBAAyB,EACzB5Q,KAAA4T,YAAqB,UACrB5T,KAAA6T,cAAuB,YACvB7T,KAAAsB,UAAsB,QACtBtB,KAAA6C,KAAY/C,EAAKgU,KACjB9T,KAAAkN,aAAsB,GACtBlN,KAAAsE,YAAqB,EAmBrBtE,KAAAuE,IAAa,GACbvE,KAAA6M,aAAsB,EACtB7M,KAAA+T,wBAAiC,EACjC/T,KAAA0G,iBAA0B,EAC1B1G,KAAA4G,YAAqB,EACrB5G,KAAAoG,OAAgB,GAChBpG,KAAAgN,UAAmB,EACnBhN,KAAAiN,QAAiB,GAGhBjN,KAAAgU,qBAAuB,IAAIxP,EAAAA,aAC3BxE,KAAAkC,eAAiB,IAAIsC,EAAAA,aACrBxE,KAAAyE,gBAAkB,IAAID,EAAAA,aACtBxE,KAAA0E,eAAiB,IAAIF,EAAAA,aACrBxE,KAAA8M,oBAAsB,IAAItI,EAAAA,aAC1BxE,KAAA2E,eAAiB,IAAIH,EAAAA,aAGxBxE,KAAAmO,UAAY,EACZnO,KAAAoP,aAAe,EAIlBpP,KAAKoG,OAASqN,EDjXf,IAAiBQ,EAAYC,ECubpC,OA/II3U,OAAAK,eAAI4T,EAAA3S,UAAA,cAAW,KAAf,WACI,OAAOb,KAAKiB,kBAGhB,SAAgBF,GACPA,IACDA,EAAM,IAAIG,MAGdlB,KAAKiB,aAAeF,EACpBf,KAAKqE,gBAAgBvD,eAAeC,GAAK,GACzCf,KAAKgU,qBAAqB7R,KAAKnC,KAAKiB,+CAiExCuS,EAAA3S,UAAAyE,SAAA,WAAA,IAAAC,EAAAvF,KACQA,KAAKsE,aAC8B,UAA/BtE,KAAKsE,WAAW6P,WAChBnU,KAAKsE,YAAa,EAElBtE,KAAKsE,YAAa,GAG1BtE,KAAKoP,aAAe,GAAKpP,KAAKkN,aAC9BlN,KAAKmO,UAAY,GAAKnO,KAAK6C,KACxB7C,KAAKmO,WAAanO,KAAKoP,aACtBpP,KAAKmO,UAAY,EAEjBnO,KAAKmO,UAAYnO,KAAKmO,UAAYnO,KAAKoP,aAE3CpP,KAAKgN,UAAYoH,SAASpU,KAAKgN,UAAUmH,YACzCnU,KAAKiN,QAAUmH,SAASpU,KAAKiN,QAAQkH,YACrCnU,KAAKqE,gBAAgB/C,UAAYtB,KAAKsB,UAEtCtB,KAAKqU,2CAA6CrU,KAAKqE,gBAAgB5D,gCAAgCsG,WAAU,SAAAnE,GAC7G2C,EAAKtE,aAAe2B,EACpB2C,EAAKyO,qBAAqB7R,KAAKS,OAIvC4Q,EAAA3S,UAAAwG,YAAA,WACQrH,KAAKqU,6CACLrU,KAAKqU,2CAA2C/M,cAChDtH,KAAKqU,2CAA6C,OAI1Db,EAAA3S,UAAAO,aAAA,SAAaM,GACT1B,KAAKkC,eAAeC,KAAKT,IAG7B8R,EAAA3S,UAAAoL,cAAA,SAAcC,GACVlM,KAAKyE,gBAAgBtC,KAAK+J,IAG9BsH,EAAA3S,UAAAyT,aAAA,SAAaA,GACTtU,KAAK0E,eAAevC,KAAKmS,IAG7Bd,EAAA3S,UAAA4R,YAAA,SAAYA,GACRzS,KAAK8M,oBAAoB3K,KAAKsQ,IAGlCe,EAAA3S,UAAA0T,aAAA,SAAa3M,GACT5H,KAAK2E,eAAexC,KAAKyF,IAG7B4L,EAAA3S,UAAAmD,WAAA,WACIhE,KAAKqE,gBAAgBL,cAGzBwP,EAAA3S,UAAAqG,UAAA,WACIlH,KAAKqE,gBAAgBJ,MAAM,IAG/BuP,EAAA3S,UAAAsG,UAAA,WACInH,KAAKqE,gBAAgBJ,OAAO,IAGhCuP,EAAA3S,UAAAqD,OAAA,WACIlE,KAAKqE,gBAAgBH,mDArEWnE,kCAAkByU,EAAAA,OAAMC,KAAA,CAACC,EAAAA,gBAxE7D7V,EAAA,CADCwN,EAAAA,yCAeQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,8CACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,uDACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,gDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,2CACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,oCACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,6DACQxN,EAAA,CAARwN,EAAAA,qEACQxN,EAAA,CAARwN,EAAAA,4DACQxN,EAAA,CAARwN,EAAAA,sDACQxN,EAAA,CAARwN,EAAAA,2DACQxN,EAAA,CAARwN,EAAAA,2DACQxN,EAAA,CAARwN,EAAAA,0DACQxN,EAAA,CAARwN,EAAAA,0DACQxN,EAAA,CAARwN,EAAAA,kEACQxN,EAAA,CAARwN,EAAAA,kEACQxN,EAAA,CAARwN,EAAAA,iEACQxN,EAAA,CAARwN,EAAAA,iEACQxN,EAAA,CAARwN,EAAAA,0EACQxN,EAAA,CAARwN,EAAAA,0EACQxN,EAAA,CAARwN,EAAAA,yEACQxN,EAAA,CAARwN,EAAAA,yEACQxN,EAAA,CAARwN,EAAAA,6CACQxN,EAAA,CAARwN,EAAAA,mCACQxN,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,sDACQxN,EAAA,CAARwN,EAAAA,+CACQxN,EAAA,CAARwN,EAAAA,0CACQxN,EAAA,CAARwN,EAAAA,sCACQxN,EAAA,CAARwN,EAAAA,yCACQxN,EAAA,CAARwN,EAAAA,uCACQxN,EAAA,CAARwN,EAAAA,6CAESxN,EAAA,CAATyN,EAAAA,qDACSzN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,gDACSzN,EAAA,CAATyN,EAAAA,+CACSzN,EAAA,CAATyN,EAAAA,oDACSzN,EAAA,CAATyN,EAAAA,+CAnEQkH,EAAiB3U,EAAA,CAzM7B0N,EAAAA,UAAU,CACPC,SAAU,WACVC,SAAU,osTAqMVkI,UAAW,CAAC5U,WAzCH,y5BD3PWkU,ECgXkC,EDhXtBC,ECgXsBM,EAAAA,OAAOE,EAAAA,WD/WtD,SAAU3V,EAAQC,GAAOkV,EAAUnV,EAAQC,EAAKiV,MCqS9CT,mBK7TT,SAAAoB,EAAYC,GAPF7U,KAAA8U,SAAW,IAAItQ,EAAAA,aAKjBxE,KAAA+U,kBAA2B,EAG/B/U,KAAKgV,QAAUH,EAkCvB,OA/BID,EAAA/T,UAAA0G,YAAA,SAAYC,GACR,IAAIyN,EAAezN,EAAsB,aACzC,GAAIyN,QAA8C1E,IAA9B0E,EAAavN,cAA8B1H,KAAKkV,cAAe,CAC/E,IAAMhF,EAAIlQ,KACVmQ,YAAW,WACPD,EAAGgF,cAAcC,UAAYF,EAAavN,eAC3C,KAIXkN,EAAA/T,UAAA8G,gBAAA,WACI,IAAMuN,EAAgBlV,KAAKkV,cAAgBlV,KAAKgV,QAAQjF,cAAcC,cAAc,mBAKpF,QAJ0BO,IAAtBvQ,KAAKiV,eACLC,EAAcC,UAAYnV,KAAKiV,cAG/BjV,KAAKoV,YAAcpV,KAAK+U,iBAAkB,CAC1C,IAAIM,EAAWrV,KAAK8U,SACpB9U,KAAKsV,QAAU,WACXD,EAASlT,KAAK+S,EAAcC,YAEhCnV,KAAK+U,kBAAmB,EACxBG,EAAcK,iBAAiB,SAAUvV,KAAKsV,WAItDV,EAAA/T,UAAAwG,YAAA,WACQrH,KAAK+U,kBACL/U,KAAKkV,cAAcM,oBAAoB,SAAUxV,KAAKsV,mDAhC/C1C,EAAAA,cATN/T,EAAA,CAARwN,EAAAA,4CACQxN,EAAA,CAARwN,EAAAA,yCACSxN,EAAA,CAATyN,EAAAA,yCAHQsI,EAA2B/V,EAAA,CAfvC0N,EAAAA,UAAU,CACPC,SAAU,uBACVC,SAAU,0HAWVqG,cAAeC,EAAAA,kBAAkBC,aANxB,2HAQA4B,mBCZb,SAAAa,KAA+B,OAAlBA,EAAgB5W,EAAA,CAP5B6W,EAAAA,SAAS,CACNC,aAAc,CACVvR,EAAoBsI,EAAmBuG,EAAkBO,EAAmBoB,GAEhFgB,QAAS,CAACC,EAAAA,YAAaC,EAAAA,cACvBC,QAAS,CAACvC,MAEDiC","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { Component, EventEmitter, Input, OnInit, Output, TemplateRef, Inject, LOCALE_ID } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { CalendarService } from './calendar.service';\r\n\r\nexport interface IEvent {\r\n    allDay: boolean;\r\n    endTime: Date;\r\n    startTime: Date;\r\n    title: string;\r\n}\r\n\r\nexport interface IRange {\r\n    startTime: Date;\r\n    endTime: Date;\r\n}\r\n\r\nexport interface IView {\r\n}\r\n\r\nexport interface IDayView extends IView {\r\n    allDayEvents: IDisplayAllDayEvent[];\r\n    rows: IDayViewRow[];\r\n}\r\n\r\nexport interface IDayViewRow {\r\n    events: IDisplayEvent[];\r\n    time: Date;\r\n}\r\n\r\nexport interface IMonthView extends IView {\r\n    dates: IMonthViewRow[];\r\n    dayHeaders: string[];\r\n}\r\n\r\nexport interface IMonthViewRow {\r\n    current?: boolean;\r\n    date: Date;\r\n    events: IEvent[];\r\n    hasEvent?: boolean;\r\n    label: string;\r\n    secondary: boolean;\r\n    selected?: boolean;\r\n    disabled: boolean;\r\n}\r\n\r\nexport interface IWeekView extends IView {\r\n    dates: IWeekViewDateRow[];\r\n    rows: IWeekViewRow[][];\r\n}\r\n\r\nexport interface IWeekViewDateRow {\r\n    current?: boolean;\r\n    date: Date;\r\n    events: IDisplayEvent[];\r\n    hasEvent?: boolean;\r\n    selected?: boolean;\r\n    dayHeader: string;\r\n}\r\n\r\nexport interface IWeekViewRow {\r\n    events: IDisplayEvent[];\r\n    time: Date;\r\n}\r\n\r\nexport interface IDisplayEvent {\r\n    endIndex: number;\r\n    endOffset?: number;\r\n    event: IEvent;\r\n    startIndex: number;\r\n    startOffset?: number;\r\n    overlapNumber?: number;\r\n    position?: number;\r\n}\r\n\r\nexport interface IDisplayWeekViewHeader {\r\n    viewDate: IWeekViewDateRow;\r\n}\r\n\r\nexport interface IDisplayAllDayEvent {\r\n    event: IEvent;\r\n}\r\n\r\nexport interface ICalendarComponent {\r\n    currentViewIndex: number;\r\n    direction: number;\r\n    eventSource: IEvent[];\r\n    getRange: { (date:Date): IRange; };\r\n    getViewData: { (date:Date): IView };\r\n    mode: CalendarMode;\r\n    range: IRange;\r\n    views: IView[];\r\n    onDataLoaded: { (): void };\r\n    onRangeChanged: EventEmitter<IRange>;\r\n}\r\n\r\nexport interface ITimeSelected {\r\n    events: IEvent[];\r\n    selectedTime: Date;\r\n    disabled: boolean;\r\n}\r\n\r\nexport interface IMonthViewDisplayEventTemplateContext {\r\n    view: IView;\r\n    row: number;\r\n    col: number;\r\n}\r\n\r\nexport interface IMonthViewEventDetailTemplateContext {\r\n    selectedDate: ITimeSelected;\r\n    noEventsLabel: string;\r\n}\r\n\r\nexport interface IWeekViewAllDayEventSectionTemplateContext {\r\n    day: IWeekViewDateRow,\r\n    eventTemplate: TemplateRef<IDisplayAllDayEvent>\r\n}\r\n\r\nexport interface IWeekViewNormalEventSectionTemplateContext {\r\n    tm: IWeekViewRow,\r\n    eventTemplate: TemplateRef<IDisplayEvent>\r\n}\r\n\r\nexport interface IDayViewAllDayEventSectionTemplateContext {\r\n    alldayEvents: IDisplayAllDayEvent[],\r\n    eventTemplate: TemplateRef<IDisplayAllDayEvent>\r\n}\r\n\r\nexport interface IDayViewNormalEventSectionTemplateContext {\r\n    tm: IDayViewRow,\r\n    eventTemplate: TemplateRef<IDisplayEvent>\r\n}\r\n\r\nexport interface IDateFormatter {\r\n    formatMonthViewDay?: { (date:Date): string; };\r\n    formatMonthViewDayHeader?: { (date:Date): string; };\r\n    formatMonthViewTitle?: { (date:Date): string; };\r\n    formatWeekViewDayHeader?: { (date:Date): string; };\r\n    formatWeekViewTitle?: { (date:Date): string; };\r\n    formatWeekViewHourColumn?: { (date:Date): string; };\r\n    formatDayViewTitle?: { (date:Date): string; };\r\n    formatDayViewHourColumn?: { (date:Date): string; };\r\n}\r\n\r\nexport type CalendarMode = 'day' | 'month' | 'week';\r\n\r\nexport type QueryMode = 'local' | 'remote';\r\n\r\nexport enum Step {\r\n    QuarterHour = 15,\r\n    HalfHour = 30,\r\n    Hour = 60\r\n}\r\n\r\n@Component({\r\n    selector: 'calendar',\r\n    template: `\r\n        <ng-template #monthviewDefaultDisplayEventTemplate let-view=\"view\" let-row=\"row\" let-col=\"col\">\r\n            {{view.dates[row*7+col].label}}\r\n        </ng-template>\r\n        <ng-template #monthviewDefaultEventDetailTemplate let-showEventDetail=\"showEventDetail\" let-selectedDate=\"selectedDate\" let-noEventsLabel=\"noEventsLabel\">\r\n            <ion-list class=\"event-detail-container\" has-bouncing=\"false\" *ngIf=\"showEventDetail\" overflow-scroll=\"false\">\r\n                <ion-item *ngFor=\"let event of selectedDate?.events\" (click)=\"eventSelected(event)\">\r\n                        <span *ngIf=\"!event.allDay\" class=\"monthview-eventdetail-timecolumn\">{{event.startTime|date: 'HH:mm'}}\r\n                            -\r\n                            {{event.endTime|date: 'HH:mm'}}\r\n                        </span>\r\n                    <span *ngIf=\"event.allDay\" class=\"monthview-eventdetail-timecolumn\">{{allDayLabel}}</span>\r\n                    <span class=\"event-detail\">  |  {{event.title}}</span>\r\n                </ion-item>\r\n                <ion-item *ngIf=\"selectedDate?.events.length==0\">\r\n                    <div class=\"no-events-label\">{{noEventsLabel}}</div>\r\n                </ion-item>\r\n            </ion-list>\r\n        </ng-template>\r\n        <ng-template #defaultWeekviewHeaderTemplate let-viewDate=\"viewDate\">\r\n            {{ viewDate.dayHeader }}\r\n        </ng-template>\r\n        <ng-template #defaultAllDayEventTemplate let-displayEvent=\"displayEvent\">\r\n            <div class=\"calendar-event-inner\">{{displayEvent.event.title}}</div>\r\n        </ng-template>\r\n        <ng-template #defaultNormalEventTemplate let-displayEvent=\"displayEvent\">\r\n            <div class=\"calendar-event-inner\">{{displayEvent.event.title}}</div>\r\n        </ng-template>\r\n        <ng-template #defaultWeekViewAllDayEventSectionTemplate let-day=\"day\" let-eventTemplate=\"eventTemplate\">\r\n            <div [ngClass]=\"{'calendar-event-wrap': day.events}\" *ngIf=\"day.events\"\r\n                 [ngStyle]=\"{height: 25*day.events.length+'px'}\">\r\n                <div *ngFor=\"let displayEvent of day.events\" class=\"calendar-event\" tappable\r\n                     (click)=\"eventSelected(displayEvent.event)\"\r\n                     [ngStyle]=\"{top: 25*displayEvent.position+'px', width: 100*(displayEvent.endIndex-displayEvent.startIndex)+'%', height: '25px'}\">\r\n                    <ng-template [ngTemplateOutlet]=\"eventTemplate\"\r\n                                 [ngTemplateOutletContext]=\"{displayEvent:displayEvent}\">\r\n                    </ng-template>\r\n                </div>\r\n            </div>\r\n        </ng-template>\r\n        <ng-template #defaultDayViewAllDayEventSectionTemplate let-allDayEvents=\"allDayEvents\" let-eventTemplate=\"eventTemplate\">\r\n            <div *ngFor=\"let displayEvent of allDayEvents; let eventIndex=index\"\r\n                 class=\"calendar-event\" tappable\r\n                 (click)=\"eventSelected(displayEvent.event)\"\r\n                 [ngStyle]=\"{top: 25*eventIndex+'px',width: '100%',height:'25px'}\">\r\n                <ng-template [ngTemplateOutlet]=\"eventTemplate\"\r\n                             [ngTemplateOutletContext]=\"{displayEvent:displayEvent}\">\r\n                </ng-template>\r\n            </div>\r\n        </ng-template>\r\n        <ng-template #defaultNormalEventSectionTemplate let-tm=\"tm\" let-hourParts=\"hourParts\" let-eventTemplate=\"eventTemplate\">\r\n            <div [ngClass]=\"{'calendar-event-wrap': tm.events}\" *ngIf=\"tm.events\">\r\n                <div *ngFor=\"let displayEvent of tm.events\" class=\"calendar-event\" tappable\r\n                     (click)=\"eventSelected(displayEvent.event)\"\r\n                     [ngStyle]=\"{top: (37*displayEvent.startOffset/hourParts)+'px',left: 100/displayEvent.overlapNumber*displayEvent.position+'%', width: 100/displayEvent.overlapNumber+'%', height: 37*(displayEvent.endIndex -displayEvent.startIndex - (displayEvent.endOffset + displayEvent.startOffset)/hourParts)+'px'}\">\r\n                    <ng-template [ngTemplateOutlet]=\"eventTemplate\"\r\n                                 [ngTemplateOutletContext]=\"{displayEvent:displayEvent}\">\r\n                    </ng-template>\r\n                </div>\r\n            </div>\r\n        </ng-template>\r\n        <ng-template #defaultInactiveAllDayEventSectionTemplate>\r\n        </ng-template>\r\n        <ng-template #defaultInactiveNormalEventSectionTemplate>\r\n        </ng-template>\r\n\r\n        <div [ngSwitch]=\"calendarMode\" class=\"{{calendarMode}}view-container\">\r\n            <monthview *ngSwitchCase=\"'month'\"\r\n                [formatDay]=\"formatDay\"\r\n                [formatDayHeader]=\"formatDayHeader\"\r\n                [formatMonthTitle]=\"formatMonthTitle\"\r\n                [startingDayMonth]=\"startingDayMonth\"\r\n                [showEventDetail]=\"showEventDetail\"\r\n                [noEventsLabel]=\"noEventsLabel\"\r\n                [autoSelect]=\"autoSelect\"\r\n                [eventSource]=\"eventSource\"\r\n                [markDisabled]=\"markDisabled\"\r\n                [monthviewDisplayEventTemplate]=\"monthviewDisplayEventTemplate||monthviewDefaultDisplayEventTemplate\"\r\n                [monthviewInactiveDisplayEventTemplate]=\"monthviewInactiveDisplayEventTemplate||monthviewDefaultDisplayEventTemplate\"\r\n                [monthviewEventDetailTemplate]=\"monthviewEventDetailTemplate||monthviewDefaultEventDetailTemplate\"\r\n                [locale]=\"locale\"\r\n                [dateFormatter]=\"dateFormatter\"\r\n                [dir]=\"dir\"\r\n                [lockSwipeToPrev]=\"lockSwipeToPrev\"\r\n                [lockSwipes]=\"lockSwipes\"\r\n                [sliderOptions]=\"sliderOptions\"\r\n                (onRangeChanged)=\"rangeChanged($event)\"\r\n                (onEventSelected)=\"eventSelected($event)\"\r\n                (onTimeSelected)=\"timeSelected($event)\"\r\n                (onTitleChanged)=\"titleChanged($event)\">\r\n            </monthview>\r\n            <weekview *ngSwitchCase=\"'week'\"\r\n                [formatWeekTitle]=\"formatWeekTitle\"\r\n                [formatWeekViewDayHeader]=\"formatWeekViewDayHeader\"\r\n                [formatHourColumn]=\"formatHourColumn\"\r\n                [startingDayWeek]=\"startingDayWeek\"\r\n                [allDayLabel]=\"allDayLabel\"\r\n                [hourParts]=\"hourParts\"\r\n                [autoSelect]=\"autoSelect\"\r\n                [hourSegments]=\"hourSegments\"\r\n                [eventSource]=\"eventSource\"\r\n                [markDisabled]=\"markDisabled\"\r\n                [weekviewHeaderTemplate]=\"weekviewHeaderTemplate||defaultWeekviewHeaderTemplate\"\r\n                [weekviewAllDayEventTemplate]=\"weekviewAllDayEventTemplate||defaultAllDayEventTemplate\"\r\n                [weekviewNormalEventTemplate]=\"weekviewNormalEventTemplate||defaultNormalEventTemplate\"\r\n                [weekviewAllDayEventSectionTemplate]=\"weekviewAllDayEventSectionTemplate||defaultWeekViewAllDayEventSectionTemplate\"\r\n                [weekviewNormalEventSectionTemplate]=\"weekviewNormalEventSectionTemplate||defaultNormalEventSectionTemplate\"\r\n                [weekviewInactiveAllDayEventSectionTemplate]=\"weekviewInactiveAllDayEventSectionTemplate||defaultInactiveAllDayEventSectionTemplate\"\r\n                [weekviewInactiveNormalEventSectionTemplate]=\"weekviewInactiveNormalEventSectionTemplate||defaultInactiveNormalEventSectionTemplate\"\r\n                [locale]=\"locale\"\r\n                [dateFormatter]=\"dateFormatter\"\r\n                [dir]=\"dir\"\r\n                [scrollToHour]=\"scrollToHour\"\r\n                [preserveScrollPosition]=\"preserveScrollPosition\"\r\n                [lockSwipeToPrev]=\"lockSwipeToPrev\"\r\n                [lockSwipes]=\"lockSwipes\"\r\n                [startHour]=\"startHour\"\r\n                [endHour]=\"endHour\"\r\n                [sliderOptions]=\"sliderOptions\"\r\n                (onRangeChanged)=\"rangeChanged($event)\"\r\n                (onEventSelected)=\"eventSelected($event)\"\r\n                (onDayHeaderSelected)=\"daySelected($event)\"\r\n                (onTimeSelected)=\"timeSelected($event)\"\r\n                (onTitleChanged)=\"titleChanged($event)\">\r\n            </weekview>\r\n            <dayview *ngSwitchCase=\"'day'\"\r\n                [formatDayTitle]=\"formatDayTitle\"\r\n                [formatHourColumn]=\"formatHourColumn\"\r\n                [allDayLabel]=\"allDayLabel\"\r\n                [hourParts]=\"hourParts\"\r\n                [hourSegments]=\"hourSegments\"\r\n                [eventSource]=\"eventSource\"\r\n                [markDisabled]=\"markDisabled\"\r\n                [dayviewAllDayEventTemplate]=\"dayviewAllDayEventTemplate||defaultAllDayEventTemplate\"\r\n                [dayviewNormalEventTemplate]=\"dayviewNormalEventTemplate||defaultNormalEventTemplate\"\r\n                [dayviewAllDayEventSectionTemplate]=\"dayviewAllDayEventSectionTemplate||defaultDayViewAllDayEventSectionTemplate\"\r\n                [dayviewNormalEventSectionTemplate]=\"dayviewNormalEventSectionTemplate||defaultNormalEventSectionTemplate\"\r\n                [dayviewInactiveAllDayEventSectionTemplate]=\"dayviewInactiveAllDayEventSectionTemplate||defaultInactiveAllDayEventSectionTemplate\"\r\n                [dayviewInactiveNormalEventSectionTemplate]=\"dayviewInactiveNormalEventSectionTemplate||defaultInactiveNormalEventSectionTemplate\"\r\n                [locale]=\"locale\"\r\n                [dateFormatter]=\"dateFormatter\"\r\n                [dir]=\"dir\"\r\n                [scrollToHour]=\"scrollToHour\"\r\n                [preserveScrollPosition]=\"preserveScrollPosition\"\r\n                [lockSwipeToPrev]=\"lockSwipeToPrev\"\r\n                [lockSwipes]=\"lockSwipes\"\r\n                [startHour]=\"startHour\"\r\n                [endHour]=\"endHour\"\r\n                [sliderOptions]=\"sliderOptions\"\r\n                (onRangeChanged)=\"rangeChanged($event)\"\r\n                (onEventSelected)=\"eventSelected($event)\"\r\n                (onTimeSelected)=\"timeSelected($event)\"\r\n                (onTitleChanged)=\"titleChanged($event)\">\r\n            </dayview>\r\n        </div>\r\n    `,\r\n    styles: [`\r\n        :host > div { height: 100%; }\r\n\r\n        .event-detail-container {\r\n          border-top: 2px darkgrey solid;\r\n        }\r\n\r\n        .no-events-label {\r\n          font-weight: bold;\r\n          color: darkgrey;\r\n          text-align: center;\r\n        }\r\n\r\n        .event-detail {\r\n          cursor: pointer;\r\n          white-space: nowrap;\r\n          text-overflow: ellipsis;\r\n        }\r\n\r\n        .monthview-eventdetail-timecolumn {\r\n          width: 110px;\r\n          overflow: hidden;\r\n        }\r\n\r\n        .calendar-event-inner {\r\n          overflow: hidden;\r\n          background-color: #3a87ad;\r\n          color: white;\r\n          height: 100%;\r\n          width: 100%;\r\n          padding: 2px;\r\n          line-height: 15px;\r\n          text-align: initial;\r\n        }\r\n\r\n        @media (max-width: 750px) {\r\n          .calendar-event-inner {\r\n            font-size: 12px;\r\n          }\r\n        }\r\n    `],\r\n    providers: [CalendarService]\r\n})\r\nexport class CalendarComponent implements OnInit {\r\n    @Input()\r\n    get currentDate():Date {\r\n        return this._currentDate;\r\n    }\r\n\r\n    set currentDate(val:Date) {\r\n        if (!val) {\r\n            val = new Date();\r\n        }\r\n\r\n        this._currentDate = val;\r\n        this.calendarService.setCurrentDate(val, true);\r\n        this.onCurrentDateChanged.emit(this._currentDate);\r\n    }\r\n\r\n    @Input() eventSource:IEvent[] = [];\r\n    @Input() calendarMode:CalendarMode = 'month';\r\n    @Input() formatDay:string = 'd';\r\n    @Input() formatDayHeader:string = 'EEE';\r\n    @Input() formatDayTitle:string = 'MMMM dd, yyyy';\r\n    @Input() formatWeekTitle:string = 'MMMM yyyy, \\'Week\\' w';\r\n    @Input() formatMonthTitle:string = 'MMMM yyyy';\r\n    @Input() formatWeekViewDayHeader:string = 'EEE d';\r\n    @Input() formatHourColumn:string = 'ha';\r\n    @Input() showEventDetail:boolean = true;\r\n    @Input() startingDayMonth:number = 0;\r\n    @Input() startingDayWeek:number = 0;\r\n    @Input() allDayLabel:string = 'all day';\r\n    @Input() noEventsLabel:string = 'No Events';\r\n    @Input() queryMode:QueryMode = 'local';\r\n    @Input() step:Step = Step.Hour;\r\n    @Input() timeInterval:number = 60;\r\n    @Input() autoSelect:boolean = true;\r\n    @Input() markDisabled:(date:Date) => boolean;\r\n    @Input() monthviewDisplayEventTemplate:TemplateRef<IMonthViewDisplayEventTemplateContext>;\r\n    @Input() monthviewInactiveDisplayEventTemplate:TemplateRef<IMonthViewDisplayEventTemplateContext>;\r\n    @Input() monthviewEventDetailTemplate:TemplateRef<IMonthViewEventDetailTemplateContext>;\r\n    @Input() weekviewHeaderTemplate:TemplateRef<IDisplayWeekViewHeader>;\r\n    @Input() weekviewAllDayEventTemplate:TemplateRef<IDisplayAllDayEvent>;\r\n    @Input() weekviewNormalEventTemplate:TemplateRef<IDisplayEvent>;\r\n    @Input() dayviewAllDayEventTemplate:TemplateRef<IDisplayAllDayEvent>;\r\n    @Input() dayviewNormalEventTemplate:TemplateRef<IDisplayEvent>;\r\n    @Input() weekviewAllDayEventSectionTemplate:TemplateRef<IWeekViewAllDayEventSectionTemplateContext>;\r\n    @Input() weekviewNormalEventSectionTemplate:TemplateRef<IWeekViewNormalEventSectionTemplateContext>;\r\n    @Input() dayviewAllDayEventSectionTemplate:TemplateRef<IDayViewAllDayEventSectionTemplateContext>;\r\n    @Input() dayviewNormalEventSectionTemplate:TemplateRef<IDayViewNormalEventSectionTemplateContext>;\r\n    @Input() weekviewInactiveAllDayEventSectionTemplate:TemplateRef<IWeekViewAllDayEventSectionTemplateContext>;\r\n    @Input() weekviewInactiveNormalEventSectionTemplate:TemplateRef<IWeekViewNormalEventSectionTemplateContext>;\r\n    @Input() dayviewInactiveAllDayEventSectionTemplate:TemplateRef<IDayViewAllDayEventSectionTemplateContext>;\r\n    @Input() dayviewInactiveNormalEventSectionTemplate:TemplateRef<IDayViewNormalEventSectionTemplateContext>;\r\n    @Input() dateFormatter:IDateFormatter;\r\n    @Input() dir:string = \"\";\r\n    @Input() scrollToHour:number = 0;\r\n    @Input() preserveScrollPosition:boolean = false;\r\n    @Input() lockSwipeToPrev:boolean = false;\r\n    @Input() lockSwipes:boolean = false;\r\n    @Input() locale:string = \"\";\r\n    @Input() startHour:number = 0;\r\n    @Input() endHour:number = 24;\r\n    @Input() sliderOptions:any;\r\n\r\n    @Output() onCurrentDateChanged = new EventEmitter<Date>();\r\n    @Output() onRangeChanged = new EventEmitter<IRange>();\r\n    @Output() onEventSelected = new EventEmitter<IEvent>();\r\n    @Output() onTimeSelected = new EventEmitter<ITimeSelected>();\r\n    @Output() onDayHeaderSelected = new EventEmitter<ITimeSelected>();\r\n    @Output() onTitleChanged = new EventEmitter<string>();\r\n\r\n    private _currentDate:Date;\r\n    public hourParts = 1;\r\n    public hourSegments = 1;\r\n    private currentDateChangedFromChildrenSubscription:Subscription;\r\n\r\n    constructor(private calendarService:CalendarService, @Inject(LOCALE_ID) private appLocale:string) {\r\n        this.locale = appLocale;\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (this.autoSelect) {\r\n            if (this.autoSelect.toString() === 'false') {\r\n                this.autoSelect = false;\r\n            } else {\r\n                this.autoSelect = true;\r\n            }\r\n        }\r\n        this.hourSegments = 60 / this.timeInterval;\r\n        this.hourParts = 60 / this.step;\r\n        if(this.hourParts <= this.hourSegments) {\r\n            this.hourParts = 1;\r\n        } else {\r\n            this.hourParts = this.hourParts / this.hourSegments;\r\n        }\r\n        this.startHour = parseInt(this.startHour.toString());\r\n        this.endHour = parseInt(this.endHour.toString());\r\n        this.calendarService.queryMode = this.queryMode;\r\n\r\n        this.currentDateChangedFromChildrenSubscription = this.calendarService.currentDateChangedFromChildren$.subscribe(currentDate => {\r\n            this._currentDate = currentDate;\r\n            this.onCurrentDateChanged.emit(currentDate);\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.currentDateChangedFromChildrenSubscription) {\r\n            this.currentDateChangedFromChildrenSubscription.unsubscribe();\r\n            this.currentDateChangedFromChildrenSubscription = null;\r\n        }\r\n    }\r\n\r\n    rangeChanged(range:IRange) {\r\n        this.onRangeChanged.emit(range);\r\n    }\r\n\r\n    eventSelected(event:IEvent) {\r\n        this.onEventSelected.emit(event);\r\n    }\r\n\r\n    timeSelected(timeSelected:ITimeSelected) {\r\n        this.onTimeSelected.emit(timeSelected);\r\n    }\r\n\r\n    daySelected(daySelected:ITimeSelected) {\r\n        this.onDayHeaderSelected.emit(daySelected);\r\n    }\r\n\r\n    titleChanged(title:string) {\r\n        this.onTitleChanged.emit(title);\r\n    }\r\n\r\n    loadEvents() {\r\n        this.calendarService.loadEvents();\r\n    }\r\n\r\n    slideNext() {\r\n        this.calendarService.slide(1);\r\n    }\r\n\r\n    slidePrev() {\r\n        this.calendarService.slide(-1);\r\n    }\r\n\r\n    update() {\r\n        this.calendarService.update();\r\n    }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {Observable, Subject} from 'rxjs';\r\n\r\nimport {ICalendarComponent, IView, CalendarMode, QueryMode} from './calendar';\r\n\r\n@Injectable()\r\nexport class CalendarService {\r\n    queryMode: QueryMode;\r\n    currentDateChangedFromParent$: Observable<Date>;\r\n    currentDateChangedFromChildren$: Observable<Date>;\r\n    eventSourceChanged$: Observable<void>;\r\n    slideChanged$: Observable<number>;\r\n    slideUpdated$: Observable<void>;\r\n\r\n    private _currentDate: Date;\r\n    private currentDateChangedFromParent = new Subject<Date>();\r\n    private currentDateChangedFromChildren = new Subject<Date>();\r\n    private eventSourceChanged = new Subject<void>();\r\n    private slideChanged = new Subject<number>();\r\n    private slideUpdated = new Subject<void>();\r\n\r\n    constructor() {\r\n        this.currentDateChangedFromParent$ = this.currentDateChangedFromParent.asObservable();\r\n        this.currentDateChangedFromChildren$ = this.currentDateChangedFromChildren.asObservable();\r\n        this.eventSourceChanged$ = this.eventSourceChanged.asObservable();\r\n        this.slideChanged$ = this.slideChanged.asObservable();\r\n        this.slideUpdated$ = this.slideUpdated.asObservable();\r\n    }\r\n\r\n    setCurrentDate(val: Date, fromParent: boolean = false) {\r\n        this._currentDate = new Date(val);\r\n        if (fromParent) {\r\n            this.currentDateChangedFromParent.next(val);\r\n        } else {\r\n            this.currentDateChangedFromChildren.next(val);\r\n        }\r\n    }\r\n\r\n    get currentDate(): Date {\r\n        return this._currentDate;\r\n    }\r\n\r\n    rangeChanged(component: ICalendarComponent) {\r\n        if (this.queryMode === 'local') {\r\n            if (component.eventSource && component.onDataLoaded) {\r\n                component.onDataLoaded();\r\n            }\r\n        } else if (this.queryMode === 'remote') {\r\n            let rangeStart = new Date(component.range.startTime.getTime()),\r\n                rangeEnd = new Date(component.range.endTime.getTime());\r\n\r\n            rangeStart.setHours(0);\r\n            if (rangeStart.getHours() === 23) {\r\n                rangeStart.setTime(rangeStart.getTime() + 3600000);\r\n            }\r\n\r\n            rangeEnd.setHours(0);\r\n            if (rangeEnd.getHours() === 23) {\r\n                rangeEnd.setTime(rangeEnd.getTime() + 3600000);\r\n            }\r\n            component.onRangeChanged.emit({\r\n                startTime: rangeStart,\r\n                endTime: rangeEnd\r\n            });\r\n        }\r\n    }\r\n\r\n    private getStep(mode: CalendarMode): { years: number; months: number; days: number; } {\r\n        switch (mode) {\r\n            case 'month':\r\n                return {\r\n                    years: 0,\r\n                    months: 1,\r\n                    days: 0\r\n                };\r\n            case 'week':\r\n                return {\r\n                    years: 0,\r\n                    months: 0,\r\n                    days: 7\r\n                };\r\n            case 'day':\r\n                return {\r\n                    years: 0,\r\n                    months: 0,\r\n                    days: 1\r\n                };\r\n        }\r\n    }\r\n\r\n    getAdjacentCalendarDate(mode: CalendarMode, direction: number): Date {\r\n        let calculateCalendarDate = this.currentDate;\r\n        const step = this.getStep(mode),\r\n            year = calculateCalendarDate.getFullYear() + direction * step.years,\r\n            month = calculateCalendarDate.getMonth() + direction * step.months,\r\n            date = calculateCalendarDate.getDate() + direction * step.days;\r\n\r\n        calculateCalendarDate = new Date(year, month, date, 12, 0, 0);\r\n\r\n        if (mode === 'month') {\r\n            const firstDayInNextMonth = new Date(year, month + 1, 1, 12, 0, 0);\r\n            if (firstDayInNextMonth.getTime() <= calculateCalendarDate.getTime()) {\r\n                calculateCalendarDate = new Date(firstDayInNextMonth.getTime() - 24 * 60 * 60 * 1000);\r\n            }\r\n        }\r\n        return calculateCalendarDate;\r\n    }\r\n\r\n    getAdjacentViewStartTime(component: ICalendarComponent, direction: number): Date {\r\n        let adjacentCalendarDate = this.getAdjacentCalendarDate(component.mode, direction);\r\n        return component.getRange(adjacentCalendarDate).startTime;\r\n    }\r\n\r\n    populateAdjacentViews(component: ICalendarComponent) {\r\n        let currentViewStartDate: Date,\r\n            currentViewData: IView[],\r\n            toUpdateViewIndex: number,\r\n            currentViewIndex = component.currentViewIndex;\r\n\r\n        if (component.direction === 1) {\r\n            currentViewStartDate = this.getAdjacentViewStartTime(component, 1);\r\n            toUpdateViewIndex = (currentViewIndex + 1) % 3;\r\n            component.views[toUpdateViewIndex] = component.getViewData(currentViewStartDate);\r\n        } else if (component.direction === -1) {\r\n            currentViewStartDate = this.getAdjacentViewStartTime(component, -1);\r\n            toUpdateViewIndex = (currentViewIndex + 2) % 3;\r\n            component.views[toUpdateViewIndex] = component.getViewData(currentViewStartDate);\r\n        } else {\r\n            if (!component.views) {\r\n                currentViewData = [];\r\n                currentViewStartDate = component.range.startTime;\r\n                currentViewData.push(component.getViewData(currentViewStartDate));\r\n                currentViewStartDate = this.getAdjacentViewStartTime(component, 1);\r\n                currentViewData.push(component.getViewData(currentViewStartDate));\r\n                currentViewStartDate = this.getAdjacentViewStartTime(component, -1);\r\n                currentViewData.push(component.getViewData(currentViewStartDate));\r\n                component.views = currentViewData;\r\n            } else {\r\n                currentViewStartDate = component.range.startTime;\r\n                component.views[currentViewIndex] = component.getViewData(currentViewStartDate);\r\n                currentViewStartDate = this.getAdjacentViewStartTime(component, -1);\r\n                toUpdateViewIndex = (currentViewIndex + 2) % 3;\r\n                component.views[toUpdateViewIndex] = component.getViewData(currentViewStartDate);\r\n                currentViewStartDate = this.getAdjacentViewStartTime(component, 1);\r\n                toUpdateViewIndex = (currentViewIndex + 1) % 3;\r\n                component.views[toUpdateViewIndex] = component.getViewData(currentViewStartDate);\r\n            }\r\n        }\r\n    }\r\n\r\n    loadEvents() {\r\n        this.eventSourceChanged.next();\r\n    }\r\n\r\n    slide(direction: number) {\r\n        this.slideChanged.next(direction);\r\n    }\r\n\r\n    update() {\r\n        this.slideUpdated.next();\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    OnInit,\r\n    OnChanges,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    SimpleChanges,\r\n    ViewChild,\r\n    TemplateRef,\r\n    OnDestroy,\r\n    AfterViewInit\r\n} from '@angular/core';\r\nimport {Subscription} from 'rxjs';\r\nimport {DatePipe} from '@angular/common';\r\nimport {IonSlides} from '@ionic/angular';\r\n\r\nimport {ICalendarComponent, IEvent, IMonthView, IMonthViewRow, ITimeSelected, IRange, CalendarMode, IDateFormatter} from './calendar';\r\nimport {CalendarService} from './calendar.service';\r\nimport {IMonthViewDisplayEventTemplateContext} from './calendar';\r\n\r\n@Component({\r\n    selector: 'monthview',\r\n    template: `\r\n        <div>\r\n            <ion-slides #monthSlider [options]=\"sliderOptions\" [dir]=\"dir\" (ionSlideDidChange)=\"onSlideChanged()\">\r\n                <ion-slide>\r\n                    <table *ngIf=\"0===currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr>\r\n                            <th *ngFor=\"let dayHeader of views[0].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\" tappable (click)=\"select(views[0].dates[row*7+col])\"\r\n                                [ngClass]=\"getHighlightClass(views[0].dates[row*7+col])\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[0], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    <table *ngIf=\"0!==currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr class=\"text-center\">\r\n                            <th *ngFor=\"let dayHeader of views[0].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewInactiveDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[0], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        <tr>\r\n                        </tbody>\r\n                    </table>\r\n                </ion-slide>\r\n                <ion-slide>\r\n                    <table *ngIf=\"1===currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr>\r\n                            <th *ngFor=\"let dayHeader of views[1].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\" tappable (click)=\"select(views[1].dates[row*7+col])\"\r\n                                [ngClass]=\"getHighlightClass(views[1].dates[row*7+col])\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[1], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    <table *ngIf=\"1!==currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr class=\"text-center\">\r\n                            <th *ngFor=\"let dayHeader of views[1].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewInactiveDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[1], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        <tr>\r\n                        </tbody>\r\n                    </table>\r\n                </ion-slide>\r\n                <ion-slide>\r\n                    <table *ngIf=\"2===currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr>\r\n                            <th *ngFor=\"let dayHeader of views[2].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\" tappable (click)=\"select(views[2].dates[row*7+col])\"\r\n                                [ngClass]=\"getHighlightClass(views[2].dates[row*7+col])\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[2], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    <table *ngIf=\"2!==currentViewIndex\" class=\"table table-bordered table-fixed monthview-datetable\">\r\n                        <thead>\r\n                        <tr class=\"text-center\">\r\n                            <th *ngFor=\"let dayHeader of views[2].dayHeaders\">\r\n                                <small>{{dayHeader}}</small>\r\n                            </th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr *ngFor=\"let row of [0,1,2,3,4,5]\">\r\n                            <td *ngFor=\"let col of [0,1,2,3,4,5,6]\">\r\n                                <ng-template [ngTemplateOutlet]=\"monthviewInactiveDisplayEventTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{view: views[2], row: row, col: col}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        <tr>\r\n                        </tbody>\r\n                    </table>\r\n                </ion-slide>\r\n            </ion-slides>\r\n            <ng-template [ngTemplateOutlet]=\"monthviewEventDetailTemplate\"\r\n                         [ngTemplateOutletContext]=\"{showEventDetail:showEventDetail, selectedDate: selectedDate, noEventsLabel: noEventsLabel}\">\r\n            </ng-template>\r\n        </div>\r\n    `,\r\n    styles: [`\r\n        .text-muted {\r\n            color: #999;\r\n        }\r\n\r\n        .table-fixed {\r\n            table-layout: fixed;\r\n        }\r\n\r\n        .table {\r\n            width: 100%;\r\n            max-width: 100%;\r\n            background-color: transparent;\r\n        }\r\n\r\n        .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td,\r\n        .table > tbody > tr > td, .table > tfoot > tr > td {\r\n            padding: 8px;\r\n            line-height: 20px;\r\n            vertical-align: top;\r\n        }\r\n\r\n        .table > thead > tr > th {\r\n            vertical-align: bottom;\r\n            border-bottom: 2px solid #ddd;\r\n        }\r\n\r\n        .table > thead:first-child > tr:first-child > th, .table > thead:first-child > tr:first-child > td {\r\n            border-top: 0\r\n        }\r\n\r\n        .table > tbody + tbody {\r\n            border-top: 2px solid #ddd;\r\n        }\r\n\r\n        .table-bordered {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th,\r\n        .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > thead > tr > td {\r\n            border-bottom-width: 2px;\r\n        }\r\n\r\n        .table-striped > tbody > tr:nth-child(odd) > td, .table-striped > tbody > tr:nth-child(odd) > th {\r\n            background-color: #f9f9f9\r\n        }\r\n\r\n        .monthview-primary-with-event {\r\n            background-color: #3a87ad;\r\n            color: white;\r\n        }\r\n\r\n        .monthview-current {\r\n            background-color: #f0f0f0;\r\n        }\r\n\r\n        .monthview-selected {\r\n            background-color: #009900;\r\n            color: white;\r\n        }\r\n\r\n        .monthview-datetable td.monthview-disabled {\r\n            color: lightgrey;\r\n            cursor: default;\r\n        }\r\n\r\n        .monthview-datetable th {\r\n            text-align: center;\r\n        }\r\n\r\n        .monthview-datetable td {\r\n            cursor: pointer;\r\n            text-align: center;\r\n        }\r\n\r\n        .monthview-secondary-with-event {\r\n            background-color: #d9edf7;\r\n        }\r\n\r\n        ::-webkit-scrollbar,\r\n        *::-webkit-scrollbar {\r\n            display: none;\r\n        }\r\n    `]\r\n})\r\nexport class MonthViewComponent implements ICalendarComponent, OnInit, OnDestroy, OnChanges, AfterViewInit {\r\n\r\n    constructor(private calendarService: CalendarService) {\r\n    }\r\n    ;\r\n\r\n    @ViewChild('monthSlider', {static: true}) slider: IonSlides;\r\n\r\n    @Input() monthviewDisplayEventTemplate: TemplateRef<IMonthViewDisplayEventTemplateContext>;\r\n    @Input() monthviewInactiveDisplayEventTemplate: TemplateRef<IMonthViewDisplayEventTemplateContext>;\r\n    @Input() monthviewEventDetailTemplate: TemplateRef<IMonthViewDisplayEventTemplateContext>;\r\n\r\n    @Input() formatDay: string;\r\n    @Input() formatDayHeader: string;\r\n    @Input() formatMonthTitle: string;\r\n    @Input() eventSource: IEvent[];\r\n    @Input() startingDayMonth: number;\r\n    @Input() showEventDetail: boolean;\r\n    @Input() noEventsLabel: string;\r\n    @Input() autoSelect = true;\r\n    @Input() markDisabled: (date: Date) => boolean;\r\n    @Input() locale: string;\r\n    @Input() dateFormatter: IDateFormatter;\r\n    @Input() dir = '';\r\n    @Input() lockSwipeToPrev: boolean;\r\n    @Input() lockSwipes: boolean;\r\n    @Input() sliderOptions: any;\r\n\r\n    @Output() onRangeChanged = new EventEmitter<IRange>();\r\n    @Output() onEventSelected = new EventEmitter<IEvent>();\r\n    @Output() onTimeSelected = new EventEmitter<ITimeSelected>(true);\r\n    @Output() onTitleChanged = new EventEmitter<string>(true);\r\n\r\n    public views: IMonthView[] = [];\r\n    public currentViewIndex = 0;\r\n    public selectedDate: IMonthViewRow;\r\n    public range: IRange;\r\n    public mode: CalendarMode = 'month';\r\n    public direction = 0;\r\n\r\n    private moveOnSelected = false;\r\n    private inited = false;\r\n    private callbackOnInit = true;\r\n\r\n    private currentDateChangedFromParentSubscription: Subscription;\r\n    private eventSourceChangedSubscription: Subscription;\r\n    private slideChangedSubscription: Subscription;\r\n    private slideUpdatedSubscription: Subscription;\r\n\r\n    private formatDayLabel: (date: Date) => string;\r\n    private formatDayHeaderLabel: (date: Date) => string;\r\n    private formatTitle: (date: Date) => string;\r\n\r\n    static getDates(startDate: Date, n: number): Date[] {\r\n        const dates = new Array(n),\r\n            current = new Date(startDate.getTime());\r\n        let i = 0;\r\n        while (i < n) {\r\n            dates[i++] = new Date(current.getTime());\r\n            current.setDate(current.getDate() + 1);\r\n        }\r\n        return dates;\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (!this.sliderOptions) {\r\n            this.sliderOptions = {};\r\n        }\r\n        this.sliderOptions.loop = true;\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatMonthViewDay) {\r\n            this.formatDayLabel = this.dateFormatter.formatMonthViewDay;\r\n        } else {\r\n            const dayLabelDatePipe = new DatePipe('en-US');\r\n            this.formatDayLabel = function(date: Date) {\r\n                return dayLabelDatePipe.transform(date, this.formatDay);\r\n            };\r\n        }\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatMonthViewDayHeader) {\r\n            this.formatDayHeaderLabel = this.dateFormatter.formatMonthViewDayHeader;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatDayHeaderLabel = function(date: Date) {\r\n                return datePipe.transform(date, this.formatDayHeader);\r\n            };\r\n        }\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatMonthViewTitle) {\r\n            this.formatTitle = this.dateFormatter.formatMonthViewTitle;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatTitle = function(date: Date) {\r\n                return datePipe.transform(date, this.formatMonthTitle);\r\n            };\r\n        }\r\n\r\n        if (this.lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(true);\r\n        }\r\n\r\n        if (this.lockSwipes) {\r\n            this.slider.lockSwipes(true);\r\n        }\r\n\r\n        this.refreshView();\r\n        this.inited = true;\r\n\r\n        this.currentDateChangedFromParentSubscription = this.calendarService.currentDateChangedFromParent$.subscribe(currentDate => {\r\n            this.refreshView();\r\n        });\r\n\r\n        this.eventSourceChangedSubscription = this.calendarService.eventSourceChanged$.subscribe(() => {\r\n            this.onDataLoaded();\r\n        });\r\n\r\n        this.slideChangedSubscription = this.calendarService.slideChanged$.subscribe(direction => {\r\n            if (direction === 1) {\r\n                this.slider.slideNext();\r\n            } else if (direction === -1) {\r\n                this.slider.slidePrev();\r\n            }\r\n        });\r\n\r\n        this.slideUpdatedSubscription = this.calendarService.slideUpdated$.subscribe(() => {\r\n            this.slider.update();\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.currentDateChangedFromParentSubscription) {\r\n            this.currentDateChangedFromParentSubscription.unsubscribe();\r\n            this.currentDateChangedFromParentSubscription = null;\r\n        }\r\n\r\n        if (this.eventSourceChangedSubscription) {\r\n            this.eventSourceChangedSubscription.unsubscribe();\r\n            this.eventSourceChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideChangedSubscription) {\r\n            this.slideChangedSubscription.unsubscribe();\r\n            this.slideChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideUpdatedSubscription) {\r\n            this.slideUpdatedSubscription.unsubscribe();\r\n            this.slideUpdatedSubscription = null;\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (!this.inited) {\r\n            return;\r\n        }\r\n\r\n        const eventSourceChange = changes.eventSource;\r\n        if (eventSourceChange && eventSourceChange.currentValue) {\r\n            this.onDataLoaded();\r\n        }\r\n\r\n        const lockSwipeToPrev = changes.lockSwipeToPrev;\r\n        if (lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(lockSwipeToPrev.currentValue);\r\n        }\r\n\r\n        const lockSwipes = changes.lockSwipes;\r\n        if (lockSwipes) {\r\n            this.slider.lockSwipes(lockSwipes.currentValue);\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        const title = this.getTitle();\r\n        this.onTitleChanged.emit(title);\r\n    }\r\n\r\n    onSlideChanged() {\r\n        if (this.callbackOnInit) {\r\n            this.callbackOnInit = false;\r\n            return;\r\n        }\r\n\r\n        let direction = 0;\r\n        const currentViewIndex = this.currentViewIndex;\r\n\r\n        this.slider.getActiveIndex().then((currentSlideIndex) => {\r\n            currentSlideIndex = (currentSlideIndex + 2) % 3;\r\n            if(isNaN(currentSlideIndex)) {\r\n                currentSlideIndex = currentViewIndex;\r\n            }\r\n\r\n            if (currentSlideIndex - currentViewIndex === 1) {\r\n                direction = 1;\r\n            } else if (currentSlideIndex === 0 && currentViewIndex === 2) {\r\n                direction = 1;\r\n                this.slider.slideTo(1, 0, false);\r\n            } else if (currentViewIndex - currentSlideIndex === 1) {\r\n                direction = -1;\r\n            } else if (currentSlideIndex === 2 && currentViewIndex === 0) {\r\n                direction = -1;\r\n                this.slider.slideTo(3, 0, false);\r\n            }\r\n            this.currentViewIndex = currentSlideIndex;\r\n            this.move(direction);\r\n        });\r\n    }\r\n\r\n    move(direction: number) {\r\n        if (direction === 0) {\r\n            return;\r\n        }\r\n\r\n        this.direction = direction;\r\n        if (!this.moveOnSelected) {\r\n            const adjacentDate = this.calendarService.getAdjacentCalendarDate(this.mode, direction);\r\n            this.calendarService.setCurrentDate(adjacentDate);\r\n        }\r\n        this.refreshView();\r\n        this.direction = 0;\r\n        this.moveOnSelected = false;\r\n    }\r\n\r\n    createDateObject(date: Date): IMonthViewRow {\r\n        let disabled = false;\r\n        if (this.markDisabled) {\r\n            disabled = this.markDisabled(date);\r\n        }\r\n\r\n        return {\r\n            date,\r\n            events: [],\r\n            label: this.formatDayLabel(date),\r\n            secondary: false,\r\n            disabled\r\n        };\r\n    }\r\n\r\n    getViewData(startTime: Date): IMonthView {\r\n        const startDate = startTime,\r\n            date = startDate.getDate(),\r\n            month = (startDate.getMonth() + (date !== 1 ? 1 : 0)) % 12;\r\n\r\n        const dates = MonthViewComponent.getDates(startDate, 42);\r\n        const days: IMonthViewRow[] = [];\r\n        for (let i = 0; i < 42; i++) {\r\n            const dateObject = this.createDateObject(dates[i]);\r\n            dateObject.secondary = dates[i].getMonth() !== month;\r\n            days[i] = dateObject;\r\n        }\r\n\r\n        const dayHeaders: string[] = [];\r\n        for (let i = 0; i < 7; i++) {\r\n            dayHeaders.push(this.formatDayHeaderLabel(days[i].date));\r\n        }\r\n        return {\r\n            dates: days,\r\n            dayHeaders\r\n        };\r\n    }\r\n\r\n    getHighlightClass(date: IMonthViewRow): string {\r\n        let className = '';\r\n\r\n        if (date.hasEvent) {\r\n            if (date.secondary) {\r\n                className = 'monthview-secondary-with-event';\r\n            } else {\r\n                className = 'monthview-primary-with-event';\r\n            }\r\n        }\r\n\r\n        if (date.selected) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'monthview-selected';\r\n        }\r\n\r\n        if (date.current) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'monthview-current';\r\n        }\r\n\r\n        if (date.secondary) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'text-muted';\r\n        }\r\n\r\n        if (date.disabled) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'monthview-disabled';\r\n        }\r\n        return className;\r\n    }\r\n\r\n    getRange(currentDate: Date): IRange {\r\n        const year = currentDate.getFullYear(),\r\n            month = currentDate.getMonth(),\r\n            firstDayOfMonth = new Date(year, month, 1, 12, 0, 0), // set hour to 12 to avoid DST problem\r\n\r\n            difference = this.startingDayMonth - firstDayOfMonth.getDay(),\r\n            numDisplayedFromPreviousMonth = (difference > 0) ? 7 - difference : -difference,\r\n            startDate = new Date(firstDayOfMonth.getTime());\r\n\r\n        if (numDisplayedFromPreviousMonth > 0) {\r\n            startDate.setDate(-numDisplayedFromPreviousMonth + 1);\r\n        }\r\n\r\n        const endDate = new Date(startDate.getTime());\r\n        endDate.setDate(endDate.getDate() + 42);\r\n\r\n        return {\r\n            startTime: startDate,\r\n            endTime: endDate\r\n        };\r\n    }\r\n\r\n    onDataLoaded() {\r\n        const range = this.range,\r\n            eventSource = this.eventSource,\r\n            len = eventSource ? eventSource.length : 0,\r\n            startTime = range.startTime,\r\n            endTime = range.endTime,\r\n            utcStartTime = Date.UTC(startTime.getFullYear(), startTime.getMonth(), startTime.getDate()),\r\n            utcEndTime = Date.UTC(endTime.getFullYear(), endTime.getMonth(), endTime.getDate()),\r\n            currentViewIndex = this.currentViewIndex,\r\n            dates = this.views[currentViewIndex].dates,\r\n            oneDay = 86400000,\r\n            eps = 0.0006;\r\n\r\n        for (let r = 0; r < 42; r += 1) {\r\n            if (dates[r].hasEvent) {\r\n                dates[r].hasEvent = false;\r\n                dates[r].events = [];\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < len; i += 1) {\r\n            const event = eventSource[i],\r\n                eventStartTime = event.startTime,\r\n                eventEndTime = event.endTime;\r\n\r\n            let eventUTCStartTime: number,\r\n                eventUTCEndTime: number;\r\n            if (event.allDay) {\r\n                eventUTCStartTime = eventStartTime.getTime();\r\n                eventUTCEndTime = eventEndTime.getTime();\r\n            } else {\r\n                eventUTCStartTime = Date.UTC(eventStartTime.getFullYear(), eventStartTime.getMonth(), eventStartTime.getDate());\r\n                eventUTCEndTime = Date.UTC(eventEndTime.getFullYear(), eventEndTime.getMonth(), eventEndTime.getDate() + 1);\r\n            }\r\n\r\n            if (eventUTCEndTime <= utcStartTime || eventUTCStartTime >= utcEndTime) {\r\n                continue;\r\n            }\r\n\r\n            let timeDifferenceStart: number,\r\n                timeDifferenceEnd: number;\r\n\r\n            if (eventUTCStartTime < utcStartTime) {\r\n                timeDifferenceStart = 0;\r\n            } else {\r\n                timeDifferenceStart = (eventUTCStartTime - utcStartTime) / oneDay;\r\n            }\r\n\r\n            if (eventUTCEndTime > utcEndTime) {\r\n                timeDifferenceEnd = (utcEndTime - utcStartTime) / oneDay;\r\n            } else {\r\n                timeDifferenceEnd = (eventUTCEndTime - utcStartTime) / oneDay;\r\n            }\r\n\r\n            let index = Math.floor(timeDifferenceStart);\r\n            const endIndex = Math.ceil(timeDifferenceEnd - eps);\r\n            while (index < endIndex) {\r\n                dates[index].hasEvent = true;\r\n                let eventSet = dates[index].events;\r\n                if (eventSet) {\r\n                    eventSet.push(event);\r\n                } else {\r\n                    eventSet = [];\r\n                    eventSet.push(event);\r\n                    dates[index].events = eventSet;\r\n                }\r\n                index += 1;\r\n            }\r\n        }\r\n\r\n        for (let r = 0; r < 42; r += 1) {\r\n            if (dates[r].hasEvent) {\r\n                dates[r].events.sort(this.compareEvent);\r\n            }\r\n        }\r\n\r\n        if (this.autoSelect) {\r\n            let findSelected = false;\r\n            for (let r = 0; r < 42; r += 1) {\r\n                if (dates[r].selected) {\r\n                    this.selectedDate = dates[r];\r\n                    findSelected = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (findSelected) {\r\n                this.onTimeSelected.emit({\r\n                    selectedTime: this.selectedDate.date,\r\n                    events: this.selectedDate.events,\r\n                    disabled: this.selectedDate.disabled\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    refreshView() {\r\n        this.range = this.getRange(this.calendarService.currentDate);\r\n\r\n        if (this.inited) {\r\n            const title = this.getTitle();\r\n            this.onTitleChanged.emit(title);\r\n        }\r\n        this.calendarService.populateAdjacentViews(this);\r\n        this.updateCurrentView(this.range.startTime, this.views[this.currentViewIndex]);\r\n        this.calendarService.rangeChanged(this);\r\n    }\r\n\r\n    getTitle(): string {\r\n        const currentViewStartDate = this.range.startTime,\r\n            date = currentViewStartDate.getDate(),\r\n            month = (currentViewStartDate.getMonth() + (date !== 1 ? 1 : 0)) % 12,\r\n            year = currentViewStartDate.getFullYear() + (date !== 1 && month === 0 ? 1 : 0),\r\n            headerDate = new Date(year, month, 1, 12, 0, 0, 0);\r\n        return this.formatTitle(headerDate);\r\n    }\r\n\r\n    private compareEvent(event1: IEvent, event2: IEvent): number {\r\n        if (event1.allDay) {\r\n            return 1;\r\n        } else if (event2.allDay) {\r\n            return -1;\r\n        } else {\r\n            return (event1.startTime.getTime() - event2.startTime.getTime());\r\n        }\r\n    }\r\n\r\n    select(viewDate: IMonthViewRow) {\r\n        if (!this.views) {\r\n            return;\r\n        }\r\n\r\n        const selectedDate = viewDate.date,\r\n            events = viewDate.events;\r\n\r\n        if (!viewDate.disabled) {\r\n            const dates = this.views[this.currentViewIndex].dates,\r\n                currentCalendarDate = this.calendarService.currentDate,\r\n                currentMonth = currentCalendarDate.getMonth(),\r\n                currentYear = currentCalendarDate.getFullYear(),\r\n                selectedMonth = selectedDate.getMonth(),\r\n                selectedYear = selectedDate.getFullYear();\r\n            let direction = 0;\r\n\r\n            if (currentYear === selectedYear) {\r\n                if (currentMonth !== selectedMonth) {\r\n                    direction = currentMonth < selectedMonth ? 1 : -1;\r\n                }\r\n            } else {\r\n                direction = currentYear < selectedYear ? 1 : -1;\r\n            }\r\n\r\n            this.calendarService.setCurrentDate(selectedDate);\r\n            if (direction === 0) {\r\n                const currentViewStartDate = this.range.startTime,\r\n                    oneDay = 86400000,\r\n                    selectedDayDifference = Math.round((Date.UTC(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay);\r\n\r\n                for (let r = 0; r < 42; r += 1) {\r\n                    dates[r].selected = false;\r\n                }\r\n\r\n                if (selectedDayDifference >= 0 && selectedDayDifference < 42) {\r\n                    dates[selectedDayDifference].selected = true;\r\n                    this.selectedDate = dates[selectedDayDifference];\r\n                }\r\n            } else {\r\n                this.moveOnSelected = true;\r\n                this.slideView(direction);\r\n            }\r\n        }\r\n\r\n        this.onTimeSelected.emit({selectedTime: selectedDate, events, disabled: viewDate.disabled});\r\n    }\r\n\r\n    slideView(direction: number) {\r\n        if (direction === 1) {\r\n            this.slider.slideNext();\r\n        } else if (direction === -1) {\r\n            this.slider.slidePrev();\r\n        }\r\n    }\r\n\r\n    updateCurrentView(currentViewStartDate: Date, view: IMonthView) {\r\n        const currentCalendarDate = this.calendarService.currentDate,\r\n            today = new Date(),\r\n            oneDay = 86400000,\r\n            selectedDayDifference = Math.round((Date.UTC(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), currentCalendarDate.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay),\r\n            currentDayDifference = Math.round((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay);\r\n\r\n        for (let r = 0; r < 42; r += 1) {\r\n            view.dates[r].selected = false;\r\n        }\r\n\r\n        if (selectedDayDifference >= 0 && selectedDayDifference < 42 && !view.dates[selectedDayDifference].disabled && (this.autoSelect || this.moveOnSelected)) {\r\n            view.dates[selectedDayDifference].selected = true;\r\n            this.selectedDate = view.dates[selectedDayDifference];\r\n        } else {\r\n            this.selectedDate = {\r\n                date: null,\r\n                events: [],\r\n                label: null,\r\n                secondary: null,\r\n                disabled: false\r\n            };\r\n        }\r\n\r\n        if (currentDayDifference >= 0 && currentDayDifference < 42) {\r\n            view.dates[currentDayDifference].current = true;\r\n        }\r\n    }\r\n\r\n    eventSelected(event: IEvent) {\r\n        this.onEventSelected.emit(event);\r\n    }\r\n}\r\n","import {DatePipe} from '@angular/common';\r\nimport {IonSlides} from '@ionic/angular';\r\nimport {\r\n    Component,\r\n    OnInit,\r\n    OnChanges,\r\n    HostBinding,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    SimpleChanges,\r\n    ViewChild,\r\n    ViewEncapsulation,\r\n    TemplateRef,\r\n    ElementRef,\r\n    OnDestroy, AfterViewInit\r\n} from '@angular/core';\r\nimport {Subscription} from 'rxjs';\r\n\r\nimport {\r\n    ICalendarComponent,\r\n    IDisplayEvent,\r\n    IEvent,\r\n    ITimeSelected,\r\n    IRange,\r\n    IWeekView,\r\n    IWeekViewRow,\r\n    IWeekViewDateRow,\r\n    CalendarMode,\r\n    IDateFormatter,\r\n    IDisplayWeekViewHeader\r\n} from './calendar';\r\nimport {CalendarService} from './calendar.service';\r\nimport {\r\n    IDisplayAllDayEvent,\r\n    IWeekViewAllDayEventSectionTemplateContext,\r\n    IWeekViewNormalEventSectionTemplateContext\r\n} from './calendar';\r\n\r\n@Component({\r\n    selector: 'weekview',\r\n    template: `\r\n        <ion-slides #weekSlider [options]=\"sliderOptions\" [dir]=\"dir\" (ionSlideDidChange)=\"onSlideChanged()\"\r\n                    class=\"slides-container\">\r\n            <ion-slide class=\"slide-container\">\r\n                <table class=\"table table-bordered table-fixed weekview-header\">\r\n                    <thead>\r\n                    <tr>\r\n                        <th class=\"calendar-hour-column\"></th>\r\n                        <th class=\"weekview-header text-center\" *ngFor=\"let date of views[0].dates\"\r\n                            [ngClass]=\"getHighlightClass(date)\"\r\n                            (click)=\"daySelected(date)\">\r\n                            <ng-template [ngTemplateOutlet]=\"weekviewHeaderTemplate\"\r\n                                         [ngTemplateOutletContext]=\"{viewDate:date}\">\r\n                            </ng-template>\r\n                        </th>\r\n                    </tr>\r\n                    </thead>\r\n                </table>\r\n                <div *ngIf=\"0===currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[0].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day, eventTemplate:weekviewAllDayEventTemplate}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\"\r\n                                          [emitEvent]=\"preserveScrollPosition\" (onScroll)=\"setScrollPosition($event)\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[0].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\" tappable\r\n                                    (click)=\"select(tm.time, tm.events)\">\r\n                                    <ng-template [ngTemplateOutlet]=\"weekviewNormalEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:weekviewNormalEventTemplate}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n                <div *ngIf=\"0!==currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[0].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewInactiveAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[0].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\">\r\n                                    <ng-template [ngTemplateOutlet]=\"weekviewInactiveNormalEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n            </ion-slide>\r\n            <ion-slide class=\"slide-container\">\r\n                <table class=\"table table-bordered table-fixed weekview-header\">\r\n                    <thead>\r\n                    <tr>\r\n                        <th class=\"calendar-hour-column\"></th>\r\n                        <th class=\"weekview-header text-center\" *ngFor=\"let date of views[1].dates\"\r\n                            [ngClass]=\"getHighlightClass(date)\"\r\n                            (click)=\"daySelected(date)\">\r\n                            <ng-template [ngTemplateOutlet]=\"weekviewHeaderTemplate\"\r\n                                         [ngTemplateOutletContext]=\"{viewDate:date}\">\r\n                            </ng-template>\r\n                        </th>\r\n                    </tr>\r\n                    </thead>\r\n                </table>\r\n                <div *ngIf=\"1===currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[1].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day, eventTemplate:weekviewAllDayEventTemplate}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\"\r\n                                          [emitEvent]=\"preserveScrollPosition\" (onScroll)=\"setScrollPosition($event)\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[1].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\" tappable\r\n                                    (click)=\"select(tm.time, tm.events)\">\r\n                                    <div [ngClass]=\"{'calendar-event-wrap': tm.events}\" *ngIf=\"tm.events\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewNormalEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:weekviewNormalEventTemplate}\">\r\n                                        </ng-template>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n                <div *ngIf=\"1!==currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[1].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewInactiveAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[1].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\">\r\n                                    <div [ngClass]=\"{'calendar-event-wrap': tm.events}\" *ngIf=\"tm.events\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewInactiveNormalEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                        </ng-template>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n            </ion-slide>\r\n            <ion-slide class=\"slide-container\">\r\n                <table class=\"table table-bordered table-fixed weekview-header\">\r\n                    <thead>\r\n                    <tr>\r\n                        <th class=\"calendar-hour-column\"></th>\r\n                        <th class=\"weekview-header text-center\" *ngFor=\"let date of views[2].dates\"\r\n                            [ngClass]=\"getHighlightClass(date)\"\r\n                            (click)=\"daySelected(date)\">\r\n                            <ng-template [ngTemplateOutlet]=\"weekviewHeaderTemplate\"\r\n                                         [ngTemplateOutletContext]=\"{viewDate:date}\">\r\n                            </ng-template>\r\n                        </th>\r\n                    </tr>\r\n                    </thead>\r\n                </table>\r\n                <div *ngIf=\"2===currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[2].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day, eventTemplate:weekviewAllDayEventTemplate}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\"\r\n                                          [emitEvent]=\"preserveScrollPosition\" (onScroll)=\"setScrollPosition($event)\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[2].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\" tappable\r\n                                    (click)=\"select(tm.time, tm.events)\">\r\n                                    <div [ngClass]=\"{'calendar-event-wrap': tm.events}\" *ngIf=\"tm.events\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewNormalEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:weekviewNormalEventTemplate}\">\r\n                                        </ng-template>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n                <div *ngIf=\"2!==currentViewIndex\">\r\n                    <div class=\"weekview-allday-table\">\r\n                        <div class=\"weekview-allday-label\">{{allDayLabel}}</div>\r\n                        <div class=\"weekview-allday-content-wrapper scroll-content\">\r\n                            <table class=\"table table-fixed weekview-allday-content-table\">\r\n                                <tbody>\r\n                                <tr>\r\n                                    <td *ngFor=\"let day of views[2].dates\" class=\"calendar-cell\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewInactiveAllDayEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{day:day}\">\r\n                                        </ng-template>\r\n                                    </td>\r\n                                </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <init-position-scroll class=\"weekview-normal-event-container\" [initPosition]=\"initScrollPosition\">\r\n                        <table class=\"table table-bordered table-fixed weekview-normal-event-table\">\r\n                            <tbody>\r\n                            <tr *ngFor=\"let row of views[2].rows; let i = index\">\r\n                                <td class=\"calendar-hour-column text-center\">\r\n                                    {{hourColumnLabels[i]}}\r\n                                </td>\r\n                                <td *ngFor=\"let tm of row\" class=\"calendar-cell\">\r\n                                    <div [ngClass]=\"{'calendar-event-wrap': tm.events}\" *ngIf=\"tm.events\">\r\n                                        <ng-template [ngTemplateOutlet]=\"weekviewInactiveNormalEventSectionTemplate\"\r\n                                                     [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                        </ng-template>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </init-position-scroll>\r\n                </div>\r\n            </ion-slide>\r\n        </ion-slides>\r\n    `,\r\n    styles: [`\r\n        .table-fixed {\r\n            table-layout: fixed;\r\n        }\r\n\r\n        .table {\r\n            width: 100%;\r\n            max-width: 100%;\r\n            background-color: transparent;\r\n        }\r\n\r\n        .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td,\r\n        .table > tbody > tr > td, .table > tfoot > tr > td {\r\n            padding: 8px;\r\n            line-height: 20px;\r\n            vertical-align: top;\r\n        }\r\n\r\n        .table > thead > tr > th {\r\n            vertical-align: bottom;\r\n            border-bottom: 2px solid #ddd;\r\n        }\r\n\r\n        .table > thead:first-child > tr:first-child > th, .table > thead:first-child > tr:first-child > td {\r\n            border-top: 0\r\n        }\r\n\r\n        .table > tbody + tbody {\r\n            border-top: 2px solid #ddd;\r\n        }\r\n\r\n        .table-bordered {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th,\r\n        .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > thead > tr > td {\r\n            border-bottom-width: 2px;\r\n        }\r\n\r\n        .table-striped > tbody > tr:nth-child(odd) > td, .table-striped > tbody > tr:nth-child(odd) > th {\r\n            background-color: #f9f9f9\r\n        }\r\n\r\n        .calendar-hour-column {\r\n            width: 50px;\r\n            white-space: nowrap;\r\n        }\r\n\r\n        .calendar-event-wrap {\r\n            position: relative;\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n\r\n        .calendar-event {\r\n            position: absolute;\r\n            padding: 2px;\r\n            cursor: pointer;\r\n            z-index: 10000;\r\n        }\r\n\r\n        .calendar-cell {\r\n            padding: 0 !important;\r\n            height: 37px;\r\n        }\r\n\r\n        .slides-container {\r\n            height: 100%;\r\n        }\r\n\r\n        .slide-container {\r\n            display: block;\r\n        }\r\n\r\n        .weekview-allday-label {\r\n            float: left;\r\n            height: 100%;\r\n            line-height: 50px;\r\n            text-align: center;\r\n            width: 50px;\r\n            border-left: 1px solid #ddd;\r\n        }\r\n\r\n        [dir=\"rtl\"] .weekview-allday-label {\r\n            float: right;\r\n            border-right: 1px solid #ddd;\r\n        }\r\n\r\n        .weekview-allday-content-wrapper {\r\n            margin-left: 50px;\r\n            overflow: hidden;\r\n            height: 51px;\r\n        }\r\n\r\n        [dir=\"rtl\"] .weekview-allday-content-wrapper {\r\n            margin-left: 0;\r\n            margin-right: 50px;\r\n        }\r\n\r\n        .weekview-allday-content-table {\r\n            min-height: 50px;\r\n        }\r\n\r\n        .weekview-allday-content-table td {\r\n            border-left: 1px solid #ddd;\r\n            border-right: 1px solid #ddd;\r\n        }\r\n\r\n        .weekview-header th {\r\n            overflow: hidden;\r\n            white-space: nowrap;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .weekview-allday-table {\r\n            height: 50px;\r\n            position: relative;\r\n            border-bottom: 1px solid #ddd;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .weekview-normal-event-container {\r\n            margin-top: 87px;\r\n            overflow: hidden;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0;\r\n            bottom: 0;\r\n            position: absolute;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .scroll-content {\r\n            overflow-y: auto;\r\n            overflow-x: hidden;\r\n        }\r\n\r\n        ::-webkit-scrollbar,\r\n        *::-webkit-scrollbar {\r\n            display: none;\r\n        }\r\n\r\n        .table > tbody > tr > td.calendar-hour-column {\r\n            padding-left: 0;\r\n            padding-right: 0;\r\n            vertical-align: middle;\r\n        }\r\n\r\n        @media (max-width: 750px) {\r\n            .weekview-allday-label, .calendar-hour-column {\r\n                width: 31px;\r\n                font-size: 12px;\r\n            }\r\n\r\n            .weekview-allday-label {\r\n                padding-top: 4px;\r\n            }\r\n\r\n            .table > tbody > tr > td.calendar-hour-column {\r\n                padding-left: 0;\r\n                padding-right: 0;\r\n                vertical-align: middle;\r\n                line-height: 12px;\r\n            }\r\n\r\n            .table > thead > tr > th.weekview-header {\r\n                padding-left: 0;\r\n                padding-right: 0;\r\n                font-size: 12px;\r\n            }\r\n\r\n            .weekview-allday-label {\r\n                line-height: 20px;\r\n            }\r\n\r\n            .weekview-allday-content-wrapper {\r\n                margin-left: 31px;\r\n            }\r\n\r\n            [dir=\"rtl\"] .weekview-allday-content-wrapper {\r\n                margin-left: 0;\r\n                margin-right: 31px;\r\n            }\r\n        }\r\n    `],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class WeekViewComponent implements ICalendarComponent, OnInit, OnChanges, OnDestroy, AfterViewInit {\r\n\r\n    constructor(private calendarService: CalendarService, private elm: ElementRef) {\r\n    }\r\n\r\n    @ViewChild('weekSlider', {static: true}) slider: IonSlides;\r\n    @HostBinding('class.weekview') class = true;\r\n\r\n    @Input() weekviewHeaderTemplate: TemplateRef<IDisplayWeekViewHeader>;\r\n    @Input() weekviewAllDayEventTemplate: TemplateRef<IDisplayAllDayEvent>;\r\n    @Input() weekviewNormalEventTemplate: TemplateRef<IDisplayEvent>;\r\n    @Input() weekviewAllDayEventSectionTemplate: TemplateRef<IWeekViewAllDayEventSectionTemplateContext>;\r\n    @Input() weekviewNormalEventSectionTemplate: TemplateRef<IWeekViewNormalEventSectionTemplateContext>;\r\n    @Input() weekviewInactiveAllDayEventSectionTemplate: TemplateRef<IWeekViewAllDayEventSectionTemplateContext>;\r\n    @Input() weekviewInactiveNormalEventSectionTemplate: TemplateRef<IWeekViewNormalEventSectionTemplateContext>;\r\n\r\n    @Input() formatWeekTitle: string;\r\n    @Input() formatWeekViewDayHeader: string;\r\n    @Input() formatHourColumn: string;\r\n    @Input() startingDayWeek: number;\r\n    @Input() allDayLabel: string;\r\n    @Input() hourParts: number;\r\n    @Input() eventSource: IEvent[];\r\n    @Input() autoSelect = true;\r\n    @Input() markDisabled: (date: Date) => boolean;\r\n    @Input() locale: string;\r\n    @Input() dateFormatter: IDateFormatter;\r\n    @Input() dir = '';\r\n    @Input() scrollToHour = 0;\r\n    @Input() preserveScrollPosition: boolean;\r\n    @Input() lockSwipeToPrev: boolean;\r\n    @Input() lockSwipes: boolean;\r\n    @Input() startHour: number;\r\n    @Input() endHour: number;\r\n    @Input() sliderOptions: any;\r\n    @Input() hourSegments: number;\r\n\r\n    @Output() onRangeChanged = new EventEmitter<IRange>();\r\n    @Output() onEventSelected = new EventEmitter<IEvent>();\r\n    @Output() onTimeSelected = new EventEmitter<ITimeSelected>();\r\n    @Output() onDayHeaderSelected = new EventEmitter<ITimeSelected>();\r\n    @Output() onTitleChanged = new EventEmitter<string>(true);\r\n\r\n    public views: IWeekView[] = [];\r\n    public currentViewIndex = 0;\r\n    public range: IRange;\r\n    public direction = 0;\r\n    public mode: CalendarMode = 'week';\r\n\r\n    private inited = false;\r\n    private callbackOnInit = true;\r\n    private currentDateChangedFromParentSubscription: Subscription;\r\n    private eventSourceChangedSubscription: Subscription;\r\n    private slideChangedSubscription: Subscription;\r\n    private slideUpdatedSubscription: Subscription;\r\n\r\n    public hourColumnLabels: string[];\r\n    public initScrollPosition: number;\r\n    private formatDayHeader: (date: Date) => string;\r\n    private formatTitle: (date: Date) => string;\r\n    private formatHourColumnLabel: (date: Date) => string;\r\n    private hourRange: number;\r\n\r\n    static createDateObjects(startTime: Date, startHour: number, endHour: number, timeInterval: number): IWeekViewRow[][] {\r\n        const times: IWeekViewRow[][] = [],\r\n            currentHour = 0,\r\n            currentDate = startTime.getDate();\r\n        let hourStep,\r\n            minStep;\r\n\r\n        if (timeInterval < 1) {\r\n            hourStep = Math.floor(1 / timeInterval);\r\n            minStep = 60;\r\n        } else {\r\n            hourStep = 1;\r\n            minStep = Math.floor(60 / timeInterval);\r\n        }\r\n\r\n        for (let hour = startHour; hour < endHour; hour += hourStep) {\r\n            for (let interval = 0; interval < 60; interval += minStep) {\r\n                const row: IWeekViewRow[] = [];\r\n                for (let day = 0; day < 7; day += 1) {\r\n                    const time = new Date(startTime.getTime());\r\n                    time.setHours(currentHour + hour, interval);\r\n                    time.setDate(currentDate + day);\r\n                    row.push({\r\n                        events: [],\r\n                        time\r\n                    });\r\n                }\r\n                times.push(row);\r\n            }\r\n        }\r\n        return times;\r\n    }\r\n\r\n    static getDates(startTime: Date, n: number): IWeekViewDateRow[] {\r\n        const dates = new Array(n),\r\n            current = new Date(startTime.getTime());\r\n        let i = 0;\r\n        while (i < n) {\r\n            dates[i++] = {\r\n                date: new Date(current.getTime()),\r\n                events: [],\r\n                dayHeader: ''\r\n            };\r\n            current.setDate(current.getDate() + 1);\r\n        }\r\n        return dates;\r\n    }\r\n\r\n    private static compareEventByStartOffset(eventA: IDisplayEvent, eventB: IDisplayEvent): number {\r\n        return eventA.startOffset - eventB.startOffset;\r\n    }\r\n\r\n    private static calculateWidth(orderedEvents: IDisplayEvent[], size: number, hourParts: number) {\r\n        const totalSize = size * hourParts,\r\n            cells = new Array(totalSize);\r\n\r\n        // sort by position in descending order, the right most columns should be calculated first\r\n        orderedEvents.sort((eventA, eventB) => {\r\n            return eventB.position - eventA.position;\r\n        });\r\n        for (let i = 0; i < totalSize; i += 1) {\r\n            cells[i] = {\r\n                calculated: false,\r\n                events: []\r\n            };\r\n        }\r\n        const len = orderedEvents.length;\r\n        for (let i = 0; i < len; i += 1) {\r\n            const event = orderedEvents[i];\r\n            let index = event.startIndex * hourParts + event.startOffset;\r\n            while (index < event.endIndex * hourParts - event.endOffset) {\r\n                cells[index].events.push(event);\r\n                index += 1;\r\n            }\r\n        }\r\n\r\n        let i = 0;\r\n        while (i < len) {\r\n            let event = orderedEvents[i];\r\n            if (!event.overlapNumber) {\r\n                const overlapNumber = event.position + 1;\r\n                event.overlapNumber = overlapNumber;\r\n                const eventQueue = [event];\r\n                while (event = eventQueue.shift()) {\r\n                    let index = event.startIndex * hourParts + event.startOffset;\r\n                    while (index < event.endIndex * hourParts - event.endOffset) {\r\n                        if (!cells[index].calculated) {\r\n                            cells[index].calculated = true;\r\n                            if (cells[index].events) {\r\n                                const eventCountInCell = cells[index].events.length;\r\n                                for (let j = 0; j < eventCountInCell; j += 1) {\r\n                                    const currentEventInCell = cells[index].events[j];\r\n                                    if (!currentEventInCell.overlapNumber) {\r\n                                        currentEventInCell.overlapNumber = overlapNumber;\r\n                                        eventQueue.push(currentEventInCell);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        index += 1;\r\n                    }\r\n                }\r\n            }\r\n            i += 1;\r\n        }\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (!this.sliderOptions) {\r\n            this.sliderOptions = {};\r\n        }\r\n        this.sliderOptions.loop = true;\r\n\r\n        this.hourRange = (this.endHour - this.startHour) * this.hourSegments;\r\n        if (this.dateFormatter && this.dateFormatter.formatWeekViewDayHeader) {\r\n            this.formatDayHeader = this.dateFormatter.formatWeekViewDayHeader;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatDayHeader = function (date: Date) {\r\n                return datePipe.transform(date, this.formatWeekViewDayHeader);\r\n            };\r\n        }\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatWeekViewTitle) {\r\n            this.formatTitle = this.dateFormatter.formatWeekViewTitle;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatTitle = function (date: Date) {\r\n                return datePipe.transform(date, this.formatWeekTitle);\r\n            };\r\n        }\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatWeekViewHourColumn) {\r\n            this.formatHourColumnLabel = this.dateFormatter.formatWeekViewHourColumn;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatHourColumnLabel = function (date: Date) {\r\n                return datePipe.transform(date, this.formatHourColumn);\r\n            };\r\n        }\r\n\r\n        if (this.lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(true);\r\n        }\r\n\r\n        if (this.lockSwipes) {\r\n            this.slider.lockSwipes(true);\r\n        }\r\n\r\n        this.refreshView();\r\n        this.hourColumnLabels = this.getHourColumnLabels();\r\n        this.inited = true;\r\n\r\n        this.currentDateChangedFromParentSubscription = this.calendarService.currentDateChangedFromParent$.subscribe(currentDate => {\r\n            this.refreshView();\r\n        });\r\n\r\n        this.eventSourceChangedSubscription = this.calendarService.eventSourceChanged$.subscribe(() => {\r\n            this.onDataLoaded();\r\n        });\r\n\r\n        this.slideChangedSubscription = this.calendarService.slideChanged$.subscribe(direction => {\r\n            if (direction === 1) {\r\n                this.slider.slideNext();\r\n            } else if (direction === -1) {\r\n                this.slider.slidePrev();\r\n            }\r\n        });\r\n\r\n        this.slideUpdatedSubscription = this.calendarService.slideUpdated$.subscribe(() => {\r\n            this.slider.update();\r\n        });\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        const title = this.getTitle();\r\n        this.onTitleChanged.emit(title);\r\n\r\n        if (this.scrollToHour > 0) {\r\n            const hourColumns = this.elm.nativeElement.querySelector('.weekview-normal-event-container').querySelectorAll('.calendar-hour-column');\r\n            const me = this;\r\n            setTimeout(() => {\r\n                me.initScrollPosition = hourColumns[me.scrollToHour - me.startHour].offsetTop;\r\n            }, 50);\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (!this.inited) {\r\n            return;\r\n        }\r\n\r\n        if ((changes.startHour || changes.endHour) && (!changes.startHour.isFirstChange() || !changes.endHour.isFirstChange())) {\r\n            this.views = undefined;\r\n            this.hourRange = (this.endHour - this.startHour) * this.hourSegments;\r\n            this.direction = 0;\r\n            this.refreshView();\r\n            this.hourColumnLabels = this.getHourColumnLabels();\r\n        }\r\n\r\n        const eventSourceChange = changes.eventSource;\r\n        if (eventSourceChange && eventSourceChange.currentValue) {\r\n            this.onDataLoaded();\r\n        }\r\n\r\n        const lockSwipeToPrev = changes.lockSwipeToPrev;\r\n        if (lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(lockSwipeToPrev.currentValue);\r\n        }\r\n\r\n        const lockSwipes = changes.lockSwipes;\r\n        if (lockSwipes) {\r\n            this.slider.lockSwipes(lockSwipes.currentValue);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.currentDateChangedFromParentSubscription) {\r\n            this.currentDateChangedFromParentSubscription.unsubscribe();\r\n            this.currentDateChangedFromParentSubscription = null;\r\n        }\r\n\r\n        if (this.eventSourceChangedSubscription) {\r\n            this.eventSourceChangedSubscription.unsubscribe();\r\n            this.eventSourceChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideChangedSubscription) {\r\n            this.slideChangedSubscription.unsubscribe();\r\n            this.slideChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideUpdatedSubscription) {\r\n            this.slideUpdatedSubscription.unsubscribe();\r\n            this.slideUpdatedSubscription = null;\r\n        }\r\n    }\r\n\r\n    onSlideChanged() {\r\n        if (this.callbackOnInit) {\r\n            this.callbackOnInit = false;\r\n            return;\r\n        }\r\n\r\n        const currentViewIndex = this.currentViewIndex;\r\n        let direction = 0;\r\n\r\n        this.slider.getActiveIndex().then(currentSlideIndex => {\r\n            currentSlideIndex = (currentSlideIndex + 2) % 3;\r\n            if(isNaN(currentSlideIndex)) {\r\n                currentSlideIndex = currentViewIndex;\r\n            }\r\n\r\n            if (currentSlideIndex - currentViewIndex === 1) {\r\n                direction = 1;\r\n            } else if (currentSlideIndex === 0 && currentViewIndex === 2) {\r\n                direction = 1;\r\n                this.slider.slideTo(1, 0, false);\r\n            } else if (currentViewIndex - currentSlideIndex === 1) {\r\n                direction = -1;\r\n            } else if (currentSlideIndex === 2 && currentViewIndex === 0) {\r\n                direction = -1;\r\n                this.slider.slideTo(3, 0, false);\r\n            }\r\n            this.currentViewIndex = currentSlideIndex;\r\n            this.move(direction);\r\n        });\r\n    }\r\n\r\n    move(direction: number) {\r\n        if (direction === 0) {\r\n            return;\r\n        }\r\n        this.direction = direction;\r\n        const adjacent = this.calendarService.getAdjacentCalendarDate(this.mode, direction);\r\n        this.calendarService.setCurrentDate(adjacent);\r\n        this.refreshView();\r\n        this.direction = 0;\r\n    }\r\n\r\n    private getHourColumnLabels(): string[] {\r\n        const hourColumnLabels: string[] = [];\r\n        for (let hour = 0, length = this.views[0].rows.length; hour < length; hour += 1) {\r\n            // handle edge case for DST\r\n            if (hour === 0 && this.views[0].rows[hour][0].time.getHours() !== this.startHour) {\r\n                const time = new Date(this.views[0].rows[hour][0].time);\r\n                time.setDate(time.getDate() + 1);\r\n                time.setHours(this.startHour);\r\n                hourColumnLabels.push(this.formatHourColumnLabel(time));\r\n            } else {\r\n                hourColumnLabels.push(this.formatHourColumnLabel(this.views[0].rows[hour][0].time));\r\n            }\r\n        }\r\n        return hourColumnLabels;\r\n    }\r\n\r\n    getViewData(startTime: Date): IWeekView {\r\n        const dates = WeekViewComponent.getDates(startTime, 7);\r\n        for (let i = 0; i < 7; i++) {\r\n            dates[i].dayHeader = this.formatDayHeader(dates[i].date);\r\n        }\r\n\r\n        return {\r\n            rows: WeekViewComponent.createDateObjects(startTime, this.startHour, this.endHour, this.hourSegments),\r\n            dates\r\n        };\r\n    }\r\n\r\n    getRange(currentDate: Date): IRange {\r\n        const year = currentDate.getFullYear(),\r\n            month = currentDate.getMonth(),\r\n            date = currentDate.getDate(),\r\n            day = currentDate.getDay();\r\n        let difference = day - this.startingDayWeek;\r\n\r\n        if (difference < 0) {\r\n            difference += 7;\r\n        }\r\n\r\n        // set hour to 12 to avoid DST problem\r\n        const firstDayOfWeek = new Date(year, month, date - difference, 12, 0, 0),\r\n            endTime = new Date(year, month, date - difference + 7, 12, 0, 0);\r\n\r\n        return {\r\n            startTime: firstDayOfWeek,\r\n            endTime\r\n        };\r\n    }\r\n\r\n    onDataLoaded() {\r\n        const eventSource = this.eventSource,\r\n            len = eventSource ? eventSource.length : 0,\r\n            startTime = this.range.startTime,\r\n            endTime = this.range.endTime,\r\n            utcStartTime = Date.UTC(startTime.getFullYear(), startTime.getMonth(), startTime.getDate()),\r\n            utcEndTime = Date.UTC(endTime.getFullYear(), endTime.getMonth(), endTime.getDate()),\r\n            currentViewIndex = this.currentViewIndex,\r\n            rows = this.views[currentViewIndex].rows,\r\n            dates = this.views[currentViewIndex].dates,\r\n            oneHour = 3600000,\r\n            oneDay = 86400000,\r\n            // add allday eps\r\n            eps = 0.016,\r\n            rangeStartRowIndex = this.startHour * this.hourSegments,\r\n            rangeEndRowIndex = this.endHour * this.hourSegments,\r\n            allRows = 24 * this.hourSegments;\r\n        let allDayEventInRange = false,\r\n            normalEventInRange = false;\r\n\r\n        for (let i = 0; i < 7; i += 1) {\r\n            dates[i].events = [];\r\n            dates[i].hasEvent = false;\r\n        }\r\n\r\n        for (let day = 0; day < 7; day += 1) {\r\n            for (let hour = 0; hour < this.hourRange; hour += 1) {\r\n                rows[hour][day].events = [];\r\n            }\r\n        }\r\n        for (let i = 0; i < len; i += 1) {\r\n            const event = eventSource[i];\r\n            const eventStartTime = event.startTime;\r\n            const eventEndTime = event.endTime;\r\n\r\n            let eventUTCStartTime: number,\r\n                eventUTCEndTime: number;\r\n\r\n            if (event.allDay) {\r\n                eventUTCStartTime = eventStartTime.getTime();\r\n                eventUTCEndTime = eventEndTime.getTime();\r\n            } else {\r\n                eventUTCStartTime = Date.UTC(eventStartTime.getFullYear(), eventStartTime.getMonth(), eventStartTime.getDate());\r\n                eventUTCEndTime = Date.UTC(eventEndTime.getFullYear(), eventEndTime.getMonth(), eventEndTime.getDate() + 1);\r\n            }\r\n\r\n            if (eventUTCEndTime <= utcStartTime || eventUTCStartTime >= utcEndTime || eventStartTime >= eventEndTime) {\r\n                continue;\r\n            }\r\n\r\n            if (event.allDay) {\r\n                allDayEventInRange = true;\r\n\r\n                let allDayStartIndex: number;\r\n                if (eventUTCStartTime <= utcStartTime) {\r\n                    allDayStartIndex = 0;\r\n                } else {\r\n                    allDayStartIndex = Math.round((eventUTCStartTime - utcStartTime) / oneDay);\r\n                }\r\n\r\n                let allDayEndIndex: number;\r\n                if (eventUTCEndTime >= utcEndTime) {\r\n                    allDayEndIndex = Math.round((utcEndTime - utcStartTime) / oneDay);\r\n                } else {\r\n                    allDayEndIndex = Math.round((eventUTCEndTime - utcStartTime) / oneDay);\r\n                }\r\n\r\n                const displayAllDayEvent: IDisplayEvent = {\r\n                    event,\r\n                    startIndex: allDayStartIndex,\r\n                    endIndex: allDayEndIndex\r\n                };\r\n\r\n                let eventSet = dates[allDayStartIndex].events;\r\n                if (eventSet) {\r\n                    eventSet.push(displayAllDayEvent);\r\n                } else {\r\n                    eventSet = [];\r\n                    eventSet.push(displayAllDayEvent);\r\n                    dates[allDayStartIndex].events = eventSet;\r\n                }\r\n                dates[allDayStartIndex].hasEvent = true;\r\n            } else {\r\n                normalEventInRange = true;\r\n\r\n                let timeDifferenceStart: number;\r\n                if (eventUTCStartTime < utcStartTime) {\r\n                    timeDifferenceStart = 0;\r\n                } else {\r\n                    timeDifferenceStart = (eventUTCStartTime - utcStartTime) / oneHour * this.hourSegments + (eventStartTime.getHours() + eventStartTime.getMinutes() / 60) * this.hourSegments;\r\n                }\r\n\r\n                let timeDifferenceEnd: number;\r\n                if (eventUTCEndTime > utcEndTime) {\r\n                    timeDifferenceEnd = (utcEndTime - utcStartTime) / oneHour * this.hourSegments;\r\n                } else {\r\n                    timeDifferenceEnd = (eventUTCEndTime - oneDay - utcStartTime) / oneHour * this.hourSegments + (eventEndTime.getHours() + eventEndTime.getMinutes() / 60) * this.hourSegments;\r\n                }\r\n\r\n                const startIndex = Math.floor(timeDifferenceStart),\r\n                    endIndex = Math.ceil(timeDifferenceEnd - eps);\r\n                let startRowIndex = startIndex % allRows,\r\n                    dayIndex = Math.floor(startIndex / allRows),\r\n                    endOfDay = dayIndex * allRows,\r\n                    startOffset = 0,\r\n                    endOffset = 0;\r\n\r\n                if (this.hourParts !== 1) {\r\n                    if (startRowIndex < rangeStartRowIndex) {\r\n                        startOffset = 0;\r\n                    } else {\r\n                        startOffset = Math.floor((timeDifferenceStart - startIndex) * this.hourParts);\r\n                    }\r\n                }\r\n\r\n                do {\r\n                    endOfDay += allRows;\r\n                    let endRowIndex: number;\r\n                    if (endOfDay < endIndex) {\r\n                        endRowIndex = allRows;\r\n                    } else {\r\n                        if (endOfDay === endIndex) {\r\n                            endRowIndex = allRows;\r\n                        } else {\r\n                            endRowIndex = endIndex % allRows;\r\n                        }\r\n                        if (this.hourParts !== 1) {\r\n                            if (endRowIndex > rangeEndRowIndex) {\r\n                                endOffset = 0;\r\n                            } else {\r\n                                endOffset = Math.floor((endIndex - timeDifferenceEnd) * this.hourParts);\r\n                            }\r\n                        }\r\n                    }\r\n                    if (startRowIndex < rangeStartRowIndex) {\r\n                        startRowIndex = 0;\r\n                    } else {\r\n                        startRowIndex -= rangeStartRowIndex;\r\n                    }\r\n                    if (endRowIndex > rangeEndRowIndex) {\r\n                        endRowIndex = rangeEndRowIndex;\r\n                    }\r\n                    endRowIndex -= rangeStartRowIndex;\r\n\r\n                    if (startRowIndex < endRowIndex) {\r\n                        const displayEvent = {\r\n                            event,\r\n                            startIndex: startRowIndex,\r\n                            endIndex: endRowIndex,\r\n                            startOffset,\r\n                            endOffset\r\n                        };\r\n                        let eventSet = rows[startRowIndex][dayIndex].events;\r\n                        if (eventSet) {\r\n                            eventSet.push(displayEvent);\r\n                        } else {\r\n                            eventSet = [];\r\n                            eventSet.push(displayEvent);\r\n                            rows[startRowIndex][dayIndex].events = eventSet;\r\n                        }\r\n                        dates[dayIndex].hasEvent = true;\r\n                    }\r\n                    startRowIndex = 0;\r\n                    startOffset = 0;\r\n                    dayIndex += 1;\r\n                } while (endOfDay < endIndex);\r\n            }\r\n        }\r\n\r\n        if (normalEventInRange) {\r\n            for (let day = 0; day < 7; day += 1) {\r\n                let orderedEvents: IDisplayEvent[] = [];\r\n                for (let hour = 0; hour < this.hourRange; hour += 1) {\r\n                    if (rows[hour][day].events) {\r\n                        rows[hour][day].events.sort(WeekViewComponent.compareEventByStartOffset);\r\n                        orderedEvents = orderedEvents.concat(rows[hour][day].events);\r\n                    }\r\n                }\r\n                if (orderedEvents.length > 0) {\r\n                    this.placeEvents(orderedEvents);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (allDayEventInRange) {\r\n            let orderedAllDayEvents: IDisplayEvent[] = [];\r\n            for (let day = 0; day < 7; day += 1) {\r\n                if (dates[day].events) {\r\n                    orderedAllDayEvents = orderedAllDayEvents.concat(dates[day].events);\r\n                }\r\n            }\r\n            if (orderedAllDayEvents.length > 0) {\r\n                this.placeAllDayEvents(orderedAllDayEvents);\r\n            }\r\n        }\r\n\r\n        if (this.autoSelect) {\r\n            let findSelected = false;\r\n            let selectedDate;\r\n            for (let r = 0; r < 7; r += 1) {\r\n                if (dates[r].selected) {\r\n                    selectedDate = dates[r];\r\n                    findSelected = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (findSelected) {\r\n                let disabled = false;\r\n                if (this.markDisabled) {\r\n                    disabled = this.markDisabled(selectedDate.date);\r\n                }\r\n\r\n                this.onTimeSelected.emit({\r\n                    selectedTime: selectedDate.date,\r\n                    events: selectedDate.events.map(e => e.event),\r\n                    disabled\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    refreshView() {\r\n        this.range = this.getRange(this.calendarService.currentDate);\r\n\r\n        if (this.inited) {\r\n            const title = this.getTitle();\r\n            this.onTitleChanged.emit(title);\r\n        }\r\n        this.calendarService.populateAdjacentViews(this);\r\n        this.updateCurrentView(this.range.startTime, this.views[this.currentViewIndex]);\r\n        this.calendarService.rangeChanged(this);\r\n    }\r\n\r\n    getTitle(): string {\r\n        const firstDayOfWeek = new Date(this.range.startTime.getTime());\r\n        firstDayOfWeek.setHours(12, 0, 0, 0);\r\n        return this.formatTitle(firstDayOfWeek);\r\n    }\r\n\r\n    getHighlightClass(date: IWeekViewDateRow): string {\r\n        let className = '';\r\n\r\n        if (date.hasEvent) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className = 'weekview-with-event';\r\n        }\r\n\r\n        if (date.selected) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'weekview-selected';\r\n        }\r\n\r\n        if (date.current) {\r\n            if (className) {\r\n                className += ' ';\r\n            }\r\n            className += 'weekview-current';\r\n        }\r\n\r\n        return className;\r\n    }\r\n\r\n    select(selectedTime: Date, events: IDisplayEvent[]) {\r\n        let disabled = false;\r\n        if (this.markDisabled) {\r\n            disabled = this.markDisabled(selectedTime);\r\n        }\r\n\r\n        this.onTimeSelected.emit({\r\n            selectedTime,\r\n            events: events.map(e => e.event),\r\n            disabled\r\n        });\r\n    }\r\n\r\n    placeEvents(orderedEvents: IDisplayEvent[]) {\r\n        this.calculatePosition(orderedEvents);\r\n        WeekViewComponent.calculateWidth(orderedEvents, this.hourRange, this.hourParts);\r\n    }\r\n\r\n    placeAllDayEvents(orderedEvents: IDisplayEvent[]) {\r\n        this.calculatePosition(orderedEvents);\r\n    }\r\n\r\n    overlap(event1: IDisplayEvent, event2: IDisplayEvent): boolean {\r\n        let earlyEvent = event1,\r\n            lateEvent = event2;\r\n        if (event1.startIndex > event2.startIndex || (event1.startIndex === event2.startIndex && event1.startOffset > event2.startOffset)) {\r\n            earlyEvent = event2;\r\n            lateEvent = event1;\r\n        }\r\n\r\n        if (earlyEvent.endIndex <= lateEvent.startIndex) {\r\n            return false;\r\n        } else {\r\n            return !(earlyEvent.endIndex - lateEvent.startIndex === 1 && earlyEvent.endOffset + lateEvent.startOffset >= this.hourParts);\r\n        }\r\n    }\r\n\r\n    calculatePosition(events: IDisplayEvent[]) {\r\n        const len = events.length,\r\n            isForbidden = new Array(len);\r\n        let maxColumn = 0;\r\n\r\n        for (let i = 0; i < len; i += 1) {\r\n            let col: number;\r\n            for (col = 0; col < maxColumn; col += 1) {\r\n                isForbidden[col] = false;\r\n            }\r\n            for (let j = 0; j < i; j += 1) {\r\n                if (this.overlap(events[i], events[j])) {\r\n                    isForbidden[events[j].position] = true;\r\n                }\r\n            }\r\n            for (col = 0; col < maxColumn; col += 1) {\r\n                if (!isForbidden[col]) {\r\n                    break;\r\n                }\r\n            }\r\n            if (col < maxColumn) {\r\n                events[i].position = col;\r\n            } else {\r\n                events[i].position = maxColumn++;\r\n            }\r\n        }\r\n\r\n        if (this.dir === 'rtl') {\r\n            for (let i = 0; i < len; i += 1) {\r\n                events[i].position = maxColumn - 1 - events[i].position;\r\n            }\r\n        }\r\n    }\r\n\r\n    updateCurrentView(currentViewStartDate: Date, view: IWeekView) {\r\n        const currentCalendarDate = this.calendarService.currentDate,\r\n            today = new Date(),\r\n            oneDay = 86400000,\r\n            selectedDayDifference = Math.round((Date.UTC(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), currentCalendarDate.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay),\r\n            currentDayDifference = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay);\r\n\r\n        for (let r = 0; r < 7; r += 1) {\r\n            view.dates[r].selected = false;\r\n        }\r\n\r\n        if (selectedDayDifference >= 0 && selectedDayDifference < 7 && this.autoSelect) {\r\n            view.dates[selectedDayDifference].selected = true;\r\n        }\r\n\r\n        if (currentDayDifference >= 0 && currentDayDifference < 7) {\r\n            view.dates[currentDayDifference].current = true;\r\n        }\r\n    }\r\n\r\n    daySelected(viewDate: IWeekViewDateRow) {\r\n        const selectedDate = viewDate.date,\r\n            dates = this.views[this.currentViewIndex].dates,\r\n            currentViewStartDate = this.range.startTime,\r\n            oneDay = 86400000,\r\n            selectedDayDifference = Math.round((Date.UTC(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate()) - Date.UTC(currentViewStartDate.getFullYear(), currentViewStartDate.getMonth(), currentViewStartDate.getDate())) / oneDay);\r\n\r\n        this.calendarService.setCurrentDate(selectedDate);\r\n\r\n        for (let r = 0; r < 7; r += 1) {\r\n            dates[r].selected = false;\r\n        }\r\n\r\n        if (selectedDayDifference >= 0 && selectedDayDifference < 7) {\r\n            dates[selectedDayDifference].selected = true;\r\n        }\r\n\r\n        let disabled = false;\r\n        if (this.markDisabled) {\r\n            disabled = this.markDisabled(selectedDate);\r\n        }\r\n\r\n        this.onDayHeaderSelected.emit({selectedTime: selectedDate, events: viewDate.events.map(e => e.event), disabled});\r\n    }\r\n\r\n    setScrollPosition(scrollPosition: number) {\r\n        this.initScrollPosition = scrollPosition;\r\n    }\r\n}\r\n","import {DatePipe} from '@angular/common';\r\nimport {IonSlides} from '@ionic/angular';\r\nimport {\r\n    Component,\r\n    OnInit,\r\n    OnChanges,\r\n    HostBinding,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    SimpleChanges,\r\n    ViewChild,\r\n    ViewEncapsulation,\r\n    TemplateRef,\r\n    ElementRef,\r\n    AfterViewInit, OnDestroy\r\n} from '@angular/core';\r\nimport {Subscription} from 'rxjs';\r\n\r\nimport {\r\n    ICalendarComponent,\r\n    IDayView,\r\n    IDayViewRow,\r\n    IDisplayEvent,\r\n    IEvent,\r\n    ITimeSelected,\r\n    IRange,\r\n    CalendarMode,\r\n    IDateFormatter\r\n} from './calendar';\r\nimport {CalendarService} from './calendar.service';\r\nimport {IDisplayAllDayEvent, IDayViewAllDayEventSectionTemplateContext, IDayViewNormalEventSectionTemplateContext} from './calendar';\r\n\r\n@Component({\r\n    selector: 'dayview',\r\n    template: `\r\n        <ion-slides #daySlider [options]=\"sliderOptions\" [dir]=\"dir\" (ionSlideDidChange)=\"onSlideChanged()\" class=\"slides-container\">\r\n            <ion-slide class=\"slide-container\">\r\n                <div class=\"dayview-allday-table\">\r\n                    <div class=\"dayview-allday-label\">{{allDayLabel}}</div>\r\n                    <div class=\"dayview-allday-content-wrapper scroll-content\">\r\n                        <table class=\"table table-bordered dayview-allday-content-table\">\r\n                            <tbody>\r\n                            <tr>\r\n                                <td class=\"calendar-cell\" [ngClass]=\"{'calendar-event-wrap':views[0].allDayEvents.length>0}\"\r\n                                    [ngStyle]=\"{height: 25*views[0].allDayEvents.length+'px'}\"\r\n                                    *ngIf=\"0===currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[0].allDayEvents,eventTemplate:dayviewAllDayEventTemplate}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                                <td class=\"calendar-cell\" *ngIf=\"0!==currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewInactiveAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[0].allDayEvents}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n                <init-position-scroll *ngIf=\"0===currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\" [emitEvent]=\"preserveScrollPosition\"\r\n                                      (onScroll)=\"setScrollPosition($event)\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[0].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\" tappable (click)=\"select(tm.time, tm.events)\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:dayviewNormalEventTemplate}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n                <init-position-scroll *ngIf=\"0!==currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[0].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewInactiveNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n            </ion-slide>\r\n            <ion-slide class=\"slide-container\">\r\n                <div class=\"dayview-allday-table\">\r\n                    <div class=\"dayview-allday-label\">{{allDayLabel}}</div>\r\n                    <div class=\"dayview-allday-content-wrapper scroll-content\">\r\n                        <table class=\"table table-bordered dayview-allday-content-table\">\r\n                            <tbody>\r\n                            <tr>\r\n                                <td class=\"calendar-cell\" [ngClass]=\"{'calendar-event-wrap':views[1].allDayEvents.length>0}\"\r\n                                    [ngStyle]=\"{height: 25*views[1].allDayEvents.length+'px'}\"\r\n                                    *ngIf=\"1===currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[1].allDayEvents,eventTemplate:dayviewAllDayEventTemplate}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                                <td class=\"calendar-cell\" *ngIf=\"1!==currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewInactiveAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[1].allDayEvents}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n                <init-position-scroll *ngIf=\"1===currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\" [emitEvent]=\"preserveScrollPosition\"\r\n                                      (onScroll)=\"setScrollPosition($event)\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[1].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\" tappable (click)=\"select(tm.time, tm.events)\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:dayviewNormalEventTemplate}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n                <init-position-scroll *ngIf=\"1!==currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[1].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewInactiveNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n            </ion-slide>\r\n            <ion-slide class=\"slide-container\">\r\n                <div class=\"dayview-allday-table\">\r\n                    <div class=\"dayview-allday-label\">{{allDayLabel}}</div>\r\n                    <div class=\"dayview-allday-content-wrapper scroll-content\">\r\n                        <table class=\"table table-bordered dayview-allday-content-table\">\r\n                            <tbody>\r\n                            <tr>\r\n                                <td class=\"calendar-cell\" [ngClass]=\"{'calendar-event-wrap':views[2].allDayEvents.length>0}\"\r\n                                    [ngStyle]=\"{height: 25*views[2].allDayEvents.length+'px'}\"\r\n                                    *ngIf=\"2===currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[2].allDayEvents,eventTemplate:dayviewAllDayEventTemplate}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                                <td class=\"calendar-cell\" *ngIf=\"2!==currentViewIndex\">\r\n                                    <ng-template [ngTemplateOutlet]=\"dayviewInactiveAllDayEventSectionTemplate\"\r\n                                                 [ngTemplateOutletContext]=\"{allDayEvents:views[2].allDayEvents}\">\r\n                                    </ng-template>\r\n                                </td>\r\n                            </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n                <init-position-scroll *ngIf=\"2===currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\" [emitEvent]=\"preserveScrollPosition\"\r\n                                      (onScroll)=\"setScrollPosition($event)\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[2].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\" tappable (click)=\"select(tm.time, tm.events)\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts, eventTemplate:dayviewNormalEventTemplate}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n                <init-position-scroll *ngIf=\"2!==currentViewIndex\" class=\"dayview-normal-event-container\"\r\n                                      [initPosition]=\"initScrollPosition\">\r\n                    <table class=\"table table-bordered table-fixed dayview-normal-event-table\">\r\n                        <tbody>\r\n                        <tr *ngFor=\"let tm of views[2].rows; let i = index\">\r\n                            <td class=\"calendar-hour-column text-center\">\r\n                                {{hourColumnLabels[i]}}\r\n                            </td>\r\n                            <td class=\"calendar-cell\">\r\n                                <ng-template [ngTemplateOutlet]=\"dayviewInactiveNormalEventSectionTemplate\"\r\n                                             [ngTemplateOutletContext]=\"{tm:tm, hourParts: hourParts}\">\r\n                                </ng-template>\r\n                            </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </init-position-scroll>\r\n            </ion-slide>\r\n        </ion-slides>\r\n    `,\r\n    styles: [`\r\n        .table-fixed {\r\n            table-layout: fixed;\r\n        }\r\n\r\n        .table {\r\n            width: 100%;\r\n            max-width: 100%;\r\n            background-color: transparent;\r\n        }\r\n\r\n        .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td,\r\n        .table > tbody > tr > td, .table > tfoot > tr > td {\r\n            padding: 8px;\r\n            line-height: 20px;\r\n            vertical-align: top;\r\n        }\r\n\r\n        .table > thead > tr > th {\r\n            vertical-align: bottom;\r\n            border-bottom: 2px solid #ddd;\r\n        }\r\n\r\n        .table > thead:first-child > tr:first-child > th, .table > thead:first-child > tr:first-child > td {\r\n            border-top: 0\r\n        }\r\n\r\n        .table > tbody + tbody {\r\n            border-top: 2px solid #ddd;\r\n        }\r\n\r\n        .table-bordered {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th,\r\n        .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {\r\n            border: 1px solid #ddd;\r\n        }\r\n\r\n        .table-bordered > thead > tr > th, .table-bordered > thead > tr > td {\r\n            border-bottom-width: 2px;\r\n        }\r\n\r\n        .table-striped > tbody > tr:nth-child(odd) > td, .table-striped > tbody > tr:nth-child(odd) > th {\r\n            background-color: #f9f9f9\r\n        }\r\n\r\n        .calendar-hour-column {\r\n            width: 50px;\r\n            white-space: nowrap;\r\n        }\r\n\r\n        .calendar-event-wrap {\r\n            position: relative;\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n\r\n        .calendar-event {\r\n            position: absolute;\r\n            padding: 2px;\r\n            cursor: pointer;\r\n            z-index: 10000;\r\n        }\r\n\r\n        .slides-container {\r\n            height: 100%;\r\n        }\r\n\r\n        .slide-container {\r\n            display: block;\r\n        }\r\n\r\n        .calendar-cell {\r\n            padding: 0 !important;\r\n            height: 37px;\r\n        }\r\n\r\n        .dayview-allday-label {\r\n            float: left;\r\n            height: 100%;\r\n            line-height: 50px;\r\n            text-align: center;\r\n            width: 50px;\r\n            border-left: 1px solid #ddd;\r\n        }\r\n\r\n        [dir=\"rtl\"] .dayview-allday-label {\r\n            border-right: 1px solid #ddd;\r\n            float: right;\r\n        }\r\n\r\n        .dayview-allday-content-wrapper {\r\n            margin-left: 50px;\r\n            overflow: hidden;\r\n            height: 51px;\r\n        }\r\n\r\n        [dir=\"rtl\"] .dayview-allday-content-wrapper {\r\n            margin-left: 0;\r\n            margin-right: 50px;\r\n        }\r\n\r\n        .dayview-allday-content-table {\r\n            min-height: 50px;\r\n        }\r\n\r\n        .dayview-allday-content-table td {\r\n            border-left: 1px solid #ddd;\r\n            border-right: 1px solid #ddd;\r\n        }\r\n\r\n        .dayview-allday-table {\r\n            height: 50px;\r\n            position: relative;\r\n            border-bottom: 1px solid #ddd;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .dayview-normal-event-container {\r\n            margin-top: 50px;\r\n            overflow: hidden;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0;\r\n            bottom: 0;\r\n            position: absolute;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .scroll-content {\r\n            overflow-y: auto;\r\n            overflow-x: hidden;\r\n        }\r\n\r\n        ::-webkit-scrollbar,\r\n        *::-webkit-scrollbar {\r\n            display: none;\r\n        }\r\n\r\n        .table > tbody > tr > td.calendar-hour-column {\r\n            padding-left: 0;\r\n            padding-right: 0;\r\n            vertical-align: middle;\r\n        }\r\n\r\n        @media (max-width: 750px) {\r\n            .dayview-allday-label, .calendar-hour-column {\r\n                width: 31px;\r\n                font-size: 12px;\r\n            }\r\n\r\n            .dayview-allday-label {\r\n                padding-top: 4px;\r\n            }\r\n\r\n            .table > tbody > tr > td.calendar-hour-column {\r\n                padding-left: 0;\r\n                padding-right: 0;\r\n                vertical-align: middle;\r\n                line-height: 12px;\r\n            }\r\n\r\n            .dayview-allday-label {\r\n                line-height: 20px;\r\n            }\r\n\r\n            .dayview-allday-content-wrapper {\r\n                margin-left: 31px;\r\n            }\r\n\r\n            [dir=\"rtl\"] .dayview-allday-content-wrapper {\r\n                margin-left: 0;\r\n                margin-right: 31px;\r\n            }\r\n        }\r\n    `],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class DayViewComponent implements ICalendarComponent, OnInit, OnChanges, OnDestroy, AfterViewInit {\r\n\r\n    constructor(private calendarService: CalendarService, private elm: ElementRef) {\r\n    }\r\n\r\n    @ViewChild('daySlider', {static: true}) slider: IonSlides;\r\n    @HostBinding('class.dayview') class = true;\r\n\r\n    @Input() dayviewAllDayEventTemplate: TemplateRef<IDisplayAllDayEvent>;\r\n    @Input() dayviewNormalEventTemplate: TemplateRef<IDisplayEvent>;\r\n    @Input() dayviewAllDayEventSectionTemplate: TemplateRef<IDayViewAllDayEventSectionTemplateContext>;\r\n    @Input() dayviewNormalEventSectionTemplate: TemplateRef<IDayViewNormalEventSectionTemplateContext>;\r\n    @Input() dayviewInactiveAllDayEventSectionTemplate: TemplateRef<IDayViewAllDayEventSectionTemplateContext>;\r\n    @Input() dayviewInactiveNormalEventSectionTemplate: TemplateRef<IDayViewNormalEventSectionTemplateContext>;\r\n\r\n    @Input() formatHourColumn: string;\r\n    @Input() formatDayTitle: string;\r\n    @Input() allDayLabel: string;\r\n    @Input() hourParts: number;\r\n    @Input() eventSource: IEvent[];\r\n    @Input() markDisabled: (date: Date) => boolean;\r\n    @Input() locale: string;\r\n    @Input() dateFormatter: IDateFormatter;\r\n    @Input() dir = '';\r\n    @Input() scrollToHour = 0;\r\n    @Input() preserveScrollPosition: boolean;\r\n    @Input() lockSwipeToPrev: boolean;\r\n    @Input() lockSwipes: boolean;\r\n    @Input() startHour: number;\r\n    @Input() endHour: number;\r\n    @Input() sliderOptions: any;\r\n    @Input() hourSegments: number;\r\n\r\n    @Output() onRangeChanged = new EventEmitter<IRange>();\r\n    @Output() onEventSelected = new EventEmitter<IEvent>();\r\n    @Output() onTimeSelected = new EventEmitter<ITimeSelected>();\r\n    @Output() onTitleChanged = new EventEmitter<string>(true);\r\n\r\n    public views: IDayView[] = [];\r\n    public currentViewIndex = 0;\r\n    public direction = 0;\r\n    public mode: CalendarMode = 'day';\r\n    public range: IRange;\r\n\r\n    private inited = false;\r\n    private callbackOnInit = true;\r\n    private currentDateChangedFromParentSubscription: Subscription;\r\n    private eventSourceChangedSubscription: Subscription;\r\n    private slideChangedSubscription: Subscription;\r\n    private slideUpdatedSubscription: Subscription;\r\n\r\n    public hourColumnLabels: string[];\r\n    public initScrollPosition: number;\r\n    private formatTitle: (date: Date) => string;\r\n    private formatHourColumnLabel: (date: Date) => string;\r\n    private hourRange: number;\r\n\r\n    static createDateObjects(startTime: Date, startHour: number, endHour: number, timeInterval: number): IDayViewRow[] {\r\n        const rows: IDayViewRow[] = [],\r\n            currentHour = 0,\r\n            currentDate = startTime.getDate();\r\n        let time: Date,\r\n            hourStep,\r\n            minStep;\r\n\r\n        if (timeInterval < 1) {\r\n            hourStep = Math.floor(1 / timeInterval);\r\n            minStep = 60;\r\n        } else {\r\n            hourStep = 1;\r\n            minStep = Math.floor(60 / timeInterval);\r\n        }\r\n\r\n        for (let hour = startHour; hour < endHour; hour += hourStep) {\r\n            for (let interval = 0; interval < 60; interval += minStep) {\r\n                time = new Date(startTime.getTime());\r\n                time.setHours(currentHour + hour, interval);\r\n                time.setDate(currentDate);\r\n                rows.push({\r\n                    time,\r\n                    events: []\r\n                });\r\n            }\r\n        }\r\n        return rows;\r\n    }\r\n\r\n    private static compareEventByStartOffset(eventA: IDisplayEvent, eventB: IDisplayEvent) {\r\n        return eventA.startOffset - eventB.startOffset;\r\n    }\r\n\r\n    private static calculateWidth(orderedEvents: IDisplayEvent[], size: number, hourParts: number) {\r\n        const totalSize = size * hourParts,\r\n            cells: { calculated: boolean; events: IDisplayEvent[]; }[] = new Array(totalSize);\r\n\r\n        // sort by position in descending order, the right most columns should be calculated first\r\n        orderedEvents.sort((eventA, eventB) => {\r\n            return eventB.position - eventA.position;\r\n        });\r\n        for (let i = 0; i < totalSize; i += 1) {\r\n            cells[i] = {\r\n                calculated: false,\r\n                events: []\r\n            };\r\n        }\r\n        const len = orderedEvents.length;\r\n        for (let i = 0; i < len; i += 1) {\r\n            const event = orderedEvents[i];\r\n            let index = event.startIndex * hourParts + event.startOffset;\r\n            while (index < event.endIndex * hourParts - event.endOffset) {\r\n                cells[index].events.push(event);\r\n                index += 1;\r\n            }\r\n        }\r\n\r\n        let i = 0;\r\n        while (i < len) {\r\n            let event = orderedEvents[i];\r\n            if (!event.overlapNumber) {\r\n                const overlapNumber = event.position + 1;\r\n                event.overlapNumber = overlapNumber;\r\n                const eventQueue = [event];\r\n                while (event = eventQueue.shift()) {\r\n                    let index = event.startIndex * hourParts + event.startOffset;\r\n                    while (index < event.endIndex * hourParts - event.endOffset) {\r\n                        if (!cells[index].calculated) {\r\n                            cells[index].calculated = true;\r\n                            if (cells[index].events) {\r\n                                const eventCountInCell = cells[index].events.length;\r\n                                for (let j = 0; j < eventCountInCell; j += 1) {\r\n                                    const currentEventInCell = cells[index].events[j];\r\n                                    if (!currentEventInCell.overlapNumber) {\r\n                                        currentEventInCell.overlapNumber = overlapNumber;\r\n                                        eventQueue.push(currentEventInCell);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        index += 1;\r\n                    }\r\n                }\r\n            }\r\n            i += 1;\r\n        }\r\n    }\r\n\r\n    ngOnInit() {\r\n        if (!this.sliderOptions) {\r\n            this.sliderOptions = {};\r\n        }\r\n        this.sliderOptions.loop = true;\r\n\r\n        this.hourRange = (this.endHour - this.startHour) * this.hourSegments;\r\n        if (this.dateFormatter && this.dateFormatter.formatDayViewTitle) {\r\n            this.formatTitle = this.dateFormatter.formatDayViewTitle;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatTitle = function(date: Date) {\r\n                return datePipe.transform(date, this.formatDayTitle);\r\n            };\r\n        }\r\n\r\n        if (this.dateFormatter && this.dateFormatter.formatDayViewHourColumn) {\r\n            this.formatHourColumnLabel = this.dateFormatter.formatDayViewHourColumn;\r\n        } else {\r\n            const datePipe = new DatePipe(this.locale);\r\n            this.formatHourColumnLabel = function(date: Date) {\r\n                return datePipe.transform(date, this.formatHourColumn);\r\n            };\r\n        }\r\n\r\n        if (this.lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(true);\r\n        }\r\n\r\n        if (this.lockSwipes) {\r\n            this.slider.lockSwipes(true);\r\n        }\r\n\r\n        this.refreshView();\r\n        this.hourColumnLabels = this.getHourColumnLabels();\r\n\r\n        this.inited = true;\r\n\r\n        this.currentDateChangedFromParentSubscription = this.calendarService.currentDateChangedFromParent$.subscribe(currentDate => {\r\n            this.refreshView();\r\n        });\r\n\r\n        this.eventSourceChangedSubscription = this.calendarService.eventSourceChanged$.subscribe(() => {\r\n            this.onDataLoaded();\r\n        });\r\n\r\n        this.slideChangedSubscription = this.calendarService.slideChanged$.subscribe(direction => {\r\n            if (direction === 1) {\r\n                this.slider.slideNext();\r\n            } else if (direction === -1) {\r\n                this.slider.slidePrev();\r\n            }\r\n        });\r\n\r\n        this.slideUpdatedSubscription = this.calendarService.slideUpdated$.subscribe(() => {\r\n            this.slider.update();\r\n        });\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        const title = this.getTitle();\r\n        this.onTitleChanged.emit(title);\r\n\r\n        if (this.scrollToHour > 0) {\r\n            const hourColumns = this.elm.nativeElement.querySelector('.dayview-normal-event-container').querySelectorAll('.calendar-hour-column');\r\n            const me = this;\r\n            setTimeout(() => {\r\n                me.initScrollPosition = hourColumns[me.scrollToHour - me.startHour].offsetTop;\r\n            }, 50);\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (!this.inited) {\r\n            return;\r\n        }\r\n        if ((changes.startHour || changes.endHour) && (!changes.startHour.isFirstChange() || !changes.endHour.isFirstChange())) {\r\n            this.views = undefined;\r\n            this.hourRange = (this.endHour - this.startHour) * this.hourSegments;\r\n            this.direction = 0;\r\n            this.refreshView();\r\n            this.hourColumnLabels = this.getHourColumnLabels();\r\n        }\r\n\r\n        const eventSourceChange = changes.eventSource;\r\n        if (eventSourceChange && eventSourceChange.currentValue) {\r\n            this.onDataLoaded();\r\n        }\r\n\r\n        const lockSwipeToPrev = changes.lockSwipeToPrev;\r\n        if (lockSwipeToPrev) {\r\n            this.slider.lockSwipeToPrev(lockSwipeToPrev.currentValue);\r\n        }\r\n\r\n        const lockSwipes = changes.lockSwipes;\r\n        if (lockSwipes) {\r\n            this.slider.lockSwipes(lockSwipes.currentValue);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.currentDateChangedFromParentSubscription) {\r\n            this.currentDateChangedFromParentSubscription.unsubscribe();\r\n            this.currentDateChangedFromParentSubscription = null;\r\n        }\r\n\r\n        if (this.eventSourceChangedSubscription) {\r\n            this.eventSourceChangedSubscription.unsubscribe();\r\n            this.eventSourceChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideChangedSubscription) {\r\n            this.slideChangedSubscription.unsubscribe();\r\n            this.slideChangedSubscription = null;\r\n        }\r\n\r\n        if (this.slideUpdatedSubscription) {\r\n            this.slideUpdatedSubscription.unsubscribe();\r\n            this.slideUpdatedSubscription = null;\r\n        }\r\n    }\r\n\r\n    onSlideChanged() {\r\n        if (this.callbackOnInit) {\r\n            this.callbackOnInit = false;\r\n            return;\r\n        }\r\n\r\n        let direction = 0;\r\n        const currentViewIndex = this.currentViewIndex;\r\n\r\n        this.slider.getActiveIndex().then((currentSlideIndex) => {\r\n            currentSlideIndex = (currentSlideIndex + 2) % 3;\r\n            if(isNaN(currentSlideIndex)) {\r\n                currentSlideIndex = currentViewIndex;\r\n            }\r\n\r\n            if (currentSlideIndex - currentViewIndex === 1) {\r\n                direction = 1;\r\n            } else if (currentSlideIndex === 0 && currentViewIndex === 2) {\r\n                direction = 1;\r\n                this.slider.slideTo(1, 0, false);\r\n            } else if (currentViewIndex - currentSlideIndex === 1) {\r\n                direction = -1;\r\n            } else if (currentSlideIndex === 2 && currentViewIndex === 0) {\r\n                direction = -1;\r\n                this.slider.slideTo(3, 0, false);\r\n            }\r\n            this.currentViewIndex = currentSlideIndex;\r\n            this.move(direction);\r\n        });\r\n    }\r\n\r\n    move(direction: number) {\r\n        if (direction === 0) {\r\n            return;\r\n        }\r\n\r\n        this.direction = direction;\r\n        const adjacentDate = this.calendarService.getAdjacentCalendarDate(this.mode, direction);\r\n        this.calendarService.setCurrentDate(adjacentDate);\r\n        this.refreshView();\r\n        this.direction = 0;\r\n    }\r\n\r\n    private getHourColumnLabels(): string[] {\r\n        const hourColumnLabels: string[] = [];\r\n        for (let hour = 0, length = this.views[0].rows.length; hour < length; hour += 1) {\r\n            // handle edge case for DST\r\n            if (hour === 0 && this.views[0].rows[hour].time.getHours() !== this.startHour) {\r\n                const time = new Date(this.views[0].rows[hour].time);\r\n                time.setDate(time.getDate() + 1);\r\n                time.setHours(this.startHour);\r\n                hourColumnLabels.push(this.formatHourColumnLabel(time));\r\n            } else {\r\n                hourColumnLabels.push(this.formatHourColumnLabel(this.views[0].rows[hour].time));\r\n            }\r\n        }\r\n        return hourColumnLabels;\r\n    }\r\n\r\n    getViewData(startTime: Date): IDayView {\r\n        return {\r\n            rows: DayViewComponent.createDateObjects(startTime, this.startHour, this.endHour, this.hourSegments),\r\n            allDayEvents: []\r\n        };\r\n    }\r\n\r\n    getRange(currentDate: Date): IRange {\r\n        const year = currentDate.getFullYear(),\r\n            month = currentDate.getMonth(),\r\n            date = currentDate.getDate(),\r\n            startTime = new Date(year, month, date, 12, 0, 0),\r\n            endTime = new Date(year, month, date + 1, 12, 0, 0);\r\n\r\n        return {\r\n            startTime,\r\n            endTime\r\n        };\r\n    }\r\n\r\n    onDataLoaded() {\r\n        const eventSource = this.eventSource,\r\n            len = eventSource ? eventSource.length : 0,\r\n            startTime = this.range.startTime,\r\n            endTime = this.range.endTime,\r\n            utcStartTime = Date.UTC(startTime.getFullYear(), startTime.getMonth(), startTime.getDate()),\r\n            utcEndTime = Date.UTC(endTime.getFullYear(), endTime.getMonth(), endTime.getDate()),\r\n            currentViewIndex = this.currentViewIndex,\r\n            rows = this.views[currentViewIndex].rows,\r\n            allDayEvents: IDisplayAllDayEvent[] = this.views[currentViewIndex].allDayEvents = [],\r\n            oneHour = 3600000,\r\n            eps = 0.016,\r\n            rangeStartRowIndex = this.startHour * this.hourSegments,\r\n            rangeEndRowIndex = this.endHour * this.hourSegments;\r\n        let normalEventInRange = false;\r\n\r\n        for (let hour = 0; hour < this.hourRange; hour += 1) {\r\n            rows[hour].events = [];\r\n        }\r\n\r\n        for (let i = 0; i < len; i += 1) {\r\n            const event = eventSource[i];\r\n            const eventStartTime = event.startTime;\r\n            const eventEndTime = event.endTime;\r\n            let eventUTCStartTime: number,\r\n                eventUTCEndTime: number;\r\n\r\n            if (event.allDay) {\r\n                eventUTCStartTime = eventStartTime.getTime();\r\n                eventUTCEndTime = eventEndTime.getTime();\r\n            } else {\r\n                eventUTCStartTime = Date.UTC(eventStartTime.getFullYear(), eventStartTime.getMonth(), eventStartTime.getDate());\r\n                eventUTCEndTime = Date.UTC(eventEndTime.getFullYear(), eventEndTime.getMonth(), eventEndTime.getDate() + 1);\r\n            }\r\n\r\n            if (eventUTCEndTime <= utcStartTime || eventUTCStartTime >= utcEndTime || eventStartTime >= eventEndTime) {\r\n                continue;\r\n            }\r\n\r\n            if (event.allDay) {\r\n                allDayEvents.push({\r\n                    event\r\n                });\r\n            } else {\r\n                normalEventInRange = true;\r\n\r\n                let timeDifferenceStart: number;\r\n                if (eventUTCStartTime < utcStartTime) {\r\n                    timeDifferenceStart = 0;\r\n                } else {\r\n                    timeDifferenceStart = (eventStartTime.getHours() + eventStartTime.getMinutes() / 60) * this.hourSegments;\r\n                }\r\n\r\n                let timeDifferenceEnd: number;\r\n                if (eventUTCEndTime > utcEndTime) {\r\n                    timeDifferenceEnd = (utcEndTime - utcStartTime) / oneHour * this.hourSegments;\r\n                } else {\r\n                    timeDifferenceEnd = (eventEndTime.getHours() + eventEndTime.getMinutes() / 60) * this.hourSegments;\r\n                }\r\n\r\n                let startIndex = Math.floor(timeDifferenceStart);\r\n                let endIndex = Math.ceil(timeDifferenceEnd - eps);\r\n                let startOffset = 0;\r\n                let endOffset = 0;\r\n                if (this.hourParts !== 1) {\r\n                    if (startIndex < rangeStartRowIndex) {\r\n                        startOffset = 0;\r\n                    } else {\r\n                        startOffset = Math.floor((timeDifferenceStart - startIndex) * this.hourParts);\r\n                    }\r\n                    if (endIndex > rangeEndRowIndex) {\r\n                        endOffset = 0;\r\n                    } else {\r\n                        endOffset = Math.floor((endIndex - timeDifferenceEnd) * this.hourParts);\r\n                    }\r\n                }\r\n\r\n                if (startIndex < rangeStartRowIndex) {\r\n                    startIndex = 0;\r\n                } else {\r\n                    startIndex -= rangeStartRowIndex;\r\n                }\r\n                if (endIndex > rangeEndRowIndex) {\r\n                    endIndex = rangeEndRowIndex;\r\n                }\r\n                endIndex -= rangeStartRowIndex;\r\n\r\n                if (startIndex < endIndex) {\r\n                    const displayEvent = {\r\n                        event,\r\n                        startIndex,\r\n                        endIndex,\r\n                        startOffset,\r\n                        endOffset\r\n                    };\r\n\r\n                    let eventSet = rows[startIndex].events;\r\n                    if (eventSet) {\r\n                        eventSet.push(displayEvent);\r\n                    } else {\r\n                        eventSet = [];\r\n                        eventSet.push(displayEvent);\r\n                        rows[startIndex].events = eventSet;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (normalEventInRange) {\r\n            let orderedEvents: IDisplayEvent[] = [];\r\n            for (let hour = 0; hour < this.hourRange; hour += 1) {\r\n                if (rows[hour].events) {\r\n                    rows[hour].events.sort(DayViewComponent.compareEventByStartOffset);\r\n\r\n                    orderedEvents = orderedEvents.concat(rows[hour].events);\r\n                }\r\n            }\r\n            if (orderedEvents.length > 0) {\r\n                this.placeEvents(orderedEvents);\r\n            }\r\n        }\r\n    }\r\n\r\n    refreshView() {\r\n        this.range = this.getRange(this.calendarService.currentDate);\r\n        if (this.inited) {\r\n            const title = this.getTitle();\r\n            this.onTitleChanged.emit(title);\r\n        }\r\n\r\n        this.calendarService.populateAdjacentViews(this);\r\n        this.calendarService.rangeChanged(this);\r\n    }\r\n\r\n    getTitle(): string {\r\n        const startingDate = new Date(this.range.startTime.getTime());\r\n        startingDate.setHours(12, 0, 0, 0);\r\n        return this.formatTitle(startingDate);\r\n    }\r\n\r\n    select(selectedTime: Date, events: IDisplayEvent[]) {\r\n        let disabled = false;\r\n        if (this.markDisabled) {\r\n            disabled = this.markDisabled(selectedTime);\r\n        }\r\n\r\n        this.onTimeSelected.emit({\r\n            selectedTime,\r\n            events: events.map(e => e.event),\r\n            disabled\r\n        });\r\n    }\r\n\r\n    placeEvents(orderedEvents: IDisplayEvent[]) {\r\n        this.calculatePosition(orderedEvents);\r\n        DayViewComponent.calculateWidth(orderedEvents, this.hourRange, this.hourParts);\r\n    }\r\n\r\n    placeAllDayEvents(orderedEvents: IDisplayEvent[]) {\r\n        this.calculatePosition(orderedEvents);\r\n    }\r\n\r\n    overlap(event1: IDisplayEvent, event2: IDisplayEvent): boolean {\r\n        let earlyEvent = event1,\r\n            lateEvent = event2;\r\n        if (event1.startIndex > event2.startIndex || (event1.startIndex === event2.startIndex && event1.startOffset > event2.startOffset)) {\r\n            earlyEvent = event2;\r\n            lateEvent = event1;\r\n        }\r\n\r\n        if (earlyEvent.endIndex <= lateEvent.startIndex) {\r\n            return false;\r\n        } else {\r\n            return !(earlyEvent.endIndex - lateEvent.startIndex === 1 && earlyEvent.endOffset + lateEvent.startOffset >= this.hourParts);\r\n        }\r\n    }\r\n\r\n    calculatePosition(events: IDisplayEvent[]) {\r\n        const len = events.length,\r\n            isForbidden: boolean[] = new Array(len);\r\n        let maxColumn = 0,\r\n            col: number;\r\n\r\n\r\n        for (let i = 0; i < len; i += 1) {\r\n            for (col = 0; col < maxColumn; col += 1) {\r\n                isForbidden[col] = false;\r\n            }\r\n            for (let j = 0; j < i; j += 1) {\r\n                if (this.overlap(events[i], events[j])) {\r\n                    isForbidden[events[j].position] = true;\r\n                }\r\n            }\r\n            for (col = 0; col < maxColumn; col += 1) {\r\n                if (!isForbidden[col]) {\r\n                    break;\r\n                }\r\n            }\r\n            if (col < maxColumn) {\r\n                events[i].position = col;\r\n            } else {\r\n                events[i].position = maxColumn++;\r\n            }\r\n        }\r\n\r\n        if (this.dir === 'rtl') {\r\n            for (let i = 0; i < len; i += 1) {\r\n                events[i].position = maxColumn - 1 - events[i].position;\r\n            }\r\n        }\r\n    }\r\n\r\n    eventSelected(event: IEvent) {\r\n        this.onEventSelected.emit(event);\r\n    }\r\n\r\n    setScrollPosition(scrollPosition: number) {\r\n        this.initScrollPosition = scrollPosition;\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    ElementRef,\r\n    SimpleChanges,\r\n    OnChanges,\r\n    AfterViewInit,\r\n    OnDestroy,\r\n    ViewEncapsulation\r\n} from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'init-position-scroll',\r\n    template: `\r\n        <div class=\"scroll-content\" style=\"height:100%\">\r\n            <ng-content></ng-content>\r\n        </div>\r\n    `,\r\n    styles: [`\r\n        .scroll-content {\r\n            overflow-y: auto;\r\n            overflow-x: hidden;\r\n        }        \r\n    `],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class initPositionScrollComponent implements OnChanges, AfterViewInit, OnDestroy {\r\n    @Input() initPosition:number;\r\n    @Input() emitEvent:boolean;\r\n    @Output() onScroll = new EventEmitter<number>();\r\n\r\n    private element:ElementRef;\r\n    private scrollContent:HTMLElement;\r\n    private handler:()=>void;\r\n    private listenerAttached:boolean = false;\r\n\r\n    constructor(el:ElementRef) {\r\n        this.element = el;\r\n    }\r\n\r\n    ngOnChanges(changes:SimpleChanges) {\r\n        let initPosition = changes['initPosition'];\r\n        if (initPosition && initPosition.currentValue !== undefined && this.scrollContent) {\r\n            const me =this;\r\n            setTimeout(function() {\r\n                me.scrollContent.scrollTop = initPosition.currentValue;\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        const scrollContent = this.scrollContent = this.element.nativeElement.querySelector('.scroll-content');\r\n        if (this.initPosition !== undefined) {\r\n            scrollContent.scrollTop = this.initPosition;\r\n        }\r\n\r\n        if (this.emitEvent && !this.listenerAttached) {\r\n            let onScroll = this.onScroll;\r\n            this.handler = function () {\r\n                onScroll.emit(scrollContent.scrollTop);\r\n            };\r\n            this.listenerAttached = true;\r\n            scrollContent.addEventListener('scroll', this.handler);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.listenerAttached) {\r\n            this.scrollContent.removeEventListener('scroll', this.handler);\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { MonthViewComponent } from './monthview';\r\nimport { WeekViewComponent } from './weekview';\r\nimport { DayViewComponent } from './dayview';\r\nimport { CalendarComponent } from './calendar';\r\nimport { initPositionScrollComponent } from './init-position-scroll';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        MonthViewComponent, WeekViewComponent, DayViewComponent, CalendarComponent, initPositionScrollComponent\r\n    ],\r\n    imports: [IonicModule, CommonModule],\r\n    exports: [CalendarComponent]\r\n})\r\nexport class NgCalendarModule {}\r\n"]}